import{_ as J,h as O,d as G,r as s,D as H,o as p,c as S,a as u,t as h,b as a,w as o,G as K,m as B,i as Q,x as W,y as X,z as Y,H as x,I as ee,v as ae,u as oe,s as le,e as m,A as te,f as ne,j as N,F as re,k as se,E as M}from"./index-8c31c214.js";const R=O.create({baseURL:"https://massagebackend.webenia.org",headers:{Accept:"application/json","Content-Type":"application/json"}});R.interceptors.request.use(e=>{const t=JSON.parse(localStorage.getItem("tokenData"));return t!=null&&t.token&&(e.headers.Authorization=`Bearer ${t.token}`),e},e=>Promise.reject(e));R.interceptors.response.use(e=>e,e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem("tokenData"),window.location.href="/login"),Promise.reject(e)});const ie=G({name:"BrandsView",components:{Edit:W,Delete:X,Plus:Y,Picture:x,ZoomIn:ee,Refresh:ae},setup(){const e=oe(),t=le(),I=m(null),D=m(!1),P=m(!1),w=m("create"),F=m([]),g=m(!1),c=m(!1),A=m(!1),f=m(null),$=m(null),b=m(localStorage.getItem("lang")||"en"),r=te({logo:"",name_en:"",name_ar:"",description_en:"",description_ar:"",category_id:null}),v={name_en:[{required:!0,message:b==="en"?"Please enter brand name in English":"من فضلك ادخل اسم البراند بالانجليزي",trigger:"blur"}],name_ar:[{required:!0,message:b==="en"?"Please enter brand name in Arabic":"من فضلك ادخل اسم البراند بالعربي",trigger:"blur"}],description_en:[{required:!0,message:b==="en"?"Please enter brand description in English":"من فضلك ادخل وصف البراند بالانجليزي",trigger:"blur"}],description_ar:[{required:!0,message:b==="en"?"Please enter brand description in Arabic":"من فضلك ادخل وصف البراند بالعربي",trigger:"blur"}]},V=async()=>{var l,d,_;try{g.value=!0,$.value=null;const i=JSON.parse(localStorage.getItem("tokenData"));if(!(i!=null&&i.token)){console.error("No token found"),t.push("/login");return}await e.dispatch("fetchBrands"),F.value=e.getters.getBrands}catch(i){console.error("Error loading brands:",i),$.value=((d=(l=i.response)==null?void 0:l.data)==null?void 0:d.message)||i.message||"Failed to load brands",((_=i.response)==null?void 0:_.status)===401&&(localStorage.removeItem("tokenData"),t.push("/login"))}finally{g.value=!1}},z=()=>{w.value="create",r.logo="",r.name_en="",r.name_ar="",r.description_en="",r.description_ar="",r.category_id=null,D.value=!0},T=l=>{var d,_,i;w.value="edit",f.value=l,r.logo=((_=(d=l.media)==null?void 0:d[0])==null?void 0:_.original_url)||"",r.name_en=l.name_en,r.name_ar=l.name_ar,r.description_en=l.description_en,r.description_ar=l.description_ar,r.category_id=l.category_id||((i=l.category)==null?void 0:i.id)||null,D.value=!0},L=l=>{f.value=l,P.value=!0},j=l=>{if(l){const d=new FileReader;d.onload=_=>{r.logo=_.target.result},d.readAsDataURL(l.raw)}},q=async()=>{try{if(!I.value)return;await I.value.validate(),c.value=!0;const l=new FormData;if(l.append("name_en",r.name_en),l.append("name_ar",r.name_ar),l.append("description_en",r.description_en||""),l.append("description_ar",r.description_ar||""),r.category_id&&l.append("category_id",r.category_id),r.logo instanceof File)l.append("logo",r.logo);else if(r.logo&&typeof r.logo=="string"){const i=await(await fetch(r.logo)).blob(),U=new File([i],"logo.png",{type:"image/png"});l.append("logo",U)}const d=w.value==="create"?"/api/brands":`/api/brands/${f.value.id}`;await R.post(d,l,{headers:{"Content-Type":"multipart/form-data"}}),M({message:b==="en"?` ${w.value==="create"?"created":"updated"} successfully`:`  ${w.value==="create"?"تم إنشاؤه":"تم التحديث"} بنجاح `,type:"success",duration:2e3}),D.value=!1,V()}catch{}finally{c.value=!1}},y=async()=>{try{A.value=!0,await R.delete(`/api/brands/${f.value.id}`),M({message:b==="en"?"Brand deleted successfully":"تم حذف العلامة التجارية بنجاح",type:"success",duration:2e3}),P.value=!1,V()}catch(l){console.error("Error deleting brand:",l),M({message:b==="en"?"Failed to delete brand":"فشل في حذف العلامة التجارية",type:"error",duration:5e3})}finally{A.value=!1}},C=l=>{if(l.images&&l.images.length>0){const d=`https://massagebackend.webenia.org/public/storage/${l.images[0].path}`;window.open(d,"_blank")}},k=()=>{$.value=null};return ne(async()=>{try{await e.dispatch("categories/fetchCategories")}catch(l){console.error("Failed to load categories",l)}V()}),{brands:F,loading:g,error:$,dialogVisible:D,deleteDialogVisible:P,dialogType:w,submitting:c,deleting:A,selectedBrand:f,brandForm:r,formRules:v,brandFormRef:I,fetchBrands:V,openCreateDialog:z,editItem:T,deleteItem:L,handleLogoChange:j,submitForm:q,confirmDelete:y,previewImage:C,clearError:k}}}),de={class:"brands-container"},ue={class:"header"},ce={class:"text-2xl font-bold text-gray-800"},pe={key:0,class:"loading-state"},me={key:1,class:"table-container"},ge={class:"d-flex align-center brand-name"},_e=["onClick"],be={class:"logo-overlay"},fe={class:"text-right arabic-text",dir:"rtl"},ve={class:"description-cell"},ye={class:"text-right arabic-text",dir:"rtl"},he={class:"brand-text"},we={class:"button-group"},ke={class:"dialog-footer"},Be={class:"dialog-footer"};function $e(e,t,I,D,P,w){const F=s("Plus"),g=s("el-icon"),c=s("el-button"),A=s("el-skeleton"),f=s("el-image"),$=s("Picture"),b=s("el-avatar"),r=s("ZoomIn"),v=s("el-table-column"),V=s("Edit"),z=s("el-tooltip"),T=s("Delete"),L=s("el-table"),j=s("el-empty"),q=s("el-upload"),y=s("el-form-item"),C=s("el-input"),k=s("el-col"),l=s("el-row"),d=s("el-option"),_=s("el-select"),i=s("el-form"),U=s("el-dialog"),Z=H("loading");return p(),S("div",de,[u("div",ue,[u("h1",ce,h(e.$t("Brands.Management")),1),a(c,{type:"primary",onClick:e.openCreateDialog,class:"add-brand-btn"},{default:o(()=>[a(g,{class:"mr-2"},{default:o(()=>[a(F)]),_:1}),N(" "+h(e.$t("Brands.AddBrands")),1)]),_:1},8,["onClick"])]),e.loading?(p(),S("div",pe,[a(A,{rows:5,animated:""})])):(p(),S("div",me,[K((p(),B(L,{data:e.brands,style:{width:"100%"},border:!0},{default:o(()=>[a(v,{label:e.$t("Brands.Logo"),"min-width":"200",resizable:!0},{default:o(({row:n})=>[u("div",ge,[u("div",{class:"brand-logo-container",onClick:E=>e.previewImage(n)},[a(b,{size:120,class:"brand-logo"},{default:o(()=>[n.images?(p(),B(f,{key:0,src:"https://massagebackend.webenia.org/public/storage/"+n.images[0].path,fit:"cover",class:"logo-img","preview-src-list":["https://massagebackend.webenia.org/public/storage/"+n.images[0].path]},null,8,["src","preview-src-list"])):(p(),B(g,{key:1,size:"24",color:"#909399"},{default:o(()=>[a($)]),_:1}))]),_:2},1024),u("div",be,[a(g,null,{default:o(()=>[a(r)]),_:1})])],8,_e)])]),_:1},8,["label"]),a(v,{prop:"name_ar",label:e.$t("Brands.NameAr"),"min-width":"150",resizable:!0},{default:o(n=>[u("div",fe,h(n.row.name_ar||"N/A"),1)]),_:1},8,["label"]),a(v,{prop:"description_en",label:e.$t("Brands.DescriptionEn"),"min-width":"200",resizable:!0},{default:o(n=>[u("div",ve,h(n.row.description_en||"N/A"),1)]),_:1},8,["label"]),a(v,{prop:"description_ar",label:e.$t("Brands.DescriptionAr"),"min-width":"200",resizable:!0},{default:o(n=>[u("div",ye,h(n.row.description_ar||"N/A"),1)]),_:1},8,["label"]),a(v,{prop:"category.name_en",label:e.$t("Brands.Category"),"min-width":"150",resizable:!0},{default:o(n=>{var E;return[u("div",he,h(((E=n.row.category)==null?void 0:E.name_en)||"N/A"),1)]}),_:1},8,["label"]),a(v,{label:e.$t("Brands.Actions"),width:"100",fixed:"right"},{default:o(n=>[u("div",we,[a(z,{content:"Edit Brand",placement:"top"},{default:o(()=>[a(c,{type:"primary",size:"small",class:"action-button",onClick:E=>e.editItem(n.row)},{default:o(()=>[a(g,null,{default:o(()=>[a(V)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),a(z,{content:"Delete Brand",placement:"top"},{default:o(()=>[a(c,{type:"danger",size:"small",class:"action-button",onClick:E=>e.deleteItem(n.row)},{default:o(()=>[a(g,null,{default:o(()=>[a(T)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["label"])]),_:1},8,["data"])),[[Z,e.loading]]),!e.loading&&e.brands.length===0?(p(),B(j,{key:0,description:"No brands found"})):Q("",!0)])),a(U,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[6]||(t[6]=n=>e.dialogVisible=n),title:e.dialogType==="create"?e.$t("Brands.CreateTitle"):e.$t("Brands.Edit"),width:"600px","close-on-click-modal":!1},{footer:o(()=>[u("span",ke,[a(c,{onClick:t[5]||(t[5]=n=>e.dialogVisible=!1)},{default:o(()=>[N(h(e.$t("Brands.Cancel")),1)]),_:1}),a(c,{type:"primary",onClick:e.submitForm,loading:e.submitting},{default:o(()=>[N(h(e.dialogType==="create"?e.$t("Brands.Create"):e.$t("Brands.Update")),1)]),_:1},8,["onClick","loading"])])]),default:o(()=>[a(i,{ref:"brandFormRef",model:e.brandForm,rules:e.formRules,"label-position":"top"},{default:o(()=>[a(y,{label:e.$t("Brands.Logo"),prop:"logo"},{default:o(()=>[a(q,{class:"logo-uploader",action:"#","show-file-list":!1,"auto-upload":!1,"on-change":e.handleLogoChange},{default:o(()=>[e.brandForm.logo?(p(),B(f,{key:0,src:e.brandForm.logo,class:"logo-preview"},null,8,["src"])):(p(),B(g,{key:1,class:"logo-uploader-icon"},{default:o(()=>[a(F)]),_:1}))]),_:1},8,["on-change"])]),_:1},8,["label"]),a(l,{gutter:20},{default:o(()=>[a(k,{span:12},{default:o(()=>[a(y,{label:e.$t("Brands.NameEn"),prop:"name_en"},{default:o(()=>[a(C,{modelValue:e.brandForm.name_en,"onUpdate:modelValue":t[0]||(t[0]=n=>e.brandForm.name_en=n),placeholder:e.$t("Brands.PlaceholderNameEn")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(k,{span:12},{default:o(()=>[a(y,{label:e.$t("Brands.NameAr"),prop:"name_ar"},{default:o(()=>[a(C,{modelValue:e.brandForm.name_ar,"onUpdate:modelValue":t[1]||(t[1]=n=>e.brandForm.name_ar=n),placeholder:e.$t("Brands.PlaceholderNameAr"),dir:"rtl"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),a(l,{gutter:20},{default:o(()=>[a(k,{span:12},{default:o(()=>[a(y,{label:e.$t("Brands.Category"),prop:"category_id"},{default:o(()=>[a(_,{modelValue:e.brandForm.category_id,"onUpdate:modelValue":t[2]||(t[2]=n=>e.brandForm.category_id=n),placeholder:"Select Category",style:{width:"100%"}},{default:o(()=>[(p(!0),S(re,null,se(e.$store.getters["categories/getCategories"],n=>(p(),B(d,{key:n.id,label:`${n.name_ar}`,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),a(l,{gutter:20},{default:o(()=>[a(k,{span:12},{default:o(()=>[a(y,{label:e.$t("Brands.DescriptionEn"),prop:"description_en"},{default:o(()=>[a(C,{modelValue:e.brandForm.description_en,"onUpdate:modelValue":t[3]||(t[3]=n=>e.brandForm.description_en=n),type:"textarea",rows:3,placeholder:e.$t("Brands.PlaceholderDescriptionEn")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(k,{span:12},{default:o(()=>[a(y,{label:e.$t("Brands.DescriptionAr"),prop:"description_ar"},{default:o(()=>[a(C,{modelValue:e.brandForm.description_ar,"onUpdate:modelValue":t[4]||(t[4]=n=>e.brandForm.description_ar=n),type:"textarea",rows:3,placeholder:e.$t("Brands.PlaceholderDescriptionAr"),dir:"rtl"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),a(U,{modelValue:e.deleteDialogVisible,"onUpdate:modelValue":t[8]||(t[8]=n=>e.deleteDialogVisible=n),title:"Delete Brand",width:"400px","close-on-click-modal":!1},{footer:o(()=>[u("span",Be,[a(c,{onClick:t[7]||(t[7]=n=>e.deleteDialogVisible=!1)},{default:o(()=>t[9]||(t[9]=[N("Cancel")])),_:1,__:[9]}),a(c,{type:"danger",onClick:e.confirmDelete,loading:e.deleting},{default:o(()=>t[10]||(t[10]=[N(" Delete ")])),_:1,__:[10]},8,["onClick","loading"])])]),default:o(()=>[t[11]||(t[11]=u("p",null,"Are you sure you want to delete this brand? This action cannot be undone.",-1))]),_:1,__:[11]},8,["modelValue"])])}const Ce=J(ie,[["render",$e],["__scopeId","data-v-be43fa0a"]]);export{Ce as default};
