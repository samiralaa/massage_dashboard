import{_ as Z,b as M,R as J,r as s,a5 as O,o as f,c as L,a as c,t as w,e as a,p as o,w as G,l as D,f as H,$ as K,a0 as Q,a1 as W,a6 as X,a7 as Y,Z as x,S as ee,D as ae,y as m,a2 as oe,E as ne,j as A,U as j}from"./index-50b21e1d.js";const U=M.create({baseURL:"https://massagebackend.webenia.org",headers:{Accept:"application/json","Content-Type":"application/json"}});U.interceptors.request.use(e=>{const n=JSON.parse(localStorage.getItem("tokenData"));return n!=null&&n.token&&(e.headers.Authorization=`Bearer ${n.token}`),e},e=>Promise.reject(e));U.interceptors.response.use(e=>e,e=>{var n;return((n=e.response)==null?void 0:n.status)===401&&(localStorage.removeItem("tokenData"),window.location.href="/login"),Promise.reject(e)});const le=J({name:"BrandsView",components:{Edit:K,Delete:Q,Plus:W,Picture:X,ZoomIn:Y,Refresh:x},setup(){const e=ee(),n=ae(),N=m(null),C=m(!1),P=m(!1),v=m("create"),F=m([]),g=m(!1),u=m(!1),E=m(!1),b=m(null),k=m(null),_=m(localStorage.getItem("lang")||"en"),r=oe({logo:"",name_en:"",name_ar:"",description_en:"",description_ar:""}),h={name_en:[{required:!0,message:_==="en"?"Please enter brand name in English":"من فضلك ادخل اسم البراند بالانجليزي",trigger:"blur"}],name_ar:[{required:!0,message:_==="en"?"Please enter brand name in Arabic":"من فضلك ادخل اسم البراند بالعربي",trigger:"blur"}],description_en:[{required:!0,message:_==="en"?"Please enter brand description in English":"من فضلك ادخل وصف البراند بالانجليزي",trigger:"blur"}],description_ar:[{required:!0,message:_==="en"?"Please enter brand description in Arabic":"من فضلك ادخل وصف البراند بالعربي",trigger:"blur"}]},B=async()=>{var l,i,p;try{g.value=!0,k.value=null;const d=JSON.parse(localStorage.getItem("tokenData"));if(!(d!=null&&d.token)){console.error("No token found"),n.push("/login");return}await e.dispatch("fetchBrands"),F.value=e.getters.getBrands}catch(d){console.error("Error loading brands:",d),k.value=((i=(l=d.response)==null?void 0:l.data)==null?void 0:i.message)||d.message||"Failed to load brands",((p=d.response)==null?void 0:p.status)===401&&(localStorage.removeItem("tokenData"),n.push("/login"))}finally{g.value=!1}},I=()=>{v.value="create",r.logo="",r.name_en="",r.name_ar="",r.description_en="",r.description_ar="",C.value=!0},z=l=>{var i,p;v.value="edit",b.value=l,r.logo=((p=(i=l.media)==null?void 0:i[0])==null?void 0:p.original_url)||"",r.name_en=l.name_en,r.name_ar=l.name_ar,r.description_en=l.description_en,r.description_ar=l.description_ar,C.value=!0},R=l=>{b.value=l,P.value=!0},S=l=>{if(l){const i=new FileReader;i.onload=p=>{r.logo=p.target.result},i.readAsDataURL(l.raw)}},T=async()=>{try{if(!N.value)return;await N.value.validate(),u.value=!0;const l=new FormData;if(l.append("name_en",r.name_en),l.append("name_ar",r.name_ar),l.append("description_en",r.description_en||""),l.append("description_ar",r.description_ar||""),r.logo instanceof File)l.append("logo",r.logo);else if(r.logo&&typeof r.logo=="string"){const d=await(await fetch(r.logo)).blob(),t=new File([d],"logo.png",{type:"image/png"});l.append("logo",t)}const i=v.value==="create"?"/api/brands":`/api/brands/${b.value.id}`;await U.post(i,l,{headers:{"Content-Type":"multipart/form-data"}}),j({message:_==="en"?` ${v.value==="create"?"created":"updated"} successfully`:`  ${v.value==="create"?"تم إنشاؤه":"تم التحديث"} بنجاح `,type:"success",duration:2e3}),C.value=!1,B()}catch{}finally{u.value=!1}},y=async()=>{try{E.value=!0,await U.delete(`/api/brands/${b.value.id}`),j({message:_==="en"?"Brand deleted successfully":"تم حذف العلامة التجارية بنجاح",type:"success",duration:2e3}),P.value=!1,B()}catch(l){console.error("Error deleting brand:",l),j({message:_==="en"?"Failed to delete brand":"فشل في حذف العلامة التجارية",type:"error",duration:5e3})}finally{E.value=!1}},$=l=>{if(l.images&&l.images.length>0){const i=`https://massagebackend.webenia.org/public/storage/${l.images[0].path}`;window.open(i,"_blank")}},V=()=>{k.value=null};return ne(()=>{B()}),{brands:F,loading:g,error:k,dialogVisible:C,deleteDialogVisible:P,dialogType:v,submitting:u,deleting:E,selectedBrand:b,brandForm:r,formRules:h,brandFormRef:N,fetchBrands:B,openCreateDialog:I,editItem:z,deleteItem:R,handleLogoChange:S,submitForm:T,confirmDelete:y,previewImage:$,clearError:V}}}),te={class:"brands-container"},re={class:"header"},se={class:"text-2xl font-bold text-gray-800"},ie={key:0,class:"loading-state"},de={key:1,class:"table-container"},ce={class:"d-flex align-center brand-name"},ue=["onClick"],pe={class:"logo-overlay"},me={class:"text-right arabic-text",dir:"rtl"},ge={class:"description-cell"},_e={class:"text-right arabic-text",dir:"rtl"},fe={class:"button-group"},be={class:"dialog-footer"},ve={class:"dialog-footer"};function he(e,n,N,C,P,v){const F=s("Plus"),g=s("el-icon"),u=s("el-button"),E=s("el-skeleton"),b=s("el-image"),k=s("Picture"),_=s("el-avatar"),r=s("ZoomIn"),h=s("el-table-column"),B=s("Edit"),I=s("el-tooltip"),z=s("Delete"),R=s("el-table"),S=s("el-empty"),T=s("el-upload"),y=s("el-form-item"),$=s("el-input"),V=s("el-col"),l=s("el-row"),i=s("el-form"),p=s("el-dialog"),d=O("loading");return f(),L("div",te,[c("div",re,[c("h1",se,w(e.$t("Brands.Management")),1),a(u,{type:"primary",onClick:e.openCreateDialog,class:"add-brand-btn"},{default:o(()=>[a(g,{class:"mr-2"},{default:o(()=>[a(F)]),_:1}),A(" "+w(e.$t("Brands.AddBrands")),1)]),_:1},8,["onClick"])]),e.loading?(f(),L("div",ie,[a(E,{rows:5,animated:""})])):(f(),L("div",de,[G((f(),D(R,{data:e.brands,style:{width:"100%"},border:!0},{default:o(()=>[a(h,{label:e.$t("Brands.Logo"),"min-width":"200",resizable:!0},{default:o(({row:t})=>[c("div",ce,[c("div",{class:"brand-logo-container",onClick:q=>e.previewImage(t)},[a(_,{size:120,class:"brand-logo"},{default:o(()=>[t.images?(f(),D(b,{key:0,src:"https://massagebackend.webenia.org/public/storage/"+t.images[0].path,fit:"cover",class:"logo-img","preview-src-list":["https://massagebackend.webenia.org/public/storage/"+t.images[0].path]},null,8,["src","preview-src-list"])):(f(),D(g,{key:1,size:"24",color:"#909399"},{default:o(()=>[a(k)]),_:1}))]),_:2},1024),c("div",pe,[a(g,null,{default:o(()=>[a(r)]),_:1})])],8,ue)])]),_:1},8,["label"]),a(h,{prop:"name_ar",label:e.$t("Brands.NameAr"),"min-width":"150",resizable:!0},{default:o(t=>[c("div",me,w(t.row.name_ar||"N/A"),1)]),_:1},8,["label"]),a(h,{prop:"description_en",label:e.$t("Brands.DescriptionEn"),"min-width":"200",resizable:!0},{default:o(t=>[c("div",ge,w(t.row.description_en||"N/A"),1)]),_:1},8,["label"]),a(h,{prop:"description_ar",label:e.$t("Brands.DescriptionAr"),"min-width":"200",resizable:!0},{default:o(t=>[c("div",_e,w(t.row.description_ar||"N/A"),1)]),_:1},8,["label"]),a(h,{label:e.$t("Brands.Actions"),width:"100",fixed:"right"},{default:o(t=>[c("div",fe,[a(I,{content:"Edit Brand",placement:"top"},{default:o(()=>[a(u,{type:"primary",size:"small",class:"action-button",onClick:q=>e.editItem(t.row)},{default:o(()=>[a(g,null,{default:o(()=>[a(B)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),a(I,{content:"Delete Brand",placement:"top"},{default:o(()=>[a(u,{type:"danger",size:"small",class:"action-button",onClick:q=>e.deleteItem(t.row)},{default:o(()=>[a(g,null,{default:o(()=>[a(z)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["label"])]),_:1},8,["data"])),[[d,e.loading]]),!e.loading&&e.brands.length===0?(f(),D(S,{key:0,description:"No brands found"})):H("",!0)])),a(p,{modelValue:e.dialogVisible,"onUpdate:modelValue":n[5]||(n[5]=t=>e.dialogVisible=t),title:e.dialogType==="create"?e.$t("Brands.CreateTitle"):e.$t("Brands.Edit"),width:"600px","close-on-click-modal":!1},{footer:o(()=>[c("span",be,[a(u,{onClick:n[4]||(n[4]=t=>e.dialogVisible=!1)},{default:o(()=>[A(w(e.$t("Brands.Cancel")),1)]),_:1}),a(u,{type:"primary",onClick:e.submitForm,loading:e.submitting},{default:o(()=>[A(w(e.dialogType==="create"?e.$t("Brands.Create"):e.$t("Brands.Update")),1)]),_:1},8,["onClick","loading"])])]),default:o(()=>[a(i,{ref:"brandFormRef",model:e.brandForm,rules:e.formRules,"label-position":"top"},{default:o(()=>[a(y,{label:e.$t("Brands.Logo"),prop:"logo"},{default:o(()=>[a(T,{class:"logo-uploader",action:"#","show-file-list":!1,"auto-upload":!1,"on-change":e.handleLogoChange},{default:o(()=>[e.brandForm.logo?(f(),D(b,{key:0,src:e.brandForm.logo,class:"logo-preview"},null,8,["src"])):(f(),D(g,{key:1,class:"logo-uploader-icon"},{default:o(()=>[a(F)]),_:1}))]),_:1},8,["on-change"])]),_:1},8,["label"]),a(l,{gutter:20},{default:o(()=>[a(V,{span:12},{default:o(()=>[a(y,{label:e.$t("Brands.NameEn"),prop:"name_en"},{default:o(()=>[a($,{modelValue:e.brandForm.name_en,"onUpdate:modelValue":n[0]||(n[0]=t=>e.brandForm.name_en=t),placeholder:e.$t("Brands.PlaceholderNameEn")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(V,{span:12},{default:o(()=>[a(y,{label:e.$t("Brands.NameAr"),prop:"name_ar"},{default:o(()=>[a($,{modelValue:e.brandForm.name_ar,"onUpdate:modelValue":n[1]||(n[1]=t=>e.brandForm.name_ar=t),placeholder:e.$t("Brands.PlaceholderNameAr"),dir:"rtl"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),a(l,{gutter:20},{default:o(()=>[a(V,{span:12},{default:o(()=>[a(y,{label:e.$t("Brands.DescriptionEn"),prop:"description_en"},{default:o(()=>[a($,{modelValue:e.brandForm.description_en,"onUpdate:modelValue":n[2]||(n[2]=t=>e.brandForm.description_en=t),type:"textarea",rows:3,placeholder:e.$t("Brands.PlaceholderDescriptionEn")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(V,{span:12},{default:o(()=>[a(y,{label:e.$t("Brands.DescriptionAr"),prop:"description_ar"},{default:o(()=>[a($,{modelValue:e.brandForm.description_ar,"onUpdate:modelValue":n[3]||(n[3]=t=>e.brandForm.description_ar=t),type:"textarea",rows:3,placeholder:e.$t("Brands.PlaceholderDescriptionAr"),dir:"rtl"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),a(p,{modelValue:e.deleteDialogVisible,"onUpdate:modelValue":n[7]||(n[7]=t=>e.deleteDialogVisible=t),title:"Delete Brand",width:"400px","close-on-click-modal":!1},{footer:o(()=>[c("span",ve,[a(u,{onClick:n[6]||(n[6]=t=>e.deleteDialogVisible=!1)},{default:o(()=>n[8]||(n[8]=[A("Cancel")])),_:1,__:[8]}),a(u,{type:"danger",onClick:e.confirmDelete,loading:e.deleting},{default:o(()=>n[9]||(n[9]=[A(" Delete ")])),_:1,__:[9]},8,["onClick","loading"])])]),default:o(()=>[n[10]||(n[10]=c("p",null,"Are you sure you want to delete this brand? This action cannot be undone.",-1))]),_:1,__:[10]},8,["modelValue"])])}const we=Z(le,[["render",he],["__scopeId","data-v-4936c58b"]]);export{we as default};
