import{_ as A,R as D,S as F,y as _,E,O as z,b as h,r as S,o as w,c as g,a as e,e as i,p as o,t,n as B,f as N,j as T,F as I,d as R,T as V}from"./index-50b21e1d.js";const L=D({name:"DashboardView",setup(){const s=F(),c=_(0),f=_(0),m=_(0),y=_(0),p=_([]),r=_({today_sales:0,this_month_sales:0,last_month_sales:0,month_over_month_growth:0,daily_sales:[],top_selling_products:[],converted_total_sales:0,converted_currency:""});let n=null;const d=()=>{const a=document.getElementById("salesChart");a&&(n=V(a),v())},v=()=>{if(!n||!Array.isArray(r.value.daily_sales))return;const a=r.value.daily_sales,l={tooltip:{trigger:"axis"},legend:{data:["Sales","Orders"]},xAxis:{type:"category",data:a.map(u=>u.date)},yAxis:{type:"value"},series:[{name:"Sales",type:"line",data:a.map(u=>parseFloat(u.total_sales||0))},{name:"Orders",type:"line",data:a.map(u=>u.total_orders||0)}]};n.setOption(l)},b=async()=>{try{const a=await h.get("https://massagebackend.webenia.org/api/dashboard/sales-overview");r.value=a.data.data.original.data,c.value=parseFloat(r.value.total_sales||0),Array.isArray(r.value.daily_sales)?v():console.warn("daily_sales is missing or not an array")}catch(a){console.error("Error fetching sales overview:",a)}},O=()=>{n&&n.resize()};E(async()=>{d(),window.addEventListener("resize",O);try{await k(),await s.dispatch("fetchCustomers"),await $(),await C(),await b(),m.value=s.getters.totalCustomers||0}catch(a){console.error("Error fetching dashboard data:",a)}}),z(()=>{n&&n.dispose(),window.removeEventListener("resize",O)});const $=async()=>{try{const a=JSON.parse(localStorage.getItem("tokenData"));if(!a||!a.token)throw new Error("Authentication token not found");h.defaults.headers.common.Authorization=`Bearer ${a.token}`;const l=await h.get("https://massagebackend.webenia.org/api/dashboard/total-products");l.data.status===!0&&(y.value=l.data.data.total_products)}catch(a){console.error("Error fetching total products:",a)}},k=async()=>{try{const a=JSON.parse(localStorage.getItem("tokenData"));if(!a||!a.token)throw new Error("Authentication token not found");h.defaults.headers.common.Authorization=`Bearer ${a.token}`;const l=await h.get("https://massagebackend.webenia.org/api/dashboard/total-orders");l.data.status===!0&&(f.value=l.data.data.total_orders)}catch(a){console.error("Error fetching total orders:",a)}},C=async()=>{try{const a=JSON.parse(localStorage.getItem("tokenData"));if(!a||!a.token)throw new Error("Authentication token not found");h.defaults.headers.common.Authorization=`Bearer ${a.token}`;const l=await h.get("https://massagebackend.webenia.org/api/orders/count/new");l.data.status===!0&&(p.value=l.data.data,console.log("Recent Orders:",p.value))}catch(a){console.error("Error fetching recent orders:",a)}};return E(async()=>{try{await k(),await s.dispatch("fetchCustomers"),await $(),await C(),await b(),m.value=s.getters.totalCustomers||0}catch(a){console.error("Error fetching dashboard data:",a)}}),{totalRevenue:c,totalOrders:f,totalCustomers:m,totalProducts:y,orders:p,salesOverview:r}}}),P={class:"dashboard d-flex flex-wrap flex-grow-1 container-fluid px-2 px-md-4"},x={class:"row w-100 g-3"},J={class:"card-header"},M={class:"card-content"},j={key:0},U={class:"card-header"},q={class:"card-content"},G={class:"card-header"},H={class:"card-content"},K={class:"card-header"},Q={class:"card-content"},W={class:"container-fluid mt-3"},X={class:"w-100 mb-3"},Y={class:"card-header"},Z={class:"sales-overview"},ee={class:"sales-metrics"},se={class:"metric"},te={class:"label"},ae={class:"value"},oe={class:"metric"},re={class:"label"},ne={class:"value"},de={class:"metric"},le={class:"label"},ie={class:"value"},ce={class:"w-100"},he={class:"d-flex gap-2 align-items-center"},_e={class:"badge text-bg-secondary p-2 position-relative"},ue={class:"overflow-auto"},me={class:"table table-hover table-responsive align-middle"},pe={scope:"col"},ve={scope:"col"},we={scope:"col"},ge={scope:"col"},fe={scope:"col"},ye={class:"align-middle"},be={class:"d-flex align-items-center gap-2"},Oe={class:"avatar bg-primary text-white rounded-circle d-flex justify-content-center px-3 py-2 align-items-center"},$e={class:"user-info"},ke={class:"mb-0"},Ce={class:"text-muted"},Ee={class:"align-middle"},Se={class:"align-middle"},Ae={class:"align-middle text-capitalize text-center"},De={class:"align-middle"};function Fe(s,c,f,m,y,p){const r=S("el-card"),n=S("el-col");return w(),g("div",P,[e("div",x,[i(n,{span:6,xs:24,sm:12,md:6},{default:o(()=>[i(r,{class:"summary-card h-100"},{header:o(()=>[e("div",J,[e("span",null,t(s.$t("dashboard.Total-Revenue")),1)])]),default:o(()=>[e("div",M,[e("h2",null,"$"+t(s.salesOverview.converted_total_sales.toFixed(2)),1),e("span",{class:B(["trend",s.salesOverview.month_over_month_growth>=0?"positive":"negative"])},t(s.salesOverview.month_over_month_growth>=0?"+":"")+t(s.salesOverview.month_over_month_growth)+"% ",3),s.salesOverview.converted_total_sales?(w(),g("div",j,[e("small",null," ("+t(s.salesOverview.converted_total_sales.toFixed(2))+" "+t(s.salesOverview.converted_currency)+") ",1)])):N("",!0)])]),_:1})]),_:1}),i(n,{span:6,xs:24,sm:12,md:6},{default:o(()=>[i(r,{class:"summary-card h-100"},{header:o(()=>[e("div",U,[e("span",null,t(s.$t("dashboard.total-Orders")),1)])]),default:o(()=>[e("div",q,[e("h2",null,t(s.totalOrders),1)])]),_:1})]),_:1}),i(n,{span:6,xs:24,sm:12,md:6},{default:o(()=>[i(r,{class:"summary-card h-100"},{header:o(()=>[e("div",G,[e("span",null,t(s.$t("dashboard.total-Customers")),1)])]),default:o(()=>[e("div",H,[e("h2",null,t(s.totalCustomers),1)])]),_:1})]),_:1}),i(n,{span:6,xs:24,sm:12,md:6},{default:o(()=>[i(r,{class:"summary-card h-100"},{header:o(()=>[e("div",K,[e("span",null,t(s.$t("dashboard.total-Products")),1)])]),default:o(()=>[e("div",Q,[e("h2",null,t(s.totalProducts),1)])]),_:1})]),_:1})]),e("div",W,[e("div",X,[i(r,{class:"w-100"},{header:o(()=>[e("div",Y,[e("span",null,t(s.$t("dashboard.Sales-Overview")),1)])]),default:o(()=>[e("div",Z,[e("div",ee,[e("div",se,[e("span",te,t(s.$t("dashboard.Today-Sales")),1),e("span",ae,"$"+t(parseFloat(s.salesOverview.today_sales||0).toFixed(2)),1)]),e("div",oe,[e("span",re,t(s.$t("dashboard.This-Month")),1),e("span",ne,"$"+t(parseFloat(s.salesOverview.this_month_sales||0).toFixed(2)),1)]),e("div",de,[e("span",le,t(s.$t("dashboard.Last-Month")),1),e("span",ie,"$"+t(parseFloat(s.salesOverview.last_month_sales||0).toFixed(2)),1)])]),c[0]||(c[0]=e("div",{id:"salesChart",class:"chart-container"},null,-1))])]),_:1})]),e("div",ce,[i(r,{class:"w-100"},{header:o(()=>[e("div",he,[e("span",null,t(s.$t("dashboard.recent-Orders")),1),e("span",_e,[T(t(s.orders.count?`+ ${s.orders.count}`:"No Orders")+" ",1),c[1]||(c[1]=e("span",{class:"position-absolute top-0 start-100 translate-middle p-2 bg-danger border border-light rounded-circle"},null,-1))])])]),default:o(()=>[e("div",ue,[e("table",me,[e("thead",null,[e("tr",null,[e("th",pe,t(s.$t("dashboard.customer")),1),e("th",ve,t(s.$t("dashboard.address")),1),e("th",we,t(s.$t("dashboard.Total")),1),e("th",ge,t(s.$t("dashboard.payment-method")),1),e("th",fe,t(s.$t("dashboard.Order-Date")),1)])]),e("tbody",null,[(w(!0),g(I,null,R(s.orders.orders,(d,v)=>(w(),g("tr",{key:v},[e("td",ye,[e("div",be,[e("div",Oe,t(d.user.name?d.user.name.charAt(0).toUpperCase():"?"),1),e("div",$e,[e("h6",ke,t(d.user.name),1),e("small",Ce,t(d.user.email),1)])])]),e("td",Ee,t(d.address.country.name_en),1),e("td",Se,t(d.total_price)+" "+t(d.currency),1),e("td",Ae,t(d.payment_method),1),e("td",De,t(d.ordered_at),1)]))),128))])])])]),_:1})])])])}const Be=A(L,[["render",Fe],["__scopeId","data-v-323978d1"]]);export{Be as default};
