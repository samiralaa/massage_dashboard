import{_ as je,s as Je,Z as Ze,e as A,B as C,$ as ge,f as Qe,r as U,G as Xe,o as s,c as v,H as xe,m as $,w as r,h as D,a as w,t as _,b as n,F as I,k as N,j as y,i as b,K as ea,y as aa,E as S,D as G}from"./index-d33f2148.js";const la={class:"product-edit-container"},ta={class:"attribute-option"},na=["innerHTML"],ra={class:"attribute-name"},ua=["innerHTML"],oa={class:"attribute-input-container"},ia={key:0,class:"gradient-control"},da=["value","onInput"],sa={class:"percent-display"},ca={key:0,class:"no-attributes-message"},pa={class:"attribute-header"},ma={class:"attribute-title"},ga={key:0,class:"image-preview-list",style:{"margin-bottom":"1em"}},_a=["src"],va={class:"el-upload__text"},fa={key:2,class:"amount-entry mb-3"},ba={key:6,class:"image-preview-list",style:{"margin-bottom":"1em"}},ya=["src"],ha=["src"],$a={key:7,class:"image-preview-list",style:{"margin-bottom":"1em"}},Va=["src"],Pa={class:"el-upload__text"},E="https://massagebackend.webenia.org",ka={__name:"Edit",setup(Ia){const _e=Je(),ve=Ze(),te=A(null),ne=ve.params.id,O=A(!1),l=A({name_en:"",name_ar:"",price:"",is_available:1,description_en:"",description_ar:"",category_ar:"",category_en:"",category_id:null,currency_id:null,country_id:null,parent_id:null,brand_id:null,images:[],amount_required:!1,amounts:[],unit_id:null,weight:null,amount_price:null,discount:{id:null,value:null,startDate:null,endDate:null,is_active:!1},attributes:[],main_ingredients:[],fragrance_notes:[],attribute_ids:[],attribute_values:{},selected_main_ingredient_ids:[]}),fe=A(null),be=A(null),ye=A(null),he=A(null),$e=A(null),Ve=()=>{l.value.amounts.push({unit_id:null,weight:null,price:null})},Pe=e=>{if(l.value.amounts.length<=1){S.warning(localStorage.getItem("lang")==="ar"?"يجب عليك حفظ كمية واحدة على الاقل":"At least one amount entry is required.");return}G.confirm(localStorage.getItem("lang")==="ar"?"سيتم حذف الكمية":"The amount will be deleted","Warning",{confirmButtonText:localStorage.getItem("lang")==="ar"?"موافق":"OK",cancelButtonText:localStorage.getItem("lang")==="ar"?"إلغاء":"Cancel",type:"warning"}).then(()=>{l.value.amounts.splice(e,1),S.success(localStorage.getItem("lang")==="ar"?"تم حذف الكمية بنجاح":"Amount deleted successfully")}).catch(()=>{S.info(localStorage.getItem("lang")==="ar"?"تم إلغاء الحذف":"Delete cancelled")})},ke={name_en:[{required:!0,message:"Required",trigger:"blur"}],price:[{required:!0,message:"Required",trigger:"blur"}],"discount.endDate":[{required:!0,message:"Required",trigger:"blur"}],"discount.startDate":[{required:!0,message:"Required",trigger:"blur"}]},T=A([]),H=A([]),Y=A([]),j=A([]),R=A([]),J=A([]),Z=A([]),re=A([]),Q=A(null),X=A(null),Ie=e=>(localStorage.getItem("lang")||"en")==="ar"?e.name_ar:e.name_en,x=C(()=>H.value.filter(e=>!e.is_deleted)),Ae=C(()=>{const e=localStorage.getItem("lang")||"en";let a=R.value.find(i=>i.id===l.value.brand_id);return!a&&l.value.parent&&l.value.parent.brand&&(a=l.value.parent.brand),a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),De=C(()=>{const e=localStorage.getItem("lang")||"en";let a=T.value.find(i=>i.id===l.value.category_id);return!a&&l.value.parent&&l.value.parent.category&&(a=l.value.parent.category),a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),we=C(()=>{const e=localStorage.getItem("lang")||"en";let a=x.value.find(i=>i.id===l.value.currency_id);return!a&&l.value.parent&&l.value.parent.currency&&(a=l.value.parent.currency),a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),Ne=C(()=>{const e=localStorage.getItem("lang")||"en";let a=Y.value.find(i=>i.id===l.value.country_id);return!a&&l.value.parent&&l.value.parent.country_id&&(a=Y.value.find(i=>i.id===l.value.parent.country_id)),a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),Se=C(()=>{const e=l.value.parent;return e?(localStorage.getItem("lang")||"en")==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar:"None"}),W=C(()=>{let e=R.value.find(a=>a.id===l.value.brand_id);return!e&&l.value.parent&&l.value.parent.brand&&(e=l.value.parent.brand),e&&e.images&&e.images.length>0?q(e.images[0].path):null}),ue=C(()=>{const e=localStorage.getItem("lang")||"en",a=R.value.find(i=>i.id===l.value.brand_id);return a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),oe=C(()=>{const e=localStorage.getItem("lang")||"en",a=T.value.find(i=>i.id===l.value.category_id);return a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),ie=C(()=>{const e=localStorage.getItem("lang")||"en",a=x.value.find(i=>i.id===l.value.currency_id);return a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),de=C(()=>{const e=localStorage.getItem("lang")||"en",a=Y.value.find(i=>i.id===l.value.country_id);return a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),se=C(()=>{const e=j.value.find(i=>i.id===l.value.parent_id);return e?(localStorage.getItem("lang")||"en")==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar:"None"}),ee=C(()=>{const e=R.value.find(a=>a.id===l.value.brand_id);return e&&e.images&&e.images.length>0?q(e.images[0].path):null}),q=e=>e?typeof e=="object"&&e.url?e.url:e.startsWith("http")?e:`${E}/public/storage/${e}`:"",ae=e=>{const a=localStorage.getItem("lang")||"en";return e?a==="ar"?e.name_ar||e.name_en||"":e.name_en||e.name_ar||"":""},ce=e=>{const a=localStorage.getItem("lang")||"en";return e?a==="ar"?e.name_ar||e.name_en||"":e.name_en||e.name_ar||"":""},pe=e=>typeof e=="string"&&e.includes("%"),me=e=>!e||!pe(e)?0:parseFloat(e.replace("%",""))||0,Ue=(e,a)=>{l.value.attribute_values[e]=`${a}%`},Ce=(e,a)=>{l.value.attribute_values[e]=a},le=e=>Z.value.find(a=>a.id===e),Ee=(e,a)=>{if(!e)return"";let i=e;const o=i.match(/<defs[^>]*>([\s\S]*?)<\/defs>/);let u=o?o[1]:"";const m=typeof a=="string"&&a.includes("%"),P=m?parseFloat(a.replace("%","")):null;if(m&&P!==null&&!isNaN(P)){const k=Math.max(0,Math.min(1,P/100)),V=u.match(/<linearGradient id="(g[0-9]+)"[^>]*>([\s\S]*?)<\/linearGradient>/);if(V){const d=V[1];let h=V[2];h=h.replace(/<stop offset="[^"]*"([^>]*)>/g,()=>`<stop offset="${k}" stop-color="#78D6F0"/><stop offset="${k}" stop-color="#8D8D8D" stop-opacity="0.2"/>`);const F=`<linearGradient id="${d}"${V[0].split(d)[1].split(">")[0]}>${h}</linearGradient>`;u=u.replace(V[0],F),i.includes('fill="')&&!i.includes(`fill="url(#${d})"`)&&(i=i.replace(/fill="[^"]*"/g,`fill="url(#${d})"`)),i.includes('stroke="')&&!i.includes(`stroke="url(#${d})"`)&&(i=i.replace(/stroke="[^"]*"/g,`stroke="url(#${d})" stroke-width="2"`))}else{const d=`gradient-${Math.random().toString(36).substr(2,9)}`,h=`
      <linearGradient id="${d}" x1="0%" y1="100%" x2="0%" y2="0%" gradientUnits="userSpaceOnUse">
        <stop offset="${k}" stop-color="#78D6F0"/>
        <stop offset="${k}" stop-color="#8D8D8D" stop-opacity="0.2"/>
      </linearGradient>
    `;u+=h,i.includes('fill="')&&(i=i.replace(/fill="[^"]*"/g,`fill="url(#${d})"`)),i.includes('stroke="')&&(i=i.replace(/stroke="[^"]*"/g,`stroke="url(#${d})" stroke-width="2"`))}if(o)i=i.replace(o[0],`<defs>${u}</defs>`);else{const d=i.match(/<svg[^>]*>/);d&&(i=i.replace(d[0],`${d[0]}<defs>${u}</defs>`))}}const f=i.lastIndexOf("</svg>");return f!==-1&&a?i.substring(0,f)+`<text x="50%" y="50%" font-size="16" font-weight="bold" text-anchor="middle" dominant-baseline="middle" fill="#333333" stroke="white" stroke-width="1">${a}</text>`+i.substring(f):i},Me=async()=>{var a,i;const e=(a=JSON.parse(localStorage.getItem("tokenData")))==null?void 0:a.token;D.defaults.headers.common.Authorization=`Bearer ${e}`,O.value=!0;try{const[o,u,m,P,f,k,V,d]=await Promise.all([l.value.brand_id?D.get(`${E}/api/brands/${l.value.brand_id}/categories`):D.get(`${E}/api/categories`),D.get(`${E}/api/website/currencies`),D.get(`${E}/api/countries`),D.get(`${E}/api/products`),D.get(`${E}/api/brands`),D.get(`${E}/api/units`),D.get(`${E}/api/attributes`),D.get(`${E}/api/main-ingredients`)]);T.value=o.data.data,console.log("Categories:",T.value),H.value=u.data.data,Y.value=m.data.data,j.value=P.data.data,R.value=f.data.data.map(h=>({...h,logo_path:h.images&&h.images.length>0?h.images[0].path:null})),J.value=k.data.data,Z.value=V.data.data||[],re.value=Array.isArray(d.data)?d.data:((i=d.data)==null?void 0:i.data)||[]}catch(o){console.error("Error fetching options",o)}finally{O.value=!1}},Be=async()=>{var e,a,i,o,u,m,P,f,k;O.value=!0;try{const d=(await D.get(`/api/products/${ne}`)).data.data;console.log(d),l.value.name_ar=d.name_ar,l.value.name_en=d.name_en,l.value.description_ar=d.description_ar,l.value.description_en=d.description_en,l.value.price=d.price,l.value.category_ar=(e=d.category)==null?void 0:e.name_ar,l.value.category_en=(a=d.category)==null?void 0:a.name_en,l.value.currency_id=d.currency_id,l.value.country_id=d.country_id,l.value.brand_id=d.brand_id,l.value.parent_id=d.parent_id,ye.value=d.currency_id,he.value=d.country_id,fe.value=d.brand_id,$e.value=d.parent_id,l.value.quantity=d.quantity??1,l.value.amounts=((i=d.amounts)==null?void 0:i.map(p=>({unit_id:p.unit_id,weight:p.weight,price:p.price,id:p.id})))||[],l.value.amounts.length>0&&(l.value.price=((o=l.value.amounts[0])==null?void 0:o.price)??l.value.price),l.value.type=d.type??"product",l.value.offer=d.discount?"1":"0",l.value.offer_price=d.discount?d.discounted_price:"",l.value.category_id=d.category_id,be.value=d.category_id,l.value.images=d.images.map(p=>({id:p.id,path:p.path,url:q(p.path)})),l.value.discount=d.discount?{id:d.discount.id,value:parseFloat(d.discount.discount_value),startDate:(u=d.discount.start_date)==null?void 0:u.split("T")[0],endDate:(m=d.discount.end_date)==null?void 0:m.split("T")[0],is_active:d.discount.is_active}:{id:null,value:null,startDate:null,endDate:null,is_active:!1},l.value.attributes=((P=d.attributes)==null?void 0:P.map(p=>({name_en:p.name_en,name_ar:p.name_ar,value:p.value,id:p.id})))||[],l.value.main_ingredients=((f=d.main_ingredients)==null?void 0:f.map(p=>({name_en:p.name_en,name_ar:p.name_ar,id:p.id,images:p.images.map(M=>({id:M.id,path:M.path,url:q(M.path)}))||[]})))||[],l.value.fragrance_notes=((k=d.fragrance_notes)==null?void 0:k.map(p=>({name_en:p.name_en,name_ar:p.name_ar,description_en:p.description_en,description_ar:p.description_ar,id:p.id})))||[];let h=[];if(Array.isArray(d.attributes)&&(h=h.concat(d.attributes)),d.parent&&Array.isArray(d.parent.attributes_with_values)){const p=new Set(h.map(z=>z.id)),M=d.parent.attributes_with_values.filter(z=>!p.has(z.id));h=h.concat(M)}if(Array.isArray(h)&&h.length>0){l.value.attribute_ids=h.map(M=>M.id);const p={};h.forEach(M=>{p[M.id]=M.value}),l.value.attribute_values=p}else l.value.attribute_ids=[],l.value.attribute_values={};l.value.selected_main_ingredient_ids=(d.main_ingredients||[]).filter(p=>p&&p.id).map(p=>p.id),Q.value=d.converted_price??null,X.value=d.discounted_price??null;const[F,K,B]=await Promise.all([D.get("/api/categories"),D.get("/api/website/currencies"),D.get("/api/brands")]);T.value=F.data.data,H.value=K.data.data,R.value=B.data.data.map(p=>({...p,logo_path:p.images&&p.images.length>0?p.images[0].path:null}))}catch(V){console.error("Error loading product data",V)}finally{O.value=!1}},Te=(e,a)=>l.value.images=a,Oe=(e,a)=>l.value.images=a,Re=(e,a,i)=>{l.value.main_ingredients[i].images=a},Fe=(e,a,i)=>{l.value.main_ingredients[i].images=a},qe=()=>{te.value.validate(async e=>{var i;if(!e)return;const a=new FormData;Array.isArray(l.value.amounts)&&l.value.amounts.length>0;for(const o in l.value){if(o==="images"||o==="amounts"||o==="attributes"||o==="main_ingredients"||o==="fragrance_notes"||o==="discount")continue;const u=l.value[o];if(!(u==null||u===""))if(o==="price"){const m=typeof u=="number"?u:Number(u);if(Number.isNaN(m))continue;a.append("price",m)}else a.append(o,u)}Array.isArray(l.value.attribute_ids)&&l.value.attribute_ids.forEach((o,u)=>{var P;a.append(`attribute_ids[${u}]`,o);const m=(P=l.value.attribute_values)==null?void 0:P[o];if(m!=null&&m!==""){let f=m;typeof f=="string"&&f.includes("%")&&(f=parseFloat(f.replace("%",""))),a.append(`attribute_values[${o}]`,f)}}),Array.isArray(l.value.selected_main_ingredient_ids)&&l.value.selected_main_ingredient_ids.length>0&&l.value.selected_main_ingredient_ids.forEach((o,u)=>{a.append(`selected_main_ingredient_ids[${u}]`,o)}),l.value.amounts.forEach((o,u)=>{a.append(`amounts[${u}][unit_id]`,o.unit_id),a.append(`amounts[${u}][weight]`,o.weight),a.append(`amounts[${u}][price]`,o.price),o.id&&a.append(`amounts[${u}][id]`,o.id)}),l.value.images.forEach(o=>{o.raw?a.append("images[]",o.raw):o.id&&a.append("existing_images[]",o.id)}),l.value.discount.value&&(a.append("discount[value]",l.value.discount.value),a.append("discount[startDate]",l.value.discount.startDate),a.append("discount[endDate]",l.value.discount.endDate),l.value.discount.id&&a.append("discount[id]",l.value.discount.id)),l.value.attributes.forEach((o,u)=>{a.append(`attributes[${u}][name_en]`,o.name_en),a.append(`attributes[${u}][name_ar]`,o.name_ar),a.append(`attributes[${u}][value]`,o.value),o.id&&a.append(`attributes[${u}][id]`,o.id)}),l.value.main_ingredients.forEach((o,u)=>{a.append(`main_ingredients[${u}][name_en]`,o.name_en),a.append(`main_ingredients[${u}][name_ar]`,o.name_ar),o.id&&a.append(`main_ingredients[${u}][id]`,o.id),o.images.forEach(m=>{m.raw?a.append(`main_ingredients[${u}][images][]`,m.raw):m.id&&a.append(`main_ingredients[${u}][existing_images][]`,m.id)})}),l.value.fragrance_notes.forEach((o,u)=>{a.append(`fragrance_notes[${u}][name_en]`,o.name_en),a.append(`fragrance_notes[${u}][name_ar]`,o.name_ar),a.append(`fragrance_notes[${u}][description_en]`,o.description_en),a.append(`fragrance_notes[${u}][description_ar]`,o.description_ar),o.id&&a.append(`fragrance_notes[${u}][id]`,o.id)}),O.value=!0;try{const o=(i=JSON.parse(localStorage.getItem("tokenData")))==null?void 0:i.token;D.defaults.headers.common.Authorization=`Bearer ${o}`,await D.post(`${E}/api/products/${ne}?_method=PUT`,a,{headers:{"Content-Type":"multipart/form-data"}}),S.success("Product updated successfully"),_e.push("/products")}catch(o){console.error("Error submitting form",o),S.error("Error updating product")}finally{O.value=!1}})},Ye=()=>{G.confirm(localStorage.getItem("lang")==="ar"?"سيتم حذف الخصم":"The discount will be deleted","Warning",{confirmButtonText:localStorage.getItem("lang")==="ar"?"موافق":"OK",cancelButtonText:localStorage.getItem("lang")==="ar"?"إلغاء":"Cancel",type:"warning"}).then(()=>{l.value.discount={id:null,value:null,startDate:null,endDate:null,is_active:!1},S.success(localStorage.getItem("lang")==="ar"?"تم حذف الخصم بنجاح":"Discount deleted successfully")}).catch(()=>{S.info(localStorage.getItem("lang")==="ar"?"تم إلغاء الحذف":"Delete cancelled")})},ze=()=>{l.value.attributes.push({name_en:"",name_ar:"",value:""})},Le=e=>{if(l.value.attributes.length<=1){S.warning(localStorage.getItem("lang")==="ar"?"يجب عليك حفظ خاصية واحدة على الاقل":"At least one attribute is required.");return}G.confirm(localStorage.getItem("lang")==="ar"?"سيتم حذف الخاصية":"The attribute will be deleted","Warning",{confirmButtonText:localStorage.getItem("lang")==="ar"?"موافق":"OK",cancelButtonText:localStorage.getItem("lang")==="ar"?"إلغاء":"Cancel",type:"warning"}).then(()=>{l.value.attributes.splice(e,1),S.success(localStorage.getItem("lang")==="ar"?"تم حذف الخاصية بنجاح":"Attribute deleted successfully")}).catch(()=>{S.info(localStorage.getItem("lang")==="ar"?"تم إلغاء الحذف":"Delete cancelled")})},Ge=()=>{l.value.main_ingredients.push({name_en:"",name_ar:""})},We=e=>{if(l.value.main_ingredients.length<=1){S.warning(localStorage.getItem("lang")==="ar"?"يجب عليك حفظ مكون أساسي واحد على الاقل":"At least one main ingredient is required.");return}G.confirm(localStorage.getItem("lang")==="ar"?"سيتم حذف المكون الأساسي":"The main ingredient will be deleted","Warning",{confirmButtonText:localStorage.getItem("lang")==="ar"?"موافق":"OK",cancelButtonText:localStorage.getItem("lang")==="ar"?"إلغاء":"Cancel",type:"warning"}).then(()=>{l.value.main_ingredients.splice(e,1),S.success(localStorage.getItem("lang")==="ar"?"تم حذف المكون الأساسي بنجاح":"Main ingredient deleted successfully")}).catch(()=>{S.info(localStorage.getItem("lang")==="ar"?"تم إلغاء الحذف":"Delete cancelled")})},Ke=()=>{l.value.fragrance_notes.push({name_en:"",name_ar:"",description_en:"",description_ar:""})},He=e=>{if(l.value.fragrance_notes.length<=1){S.warning(localStorage.getItem("lang")==="ar"?"يجب عليك حفظ ملاحظة عطرية واحدة على الاقل":"At least one fragrance note is required.");return}G.confirm(localStorage.getItem("lang")==="ar"?"سيتم حذف الملاحظة العطرية":"The fragrance note will be deleted","Warning",{confirmButtonText:localStorage.getItem("lang")==="ar"?"موافق":"OK",cancelButtonText:localStorage.getItem("lang")==="ar"?"إلغاء":"Cancel",type:"warning"}).then(()=>{l.value.fragrance_notes.splice(e,1),S.success(localStorage.getItem("lang")==="ar"?"تم حذف الملاحظة العطرية بنجاح":"Fragrance note deleted successfully")}).catch(()=>{S.info(localStorage.getItem("lang")==="ar"?"تم إلغاء الحذف":"Delete cancelled")})};return ge(()=>l.value.brand_id,async e=>{if(e)try{const a=await D.get(`${E}/api/brands/${e}/categories`);T.value=a.data.data,console.log("Categories for brand:",T.value)}catch(a){console.error("Failed to fetch categories for brand",a)}else{const a=await D.get(`${E}/api/categories`);T.value=a.data.data,l.value.category_id=null}}),Qe(async()=>{await Be(),Me()}),ge(()=>l.value.amounts,e=>{var a;Array.isArray(e)&&e.length>0&&(l.value.price=((a=e[0])==null?void 0:a.price)??null)},{deep:!0}),(e,a)=>{const i=U("el-option"),o=U("el-select"),u=U("el-form-item"),m=U("el-input"),P=U("el-divider"),f=U("el-col"),k=U("el-row"),V=U("el-button"),d=U("el-upload"),h=U("el-switch"),F=U("el-input-number"),K=U("el-date-picker"),B=U("el-tag"),p=U("el-form"),M=U("el-card"),z=Xe("loading");return s(),v("div",la,[xe((s(),$(M,{class:"product-card"},{default:r(()=>[w("h2",null,_(e.$t("Products.EditProduct")),1),n(p,{model:l.value,ref_key:"formRef",ref:te,rules:ke,"label-width":"120px",enctype:"multipart/form-data"},{default:r(()=>[n(u,{label:e.$t("Products.SelectExistingMainIngredients")},{default:r(()=>[n(o,{modelValue:l.value.selected_main_ingredient_ids,"onUpdate:modelValue":a[0]||(a[0]=t=>l.value.selected_main_ingredient_ids=t),placeholder:e.$t("Products.SelectExistingMainIngredients"),filterable:"",clearable:"",multiple:""},{default:r(()=>[(s(!0),v(I,null,N(re.value,t=>(s(),$(i,{key:t.id,label:ce(t),value:t.id},{default:r(()=>[y(_(ce(t)),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),n(u,{label:e.$t("Products.Attributes"),prop:"attribute_ids"},{default:r(()=>[n(o,{modelValue:l.value.attribute_ids,"onUpdate:modelValue":a[1]||(a[1]=t=>l.value.attribute_ids=t),placeholder:e.$t("Products.SelectAttributes"),filterable:"",clearable:"",multiple:"","popper-class":"attribute-dropdown"},{default:r(()=>[(s(!0),v(I,null,N(Z.value,t=>(s(),$(i,{key:t.id,label:ae(t),value:t.id},{default:r(()=>[w("div",ta,[t.icon?(s(),v("div",{key:0,class:"attribute-icon",innerHTML:t.icon},null,8,na)):b("",!0),w("span",null,_(ae(t)),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),n(u,{label:e.$t("Products.AttributeValues")},{default:r(()=>[(s(!0),v(I,null,N(l.value.attribute_ids,t=>{var g;return s(),v("div",{key:t,class:"attribute-value-item"},[w("div",ra,[(g=le(t))!=null&&g.icon?(s(),v("div",{key:0,class:"attribute-icon",innerHTML:Ee(le(t).icon,l.value.attribute_values[t])},null,8,ua)):b("",!0),w("span",null,_(ae(le(t))||t),1)]),w("div",oa,[n(m,{modelValue:l.value.attribute_values[t],"onUpdate:modelValue":c=>l.value.attribute_values[t]=c,placeholder:e.$t("Products.AttributeValues"),onInput:c=>Ce(t,c)},null,8,["modelValue","onUpdate:modelValue","placeholder","onInput"]),pe(l.value.attribute_values[t])?(s(),v("div",ia,[a[21]||(a[21]=w("label",{class:"gradient-label"},"Gradient %:",-1)),w("input",{type:"range",value:me(l.value.attribute_values[t]),min:"0",max:"100",onInput:c=>Ue(t,c.target.value),class:"gradient-range"},null,40,da),w("span",sa,_(me(l.value.attribute_values[t]))+"%",1)])):b("",!0)])])}),128)),(l.value.attribute_ids||[]).length===0?(s(),v("div",ca,_(e.$t("Products.PleaseSelectAttributesFirst")),1)):b("",!0)]),_:1},8,["label"]),n(u,{label:e.$t("Products.NameEn"),prop:"name_en"},{default:r(()=>[n(m,{modelValue:l.value.name_en,"onUpdate:modelValue":a[2]||(a[2]=t=>l.value.name_en=t),placeholder:e.$t("Products.NameEn")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(u,{label:e.$t("Products.NameAr"),prop:"name_ar"},{default:r(()=>[n(m,{modelValue:l.value.name_ar,"onUpdate:modelValue":a[3]||(a[3]=t=>l.value.name_ar=t),placeholder:e.$t("Products.NameAr")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l.value.amounts?(s(!0),v(I,{key:0},N(l.value.amounts,(t,g)=>(s(),v("div",{key:g,class:"amount-entry mb-3"},[n(P,{"content-position":"left"},{default:r(()=>[y(_(e.$t("Products.Amount-Info")),1)]),_:1}),n(k,{gutter:20},{default:r(()=>[n(f,{span:12},{default:r(()=>[n(u,{label:e.$t("Products.Unit"),prop:`amounts.${g}.unit_id`},{default:r(()=>[n(o,{modelValue:t.unit_id,"onUpdate:modelValue":c=>t.unit_id=c,placeholder:e.$t("Products.select-unit"),filterable:"",clearable:""},{default:r(()=>[(s(!0),v(I,null,N(J.value,c=>(s(),$(i,{key:c.id,label:c.name_en,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),n(f,{span:12},{default:r(()=>[n(u,{label:e.$t("Products.Weight"),prop:`amounts.${g}.weight`},{default:r(()=>[n(m,{modelValue:t.weight,"onUpdate:modelValue":c=>t.weight=c,type:"number",min:1,placeholder:e.$t("Products.Weight")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),n(f,{span:12},{default:r(()=>[n(u,{label:e.$t("Products.amount-Price"),prop:`amounts.${g}.price`},{default:r(()=>[n(m,{modelValue:t.price,"onUpdate:modelValue":c=>t.price=c,type:"number",min:1,placeholder:e.$t("Products.amount-Price")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024)]),_:2},1024),n(k,{gutter:20,class:"button-row"},{default:r(()=>[n(f,{span:24},{default:r(()=>[l.value.amounts.length>0?(s(),$(V,{key:0,type:"danger",onClick:c=>Pe(g),icon:"el-icon-delete"},{default:r(()=>[y(_(e.$t("Products.RemoveAmount")),1)]),_:1},8,["onClick"])):b("",!0),l.value.amounts.length>0?(s(),$(V,{key:1,type:"success",plain:"",onClick:Ve,icon:"el-icon-plus"},{default:r(()=>[y(_(e.$t("Products.AddAmount")),1)]),_:1})):b("",!0)]),_:2},1024)]),_:2},1024)]))),128)):b("",!0),n(P,{"content-position":"left"},{default:r(()=>[y(_(e.$t("Products.Attributes")),1)]),_:1}),(s(!0),v(I,null,N(l.value.attributes,(t,g)=>(s(),v("div",{key:g,class:"attribute-entry"},[w("div",pa,[w("span",ma,_(e.$t("Products.Attributes"))+" #"+_(g+1),1),n(V,{class:"attribute-remove",type:"danger",text:"",circle:"",icon:ea(aa),onClick:c=>Le(g)},null,8,["icon","onClick"])]),n(k,{gutter:16,class:"attribute-fields"},{default:r(()=>[n(f,{span:8},{default:r(()=>[n(u,{label:e.$t("Products.NameEn"),prop:`attributes.${g}.name_en`},{default:r(()=>[n(m,{modelValue:t.name_en,"onUpdate:modelValue":c=>t.name_en=c,placeholder:e.$t("Products.NameEn")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),n(f,{span:8},{default:r(()=>[n(u,{label:e.$t("Products.NameAr"),prop:`attributes.${g}.name_ar`},{default:r(()=>[n(m,{modelValue:t.name_ar,"onUpdate:modelValue":c=>t.name_ar=c,placeholder:e.$t("Products.NameAr")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),n(f,{span:8},{default:r(()=>[n(u,{label:e.$t("Products.Value"),prop:`attributes.${g}.value`},{default:r(()=>[n(m,{modelValue:t.value,"onUpdate:modelValue":c=>t.value=c,placeholder:e.$t("Products.Value")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024)]),_:2},1024)]))),128)),n(V,{type:"primary",plain:"",onClick:ze},{default:r(()=>[y(_(e.$t("Products.AddAttribute")),1)]),_:1}),l.value.main_ingredients.length>0?(s(),v(I,{key:1},[n(P,{"content-position":"left"},{default:r(()=>[y(_(e.$t("Products.MainIngredients")),1)]),_:1}),(s(!0),v(I,null,N(l.value.main_ingredients,(t,g)=>(s(),v("div",{key:g,class:"ingredient-entry mb-3"},[n(k,{gutter:20},{default:r(()=>[n(f,{span:12},{default:r(()=>[n(u,{label:`Main Ingredient Name EN ${g+1}`,prop:`main_ingredients.${g}.name_en`},{default:r(()=>[n(m,{modelValue:t.name_en,"onUpdate:modelValue":c=>t.name_en=c,placeholder:e.$t("Products.NameEn")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),n(f,{span:12},{default:r(()=>[n(u,{label:`Main Ingredient Name AR ${g+1}`,prop:`main_ingredients.${g}.name_ar`},{default:r(()=>[n(m,{modelValue:t.name_ar,"onUpdate:modelValue":c=>t.name_ar=c,placeholder:e.$t("Products.NameAr")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024)]),_:2},1024),n(k,{gutter:20},{default:r(()=>[n(f,{span:24},{default:r(()=>[t.images&&t.images.length?(s(),v("div",ga,[(s(!0),v(I,null,N(t.images,(c,L)=>(s(),v("img",{key:L,src:c.url?c.url:q(c.path),alt:"Main Ingredient Image",style:{"max-width":"120px","max-height":"120px","margin-right":"10px","border-radius":"8px"}},null,8,_a))),128))])):b("",!0),n(u,{label:e.$t("Products.Images"),prop:`main_ingredients.${g}.images`},{default:r(()=>[n(d,{class:"upload-demo",drag:"",action:"","auto-upload":!1,limit:1,"file-list":t.images,"list-type":"picture","on-change":(c,L)=>Re(c,L,g),"on-remove":(c,L)=>Fe(c,L,g)},{default:r(()=>[a[22]||(a[22]=w("i",{class:"el-icon-upload"},null,-1)),w("div",va,_(e.$t("Products.DropFiles")),1)]),_:1},8,["file-list","on-change","on-remove"])]),_:2},1032,["label","prop"])]),_:2},1024)]),_:2},1024),n(k,{gutter:20,class:"button-row"},{default:r(()=>[n(f,{span:24},{default:r(()=>[n(V,{type:"danger",onClick:c=>We(g)},{default:r(()=>[y(_(e.$t("Products.RemoveMainIngredient")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128))],64)):b("",!0),n(V,{type:"primary",onClick:Ge},{default:r(()=>[y(_(e.$t("Products.AddMainIngredient")),1)]),_:1}),n(P,{"content-position":"left"},{default:r(()=>[y(_(e.$t("Products.FragranceNotes")),1)]),_:1}),(s(!0),v(I,null,N(l.value.fragrance_notes,(t,g)=>(s(),v("div",{key:g,class:"fragrance-note-entry mb-3"},[n(k,{gutter:20},{default:r(()=>[n(f,{span:12},{default:r(()=>[n(u,{label:`Note Name EN ${g+1}`,prop:`fragrance_notes.${g}.name_en`},{default:r(()=>[n(m,{modelValue:t.name_en,"onUpdate:modelValue":c=>t.name_en=c,placeholder:e.$t("Products.NameEn")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),n(f,{span:12},{default:r(()=>[n(u,{label:`Note Name AR ${g+1}`,prop:`fragrance_notes.${g}.name_ar`},{default:r(()=>[n(m,{modelValue:t.name_ar,"onUpdate:modelValue":c=>t.name_ar=c,placeholder:e.$t("Products.NameAr")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024)]),_:2},1024),n(k,{gutter:20},{default:r(()=>[n(f,{span:12},{default:r(()=>[n(u,{label:`Note Description EN ${g+1}`,prop:`fragrance_notes.${g}.description_en`},{default:r(()=>[n(m,{type:"textarea",modelValue:t.description_en,"onUpdate:modelValue":c=>t.description_en=c,placeholder:e.$t("Products.DescriptionEn")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),n(f,{span:12},{default:r(()=>[n(u,{label:`Note Description AR ${g+1}`,prop:`fragrance_notes.${g}.description_ar`},{default:r(()=>[n(m,{type:"textarea",modelValue:t.description_ar,"onUpdate:modelValue":c=>t.description_ar=c,placeholder:e.$t("Products.DescriptionAr")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024)]),_:2},1024),n(k,{gutter:20,class:"button-row"},{default:r(()=>[n(f,{span:24},{default:r(()=>[n(V,{type:"danger",onClick:c=>He(g)},{default:r(()=>[y(_(e.$t("Products.RemoveFragranceNote")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),n(V,{type:"primary",onClick:Ke},{default:r(()=>[y(_(e.$t("Products.AddFragranceNote")),1)]),_:1}),n(u,{label:e.$t("Products.discount"),prop:"discount.value"},{default:r(()=>[n(h,{modelValue:l.value.discount.is_active,"onUpdate:modelValue":a[4]||(a[4]=t=>l.value.discount.is_active=t),"active-text":"Yes","inactive-text":"No"},null,8,["modelValue"])]),_:1},8,["label"]),l.value.discount&&l.value.discount.is_active?(s(),v("div",fa,[n(P,{"content-position":"left"},{default:r(()=>[y(_(e.$t("Products.discountInfo")),1)]),_:1}),l.value.discount.is_active?(s(),v(I,{key:0},[n(u,{label:e.$t("Products.Discount-Value"),prop:"discount.value"},{default:r(()=>[n(F,{modelValue:l.value.discount.value,"onUpdate:modelValue":a[5]||(a[5]=t=>l.value.discount.value=t),type:"number",min:1,max:99,placeholder:e.$t("Products.Discount-Value")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(u,{label:e.$t("Products.Start-Date"),prop:"discount.startDate"},{default:r(()=>[n(K,{modelValue:l.value.discount.startDate,"onUpdate:modelValue":a[6]||(a[6]=t=>l.value.discount.startDate=t),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",placeholder:e.$t("Products.Start-Date"),style:{width:"100%"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(u,{label:e.$t("Products.End-Date"),prop:"discount.endDate"},{default:r(()=>[n(K,{modelValue:l.value.discount.endDate,"onUpdate:modelValue":a[7]||(a[7]=t=>l.value.discount.endDate=t),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",placeholder:e.$t("Products.End-Date"),style:{width:"100%"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l.value.discount.value?(s(),$(V,{key:0,type:"danger",icon:"el-icon-delete",onClick:Ye},{default:r(()=>[y(_(e.$t("Products.removeDiscount")),1)]),_:1})):b("",!0),n(P)],64)):b("",!0)])):b("",!0),!l.value.amounts.length>0?(s(),$(u,{key:3,label:e.$t("Products.Needs-Amount")},{default:r(()=>[n(h,{modelValue:l.value.amount_required,"onUpdate:modelValue":a[8]||(a[8]=t=>l.value.amount_required=t),"active-text":"Yes","inactive-text":"No",dir:"ltr",class:"mx-3"},null,8,["modelValue"])]),_:1},8,["label"])):b("",!0),l.value.amount_required?(s(),v(I,{key:4},[n(P,{"content-position":"left"},{default:r(()=>[y(_(e.$t("Products.Amount-Info")),1)]),_:1}),n(u,{label:e.$t("Products.Unit"),prop:"unit_id"},{default:r(()=>[n(o,{modelValue:l.value.unit_id,"onUpdate:modelValue":a[9]||(a[9]=t=>l.value.unit_id=t),placeholder:e.$t("Products.select-unit"),filterable:"",clearable:""},{default:r(()=>[(s(!0),v(I,null,N(J.value,t=>(s(),$(i,{key:t.id,label:t.name_en,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),n(u,{label:e.$t("Products.Weight"),prop:"weight"},{default:r(()=>[n(F,{modelValue:l.value.weight,"onUpdate:modelValue":a[10]||(a[10]=t=>l.value.weight=t),type:"number",min:1,placeholder:e.$t("Products.select-weight")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(u,{label:e.$t("Products.amount-Price"),prop:"amount_price"},{default:r(()=>[n(F,{modelValue:l.value.amount_price,"onUpdate:modelValue":a[11]||(a[11]=t=>l.value.amount_price=t),type:"number",min:1,placeholder:e.$t("Products.select-price")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])],64)):b("",!0),!l.value.amounts||l.value.amounts.length===0?(s(),$(u,{key:5,label:e.$t("Products.Price"),prop:"price"},{default:r(()=>[n(m,{modelValue:l.value.price,"onUpdate:modelValue":a[12]||(a[12]=t=>l.value.price=t),type:"number",min:1,placeholder:e.$t("Products.Price")},null,8,["modelValue","placeholder"]),Q.value!==null?(s(),$(B,{key:0,size:"small",effect:"plain",class:"current-value"},{default:r(()=>[y("Converted: "+_(Q.value),1)]),_:1})):b("",!0),X.value!==null?(s(),$(B,{key:1,size:"small",type:"success",effect:"plain",class:"current-value"},{default:r(()=>[y("Discounted: "+_(X.value),1)]),_:1})):b("",!0)]),_:1},8,["label"])):b("",!0),n(u,{label:e.$t("Products.Availability"),prop:"is_available"},{default:r(()=>[n(h,{modelValue:l.value.is_available,"onUpdate:modelValue":a[13]||(a[13]=t=>l.value.is_available=t),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1},8,["label"]),n(u,{label:e.$t("Products.DescriptionEn"),prop:"description_en"},{default:r(()=>[n(m,{type:"textarea",modelValue:l.value.description_en,"onUpdate:modelValue":a[14]||(a[14]=t=>l.value.description_en=t),placeholder:e.$t("Products.DescriptionEn")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(u,{label:e.$t("Products.DescriptionAr"),prop:"description_ar"},{default:r(()=>[n(m,{type:"textarea",modelValue:l.value.description_ar,"onUpdate:modelValue":a[15]||(a[15]=t=>l.value.description_ar=t),placeholder:e.$t("Products.DescriptionAr")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(u,{label:e.$t("Products.brand"),prop:"brand_id"},{default:r(()=>[n(o,{modelValue:l.value.brand_id,"onUpdate:modelValue":a[16]||(a[16]=t=>l.value.brand_id=t),filterable:"",clearable:"",placeholder:e.$t("Products.SelectBrand")},{default:r(()=>[(s(!0),v(I,null,N(R.value,t=>(s(),$(i,{key:t.id,label:t.name_en,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Ae.value!==ue.value?(s(),$(B,{key:0,size:"small",effect:"plain",class:"current-value"},{default:r(()=>[y("("+_(e.$t("Products.Original"))+": "+_(ue.value)+")",1)]),_:1})):b("",!0)]),_:1},8,["label"]),W.value||ee.value?(s(),v("div",ba,[W.value?(s(),v("img",{key:0,src:W.value,alt:"Brand Image",style:{"max-width":"120px","max-height":"120px","margin-right":"10px","border-radius":"8px"}},null,8,ya)):b("",!0),W.value!==ee.value?(s(),$(B,{key:1,size:"small",effect:"plain",class:"current-value"},{default:r(()=>[y("("+_(e.$t("Products.Original"))+" brand: ",1),w("img",{src:ee.value,alt:"Original Brand Image",style:{"max-width":"40px","max-height":"40px","border-radius":"4px"}},null,8,ha),a[23]||(a[23]=y(")",-1))]),_:1})):b("",!0)])):b("",!0),n(u,{label:e.$t("Products.Category"),prop:"category_id"},{default:r(()=>[n(o,{modelValue:l.value.category_id,"onUpdate:modelValue":a[17]||(a[17]=t=>l.value.category_id=t),filterable:"",clearable:"",placeholder:e.$t("Products.SelectCategory")},{default:r(()=>[(s(!0),v(I,null,N(T.value,t=>(s(),$(i,{key:t.id,label:t.name_en||t.name_ar,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),De.value!==oe.value?(s(),$(B,{key:0,size:"small",effect:"plain",class:"current-value"},{default:r(()=>[y("("+_(e.$t("Products.Original"))+": "+_(oe.value)+")",1)]),_:1})):b("",!0)]),_:1},8,["label"]),n(u,{label:e.$t("Products.Currency"),prop:"currency_id"},{default:r(()=>[n(o,{modelValue:l.value.currency_id,"onUpdate:modelValue":a[18]||(a[18]=t=>l.value.currency_id=t),filterable:"",clearable:"",placeholder:e.$t("Products.SelectCurrency")},{default:r(()=>[(s(!0),v(I,null,N(x.value,t=>(s(),$(i,{key:t.id,label:Ie(t),value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),we.value!==ie.value?(s(),$(B,{key:0,size:"small",effect:"plain",class:"current-value"},{default:r(()=>[y("("+_(e.$t("Products.Original"))+": "+_(ie.value)+")",1)]),_:1})):b("",!0)]),_:1},8,["label"]),n(u,{label:e.$t("Products.Country"),prop:"country_id"},{default:r(()=>[n(o,{modelValue:l.value.country_id,"onUpdate:modelValue":a[19]||(a[19]=t=>l.value.country_id=t),filterable:"",clearable:"",placeholder:e.$t("Products.SelectCountry")},{default:r(()=>[(s(!0),v(I,null,N(Y.value,t=>(s(),$(i,{key:t.id,label:t.name_en||t.name_ar,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Ne.value!==de.value?(s(),$(B,{key:0,size:"small",effect:"plain",class:"current-value"},{default:r(()=>[y("("+_(e.$t("Products.Original"))+": "+_(de.value)+")",1)]),_:1})):b("",!0)]),_:1},8,["label"]),n(u,{label:e.$t("Products.ParentProduct"),prop:"parent_id"},{default:r(()=>[n(o,{modelValue:l.value.parent_id,"onUpdate:modelValue":a[20]||(a[20]=t=>l.value.parent_id=t),clearable:"",placeholder:e.$t("Products.SelectParentProduct")},{default:r(()=>[n(i,{label:e.$t("Products.None"),value:null},null,8,["label"]),(s(!0),v(I,null,N(j.value,t=>(s(),$(i,{key:t.id,label:t.name_en,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Se.value!==se.value?(s(),$(B,{key:0,size:"small",effect:"plain",class:"current-value"},{default:r(()=>[y("("+_(e.$t("Products.Original"))+": "+_(se.value)+")",1)]),_:1})):b("",!0)]),_:1},8,["label"]),l.value.images&&l.value.images.length?(s(),v("div",$a,[(s(!0),v(I,null,N(l.value.images,(t,g)=>(s(),v("img",{key:g,src:t.url?t.url:q(t.path),alt:"Product Image",style:{"max-width":"120px","max-height":"120px","margin-right":"10px","border-radius":"8px"}},null,8,Va))),128))])):b("",!0),n(u,{label:e.$t("Products.Images"),prop:"images"},{default:r(()=>[n(d,{class:"upload-demo",drag:"",action:"","auto-upload":!1,limit:5,"file-list":l.value.images,"list-type":"picture","on-change":Te,"on-remove":Oe},{default:r(()=>[a[24]||(a[24]=w("i",{class:"el-icon-upload"},null,-1)),w("div",Pa,_(e.$t("Products.DropFiles")),1)]),_:1},8,["file-list"])]),_:1},8,["label"]),n(u,null,{default:r(()=>[n(V,{type:"primary",onClick:qe},{default:r(()=>[y(_(e.$t("Products.UpdateButton")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})),[[z,O.value]])])}}},Da=je(ka,[["__scopeId","data-v-61dd505f"]]);export{Da as default};
