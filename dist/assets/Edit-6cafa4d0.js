import{_ as Ze,s as Qe,Z as Xe,e as h,B as C,$ as ye,f as xe,r as w,G as ea,o as s,c as g,H as aa,m as $,w as u,h as D,a as S,t as m,b as r,F as A,k as U,j as V,i as b,K as la,y as ta,D as G,E as B}from"./index-0e709365.js";const na={class:"product-edit-container"},ra={class:"attribute-option"},ua=["innerHTML"],oa={class:"attribute-name"},da=["innerHTML"],ia={class:"attribute-input-container"},sa={key:0,class:"gradient-control"},ca=["value","onInput"],pa={class:"percent-display"},ma={key:0,class:"no-attributes-message"},_a={class:"attribute-header"},ga={class:"attribute-title"},va={key:3,class:"amount-entry mb-3"},fa={key:7,class:"image-preview-list",style:{"margin-bottom":"1em"}},ba=["src"],ya=["src"],$a={key:8,class:"image-preview-list",style:{"margin-bottom":"1em"}},ha=["src"],Va={class:"el-upload__text"},E="https://backend.msgperfumes.com",Pa={__name:"Edit",setup(ka){const $e=Qe(),he=Xe(),re=h(null),ue=he.params.id,F=h(!1),l=h({name_en:"",name_ar:"",price:"",is_available:1,description_en:"",description_ar:"",category_ar:"",category_en:"",category_id:null,currency_id:null,country_id:null,parent_id:null,brand_id:null,images:[],amount_required:!1,amounts:[],unit_id:null,weight:null,amount_price:null,discount:{id:null,value:null,startDate:null,endDate:null,is_active:!1},attributes:[],main_ingredients:[],fragrance_notes:[],attribute_ids:[],attribute_values:{},selected_main_ingredient_ids:[]}),Ve=h(null),Pe=h(null),ke=h(null),De=h(null),Ae=h(null),Ne=()=>{l.value.amounts.push({unit_id:null,weight:null,price:null})},we=e=>{G.confirm(localStorage.getItem("lang")==="ar"?"سيتم حذف الكمية":"The amount will be deleted","Warning",{confirmButtonText:localStorage.getItem("lang")==="ar"?"موافق":"OK",cancelButtonText:localStorage.getItem("lang")==="ar"?"إلغاء":"Cancel",type:"warning"}).then(()=>{const a=l.value.amounts[e];a&&a.id&&X.value.push(a.id),l.value.amounts.splice(e,1),B.success(localStorage.getItem("lang")==="ar"?"تم حذف الكمية بنجاح":"Amount deleted successfully")}).catch(()=>{B.info(localStorage.getItem("lang")==="ar"?"تم إلغاء الحذف":"Delete cancelled")})},Ie={name_en:[{required:!0,message:"Required",trigger:"blur"}],price:[{required:!0,message:"Required",trigger:"blur"}]},T=h([]),K=h([]),z=h([]),H=h([]),O=h([]),j=h([]),J=h([]),oe=h([]),Z=h(null),Q=h(null),X=h([]),de=h(!1),x=h(null),Y=h(!1),ie=h(!1),Se=e=>(localStorage.getItem("lang")||"en")==="ar"?e.name_ar:e.name_en,ee=C(()=>K.value.filter(e=>!e.is_deleted)),Ue=C(()=>{const e=localStorage.getItem("lang")||"en";let a=O.value.find(i=>i.id===l.value.brand_id);return!a&&l.value.parent&&l.value.parent.brand&&(a=l.value.parent.brand),a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),Ce=C(()=>{const e=localStorage.getItem("lang")||"en";let a=T.value.find(i=>i.id===l.value.category_id);return!a&&l.value.parent&&l.value.parent.category&&(a=l.value.parent.category),a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),Ee=C(()=>{const e=localStorage.getItem("lang")||"en";let a=ee.value.find(i=>i.id===l.value.currency_id);return!a&&l.value.parent&&l.value.parent.currency&&(a=l.value.parent.currency),a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),Me=C(()=>{const e=localStorage.getItem("lang")||"en";let a=z.value.find(i=>i.id===l.value.country_id);return!a&&l.value.parent&&l.value.parent.country_id&&(a=z.value.find(i=>i.id===l.value.parent.country_id)),a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),Be=C(()=>{const e=l.value.parent;return e?(localStorage.getItem("lang")||"en")==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar:"None"}),W=C(()=>{let e=O.value.find(a=>a.id===l.value.brand_id);return!e&&l.value.parent&&l.value.parent.brand&&(e=l.value.parent.brand),e&&e.images&&e.images.length>0?q(e.images[0].path):null}),se=C(()=>{const e=localStorage.getItem("lang")||"en",a=O.value.find(i=>i.id===l.value.brand_id);return a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),ce=C(()=>{const e=localStorage.getItem("lang")||"en",a=T.value.find(i=>i.id===l.value.category_id);return a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),pe=C(()=>{const e=localStorage.getItem("lang")||"en",a=ee.value.find(i=>i.id===l.value.currency_id);return a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),me=C(()=>{const e=localStorage.getItem("lang")||"en",a=z.value.find(i=>i.id===l.value.country_id);return a?e==="ar"?a.name_ar||a.name_en:a.name_en||a.name_ar:"N/A"}),_e=C(()=>{const e=H.value.find(i=>i.id===l.value.parent_id);return e?(localStorage.getItem("lang")||"en")==="ar"?e.name_ar||e.name_en:e.name_en||e.name_ar:"None"}),ae=C(()=>{const e=O.value.find(a=>a.id===l.value.brand_id);return e&&e.images&&e.images.length>0?q(e.images[0].path):null}),q=e=>e?typeof e=="object"&&e.url?e.url:e.startsWith("http")?e:`${E}/public/storage/${e}`:"",le=e=>{const a=localStorage.getItem("lang")||"en";return e?a==="ar"?e.name_ar||e.name_en||"":e.name_en||e.name_ar||"":""},ge=e=>{const a=localStorage.getItem("lang")||"en";return e?a==="ar"?e.name_ar||e.name_en||"":e.name_en||e.name_ar||"":""},ve=e=>{const a=localStorage.getItem("lang")||"en";return e?a==="ar"?e.name_ar||e.name_en||"":e.name_en||e.name_ar||"":""},fe=e=>typeof e=="string"&&e.includes("%"),be=e=>!e||!fe(e)?0:parseFloat(e.replace("%",""))||0,Te=(e,a)=>{l.value.attribute_values[e]=`${a}%`},Fe=(e,a)=>{l.value.attribute_values[e]=a},te=e=>J.value.find(a=>a.id===e),Oe=(e,a)=>{if(!e)return"";let i=e;const d=i.match(/<defs[^>]*>([\s\S]*?)<\/defs>/);let o=d?d[1]:"";const p=typeof a=="string"&&a.includes("%"),k=p?parseFloat(a.replace("%","")):null;if(p&&k!==null&&!isNaN(k)){const N=Math.max(0,Math.min(1,k/100)),P=o.match(/<linearGradient id="(g[0-9]+)"[^>]*>([\s\S]*?)<\/linearGradient>/);if(P){const n=P[1];let y=P[2];y=y.replace(/<stop offset="[^"]*"([^>]*)>/g,()=>`<stop offset="${N}" stop-color="#78D6F0"/><stop offset="${N}" stop-color="#8D8D8D" stop-opacity="0.2"/>`);const L=`<linearGradient id="${n}"${P[0].split(n)[1].split(">")[0]}>${y}</linearGradient>`;o=o.replace(P[0],L),i.includes('fill="')&&!i.includes(`fill="url(#${n})"`)&&(i=i.replace(/fill="[^"]*"/g,`fill="url(#${n})"`)),i.includes('stroke="')&&!i.includes(`stroke="url(#${n})"`)&&(i=i.replace(/stroke="[^"]*"/g,`stroke="url(#${n})" stroke-width="2"`))}else{const n=`gradient-${Math.random().toString(36).substr(2,9)}`,y=`
      <linearGradient id="${n}" x1="0%" y1="100%" x2="0%" y2="0%" gradientUnits="userSpaceOnUse">
        <stop offset="${N}" stop-color="#78D6F0"/>
        <stop offset="${N}" stop-color="#8D8D8D" stop-opacity="0.2"/>
      </linearGradient>
    `;o+=y,i.includes('fill="')&&(i=i.replace(/fill="[^"]*"/g,`fill="url(#${n})"`)),i.includes('stroke="')&&(i=i.replace(/stroke="[^"]*"/g,`stroke="url(#${n})" stroke-width="2"`))}if(d)i=i.replace(d[0],`<defs>${o}</defs>`);else{const n=i.match(/<svg[^>]*>/);n&&(i=i.replace(n[0],`${n[0]}<defs>${o}</defs>`))}}const f=i.lastIndexOf("</svg>");return f!==-1&&a?i.substring(0,f)+`<text x="50%" y="50%" font-size="16" font-weight="bold" text-anchor="middle" dominant-baseline="middle" fill="#333333" stroke="white" stroke-width="1">${a}</text>`+i.substring(f):i},Re=async()=>{var a,i;const e=(a=JSON.parse(localStorage.getItem("tokenData")))==null?void 0:a.token;D.defaults.headers.common.Authorization=`Bearer ${e}`,F.value=!0;try{const[d,o,p,k,f,N,P,n]=await Promise.all([l.value.brand_id?D.get(`${E}/api/brands/${l.value.brand_id}/categories`):D.get(`${E}/api/categories`),D.get(`${E}/api/website/currencies`),D.get(`${E}/api/countries`),D.get(`${E}/api/products`),D.get(`${E}/api/brands`),D.get(`${E}/api/units`),D.get(`${E}/api/attributes`),D.get(`${E}/api/main-ingredients`)]);T.value=d.data.data,console.log("Categories:",T.value),K.value=o.data.data,z.value=p.data.data,H.value=k.data.data,O.value=f.data.data.map(y=>({...y,logo_path:y.images&&y.images.length>0?y.images[0].path:null})),j.value=N.data.data,J.value=P.data.data||[],oe.value=Array.isArray(n.data)?n.data:((i=n.data)==null?void 0:i.data)||[]}catch(d){console.error("Error fetching options",d)}finally{F.value=!1}},Ye=async()=>{var e,a,i,d,o,p,k,f,N;F.value=!0;try{const n=(await D.get(`/api/products/${ue}`)).data.data;console.log(n),l.value.name_ar=n.name_ar,l.value.name_en=n.name_en,l.value.description_ar=n.description_ar,l.value.description_en=n.description_en,l.value.price=n.price,l.value.category_ar=(e=n.category)==null?void 0:e.name_ar,l.value.category_en=(a=n.category)==null?void 0:a.name_en,l.value.brand_id=Number(n.brand&&n.brand.id!=null?n.brand.id:n.brand_id!=null?n.brand_id:n.parent&&(n.parent.brand_id!=null||n.parent.brand&&n.parent.brand.id!=null)?n.parent.brand_id??n.parent.brand.id:null)||null,l.value.category_id=Number(n.category&&n.category.id!=null?n.category.id:n.category_id!=null?n.category_id:n.parent&&(n.parent.category_id!=null||n.parent.category&&n.parent.category.id!=null)?n.parent.category_id??n.parent.category.id:null)||null,l.value.currency_id=Number(n.currency&&n.currency.id!=null?n.currency.id:n.currency_id!=null?n.currency_id:n.parent&&(n.parent.currency_id!=null||n.parent.currency&&n.parent.currency.id!=null)?n.parent.currency_id??n.parent.currency.id:null)||null,l.value.country_id=Number(n.country&&n.country.id!=null?n.country.id:n.country_id!=null?n.country_id:n.parent&&(n.parent.country_id!=null||n.parent.country&&n.parent.country.id!=null)?n.parent.country_id??n.parent.country.id:null)||null,l.value.parent_id=Number(n.parent_id!=null?n.parent_id:n.parent&&n.parent.id!=null?n.parent.id:null)||null,ke.value=n.currency_id,De.value=n.country_id,Ve.value=n.brand_id,Ae.value=n.parent_id,l.value.quantity=n.quantity??1,l.value.amounts=((i=n.amounts)==null?void 0:i.map(c=>{const I=c.unit&&c.unit.id!=null?Number(c.unit.id):null,R=c.unit_id!=null?Number(c.unit_id):null;return{unit_id:I??R,weight:c.weight,price:c.price,id:c.id}}))||[],l.value.amounts.length>0&&(l.value.price=((d=l.value.amounts[0])==null?void 0:d.price)??l.value.price),l.value.type=n.type??"product",l.value.offer=n.discount?"1":"0",l.value.offer_price=n.discount?n.discounted_price:"",l.value.category_id==null&&(n.category_id!=null||n.category&&n.category.id!=null)&&(l.value.category_id=Number(n.category_id!=null?n.category_id:n.category.id)),Pe.value=n.category_id,l.value.images=n.images.map(c=>({id:c.id,path:c.path,url:q(c.path)})),l.value.discount=n.discount?{id:n.discount.id,value:parseFloat(n.discount.discount_value),startDate:(o=n.discount.start_date)==null?void 0:o.split("T")[0],endDate:(p=n.discount.end_date)==null?void 0:p.split("T")[0],is_active:n.discount.is_active}:{id:null,value:null,startDate:null,endDate:null,is_active:!1},Y.value=!!n.discount,l.value.attributes=((k=n.attributes)==null?void 0:k.map(c=>({name_en:c.name_en,name_ar:c.name_ar,value:c.value,id:c.id})))||[],l.value.main_ingredients=((f=n.main_ingredients)==null?void 0:f.map(c=>({name_en:c.name_en,name_ar:c.name_ar,id:c.id,images:c.images.map(I=>({id:I.id,path:I.path,url:q(I.path)}))||[]})))||[],l.value.fragrance_notes=((N=n.fragrance_notes)==null?void 0:N.map(c=>({name_en:c.name_en,name_ar:c.name_ar,description_en:c.description_en,description_ar:c.description_ar,id:c.id})))||[];let y=[];if(Array.isArray(n.attributes)&&(y=y.concat(n.attributes)),n.parent&&Array.isArray(n.parent.attributes_with_values)){const c=new Set(y.map(R=>R.id)),I=n.parent.attributes_with_values.filter(R=>!c.has(R.id));y=y.concat(I)}if(Array.isArray(y)&&y.length>0){l.value.attribute_ids=y.map(I=>I.id);const c={};y.forEach(I=>{c[I.id]=I.value}),l.value.attribute_values=c}else l.value.attribute_ids=[],l.value.attribute_values={};l.value.selected_main_ingredient_ids=(n.main_ingredients||[]).filter(c=>c&&c.id).map(c=>c.id),Z.value=n.converted_price??null,Q.value=n.discounted_price??null;const[L,M,ne]=await Promise.all([D.get("/api/categories"),D.get("/api/website/currencies"),D.get("/api/brands")]);T.value=L.data.data,K.value=M.data.data,O.value=ne.data.data.map(c=>({...c,logo_path:c.images&&c.images.length>0?c.images[0].path:null}))}catch(P){console.error("Error loading product data",P)}finally{F.value=!1}},Le=(e,a)=>l.value.images=a,ze=(e,a)=>l.value.images=a,qe=()=>{re.value.validate(async e=>{var i;if(!e)return;const a=new FormData;Array.isArray(l.value.amounts)&&l.value.amounts.length>0;for(const d in l.value){if(d==="images"||d==="amounts"||d==="attributes"||d==="main_ingredients"||d==="fragrance_notes"||d==="discount"||d==="attribute_ids"||d==="attribute_values"||d==="selected_main_ingredient_ids")continue;const o=l.value[d];if(!(o==null||o===""))if(d==="price"){const p=typeof o=="number"?o:Number(o);if(Number.isNaN(p))continue;a.append("price",p)}else a.append(d,o)}Array.isArray(l.value.attribute_ids)&&l.value.attribute_ids.forEach((d,o)=>{var k;a.append(`attribute_ids[${o}]`,d);const p=(k=l.value.attribute_values)==null?void 0:k[d];if(p!=null&&p!==""){let f=p;typeof f=="string"&&f.includes("%")&&(f=parseFloat(f.replace("%",""))),a.append(`attribute_values[${d}]`,f)}}),Array.isArray(l.value.selected_main_ingredient_ids)&&l.value.selected_main_ingredient_ids.length>0&&l.value.selected_main_ingredient_ids.forEach((d,o)=>{a.append(`selected_main_ingredient_ids[${o}]`,d)}),l.value.amounts.forEach((d,o)=>{a.append(`amounts[${o}][unit_id]`,d.unit_id),a.append(`amounts[${o}][weight]`,d.weight),a.append(`amounts[${o}][price]`,d.price),d.id&&a.append(`amounts[${o}][id]`,d.id)}),l.value.images.forEach(d=>{d.raw?a.append("images[]",d.raw):d.id&&a.append("existing_images[]",d.id)}),Y.value&&l.value.discount&&l.value.discount.value?(a.append("discount[value]",l.value.discount.value),a.append("discount[startDate]",l.value.discount.startDate),a.append("discount[endDate]",l.value.discount.endDate),l.value.discount.id&&a.append("discount[id]",l.value.discount.id),a.append("delete_discount","0")):de.value&&(a.append("delete_discount","1"),a.append("discount[deleted]","1"),x.value&&a.append("discount[id]",x.value)),X.value.length>0&&X.value.forEach((d,o)=>{a.append(`remove_amount_ids[${o}]`,d)}),ie.value&&l.value.attributes.forEach((d,o)=>{a.append(`attributes[${o}][name_en]`,d.name_en),a.append(`attributes[${o}][name_ar]`,d.name_ar),a.append(`attributes[${o}][value]`,d.value),d.id&&a.append(`attributes[${o}][id]`,d.id)}),l.value.main_ingredients.forEach((d,o)=>{a.append(`main_ingredients[${o}][name_en]`,d.name_en),a.append(`main_ingredients[${o}][name_ar]`,d.name_ar),d.id&&a.append(`main_ingredients[${o}][id]`,d.id),d.images.forEach(p=>{p.raw?a.append(`main_ingredients[${o}][images][]`,p.raw):p.id&&a.append(`main_ingredients[${o}][existing_images][]`,p.id)})}),l.value.fragrance_notes.forEach((d,o)=>{a.append(`fragrance_notes[${o}][name_en]`,d.name_en),a.append(`fragrance_notes[${o}][name_ar]`,d.name_ar),a.append(`fragrance_notes[${o}][description_en]`,d.description_en),a.append(`fragrance_notes[${o}][description_ar]`,d.description_ar),d.id&&a.append(`fragrance_notes[${o}][id]`,d.id)}),F.value=!0;try{const d=(i=JSON.parse(localStorage.getItem("tokenData")))==null?void 0:i.token;D.defaults.headers.common.Authorization=`Bearer ${d}`,a.append("_method","PUT"),await D.post(`${E}/api/products/${ue}`,a,{headers:{"Content-Type":"multipart/form-data"}}),await G.alert(localStorage.getItem("lang")==="ar"?"تم تحديث المنتج بنجاح":"Product updated successfully",localStorage.getItem("lang")==="ar"?"نجاح":"Success",{type:"success",confirmButtonText:localStorage.getItem("lang")==="ar"?"حسناً":"OK"}),$e.push("/products")}catch(d){console.error("Error submitting form",d),B.error("Error updating product")}finally{F.value=!1}})},Ge=()=>{G.confirm(localStorage.getItem("lang")==="ar"?"سيتم حذف الخصم":"The discount will be deleted","Warning",{confirmButtonText:localStorage.getItem("lang")==="ar"?"موافق":"OK",cancelButtonText:localStorage.getItem("lang")==="ar"?"إلغاء":"Cancel",type:"warning"}).then(()=>{var e;de.value=!0,x.value=((e=l.value.discount)==null?void 0:e.id)||null,Y.value=!1,l.value.discount.value=null,l.value.discount.startDate=null,l.value.discount.endDate=null,l.value.discount.is_active=!1,B.success(localStorage.getItem("lang")==="ar"?"تم حذف الخصم بنجاح":"Discount deleted successfully")}).catch(()=>{B.info(localStorage.getItem("lang")==="ar"?"تم إلغاء الحذف":"Delete cancelled")})},We=()=>{l.value.attributes.push({name_en:"",name_ar:"",value:""})},Ke=e=>{if(l.value.attributes.length<=1){B.warning(localStorage.getItem("lang")==="ar"?"يجب عليك حفظ خاصية واحدة على الاقل":"At least one attribute is required.");return}G.confirm(localStorage.getItem("lang")==="ar"?"سيتم حذف الخاصية":"The attribute will be deleted","Warning",{confirmButtonText:localStorage.getItem("lang")==="ar"?"موافق":"OK",cancelButtonText:localStorage.getItem("lang")==="ar"?"إلغاء":"Cancel",type:"warning"}).then(()=>{l.value.attributes.splice(e,1),B.success(localStorage.getItem("lang")==="ar"?"تم حذف الخاصية بنجاح":"Attribute deleted successfully")}).catch(()=>{B.info(localStorage.getItem("lang")==="ar"?"تم إلغاء الحذف":"Delete cancelled")})},He=()=>{l.value.main_ingredients.push({name_en:"",name_ar:""})},je=()=>{l.value.fragrance_notes.push({name_en:"",name_ar:"",description_en:"",description_ar:""})},Je=e=>{G.confirm(localStorage.getItem("lang")==="ar"?"سيتم حذف الملاحظة العطرية":"The fragrance note will be deleted","Warning",{confirmButtonText:localStorage.getItem("lang")==="ar"?"موافق":"OK",cancelButtonText:localStorage.getItem("lang")==="ar"?"إلغاء":"Cancel",type:"warning"}).then(()=>{l.value.fragrance_notes.splice(e,1),B.success(localStorage.getItem("lang")==="ar"?"تم حذف الملاحظة العطرية بنجاح":"Fragrance note deleted successfully")}).catch(()=>{B.info(localStorage.getItem("lang")==="ar"?"تم إلغاء الحذف":"Delete cancelled")})};return ye(()=>l.value.brand_id,async e=>{if(e)try{const a=await D.get(`${E}/api/brands/${e}/categories`);T.value=a.data.data,console.log("Categories for brand:",T.value)}catch(a){console.error("Failed to fetch categories for brand",a)}else{const a=await D.get(`${E}/api/categories`);T.value=a.data.data,l.value.category_id=null}}),xe(async()=>{await Re(),await Ye()}),ye(()=>l.value.amounts,e=>{var a;Array.isArray(e)&&e.length>0&&(l.value.price=((a=e[0])==null?void 0:a.price)??null)},{deep:!0}),(e,a)=>{const i=w("el-option"),d=w("el-select"),o=w("el-form-item"),p=w("el-input"),k=w("el-divider"),f=w("el-col"),N=w("el-row"),P=w("el-button"),n=w("el-switch"),y=w("el-input-number"),L=w("el-date-picker"),M=w("el-tag"),ne=w("el-upload"),c=w("el-form"),I=w("el-card"),R=ea("loading");return s(),g("div",na,[aa((s(),$(I,{class:"product-card"},{default:u(()=>[S("h2",null,m(e.$t("Products.EditProduct")),1),r(c,{model:l.value,ref_key:"formRef",ref:re,rules:Ie,"label-width":"120px",enctype:"multipart/form-data"},{default:u(()=>[r(o,{label:e.$t("Products.SelectExistingMainIngredients")},{default:u(()=>[r(d,{modelValue:l.value.selected_main_ingredient_ids,"onUpdate:modelValue":a[0]||(a[0]=t=>l.value.selected_main_ingredient_ids=t),placeholder:e.$t("Products.SelectExistingMainIngredients"),filterable:"",clearable:"",multiple:""},{default:u(()=>[(s(!0),g(A,null,U(oe.value,t=>(s(),$(i,{key:t.id,label:ge(t),value:t.id},{default:u(()=>[V(m(ge(t)),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),r(o,{label:e.$t("Products.Attributes"),prop:"attribute_ids"},{default:u(()=>[r(d,{modelValue:l.value.attribute_ids,"onUpdate:modelValue":a[1]||(a[1]=t=>l.value.attribute_ids=t),placeholder:e.$t("Products.SelectAttributes"),filterable:"",clearable:"",multiple:"","popper-class":"attribute-dropdown"},{default:u(()=>[(s(!0),g(A,null,U(J.value,t=>(s(),$(i,{key:t.id,label:le(t),value:t.id},{default:u(()=>[S("div",ra,[t.icon?(s(),g("div",{key:0,class:"attribute-icon",innerHTML:t.icon},null,8,ua)):b("",!0),S("span",null,m(le(t)),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),r(o,{label:e.$t("Products.AttributeValues")},{default:u(()=>[(s(!0),g(A,null,U(l.value.attribute_ids,t=>{var v;return s(),g("div",{key:t,class:"attribute-value-item"},[S("div",oa,[(v=te(t))!=null&&v.icon?(s(),g("div",{key:0,class:"attribute-icon",innerHTML:Oe(te(t).icon,l.value.attribute_values[t])},null,8,da)):b("",!0),S("span",null,m(le(te(t))||t),1)]),S("div",ia,[r(p,{modelValue:l.value.attribute_values[t],"onUpdate:modelValue":_=>l.value.attribute_values[t]=_,placeholder:e.$t("Products.AttributeValues"),onInput:_=>Fe(t,_)},null,8,["modelValue","onUpdate:modelValue","placeholder","onInput"]),fe(l.value.attribute_values[t])?(s(),g("div",sa,[a[21]||(a[21]=S("label",{class:"gradient-label"},"Gradient %:",-1)),S("input",{type:"range",value:be(l.value.attribute_values[t]),min:"0",max:"100",onInput:_=>Te(t,_.target.value),class:"gradient-range"},null,40,ca),S("span",pa,m(be(l.value.attribute_values[t]))+"%",1)])):b("",!0)])])}),128)),(l.value.attribute_ids||[]).length===0?(s(),g("div",ma,m(e.$t("Products.PleaseSelectAttributesFirst")),1)):b("",!0)]),_:1},8,["label"]),r(o,{label:e.$t("Products.NameEn"),prop:"name_en"},{default:u(()=>[r(p,{modelValue:l.value.name_en,"onUpdate:modelValue":a[2]||(a[2]=t=>l.value.name_en=t),placeholder:e.$t("Products.NameEn")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(o,{label:e.$t("Products.NameAr"),prop:"name_ar"},{default:u(()=>[r(p,{modelValue:l.value.name_ar,"onUpdate:modelValue":a[3]||(a[3]=t=>l.value.name_ar=t),placeholder:e.$t("Products.NameAr")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l.value.amounts?(s(!0),g(A,{key:0},U(l.value.amounts,(t,v)=>(s(),g("div",{key:v,class:"amount-entry mb-3"},[r(k,{"content-position":"left"},{default:u(()=>[V(m(e.$t("Products.Amount-Info")),1)]),_:1}),r(N,{gutter:20},{default:u(()=>[r(f,{span:12},{default:u(()=>[r(o,{label:e.$t("Products.Unit"),prop:`amounts.${v}.unit_id`},{default:u(()=>[r(d,{modelValue:t.unit_id,"onUpdate:modelValue":_=>t.unit_id=_,placeholder:e.$t("Products.select-unit"),filterable:"",clearable:""},{default:u(()=>[(s(!0),g(A,null,U(j.value,_=>(s(),$(i,{key:_.id,label:ve(_),value:Number(_.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),r(f,{span:12},{default:u(()=>[r(o,{label:e.$t("Products.Weight"),prop:`amounts.${v}.weight`},{default:u(()=>[r(p,{modelValue:t.weight,"onUpdate:modelValue":_=>t.weight=_,type:"number",min:1,placeholder:e.$t("Products.Weight")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),r(f,{span:12},{default:u(()=>[r(o,{label:e.$t("Products.amount-Price"),prop:`amounts.${v}.price`},{default:u(()=>[r(p,{modelValue:t.price,"onUpdate:modelValue":_=>t.price=_,type:"number",min:1,placeholder:e.$t("Products.amount-Price")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024)]),_:2},1024),r(N,{gutter:20,class:"button-row"},{default:u(()=>[r(f,{span:24},{default:u(()=>[l.value.amounts.length>0?(s(),$(P,{key:0,type:"danger",onClick:_=>we(v),icon:"el-icon-delete"},{default:u(()=>[V(m(e.$t("Products.RemoveAmount")),1)]),_:1},8,["onClick"])):b("",!0),l.value.amounts.length>0?(s(),$(P,{key:1,type:"success",plain:"",onClick:Ne,icon:"el-icon-plus"},{default:u(()=>[V(m(e.$t("Products.AddAmount")),1)]),_:1})):b("",!0)]),_:2},1024)]),_:2},1024)]))),128)):b("",!0),ie.value?(s(),g(A,{key:1},[r(k,{"content-position":"left"},{default:u(()=>[V(m(e.$t("Products.Attributes")),1)]),_:1}),(s(!0),g(A,null,U(l.value.attributes,(t,v)=>(s(),g("div",{key:v,class:"attribute-entry"},[S("div",_a,[S("span",ga,m(e.$t("Products.Attributes"))+" #"+m(v+1),1),r(P,{class:"attribute-remove",type:"danger",text:"",circle:"",icon:la(ta),onClick:_=>Ke(v)},null,8,["icon","onClick"])]),r(N,{gutter:16,class:"attribute-fields"},{default:u(()=>[r(f,{span:8},{default:u(()=>[r(o,{label:e.$t("Products.NameEn"),prop:`attributes.${v}.name_en`},{default:u(()=>[r(p,{modelValue:t.name_en,"onUpdate:modelValue":_=>t.name_en=_,placeholder:e.$t("Products.NameEn")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),r(f,{span:8},{default:u(()=>[r(o,{label:e.$t("Products.NameAr"),prop:`attributes.${v}.name_ar`},{default:u(()=>[r(p,{modelValue:t.name_ar,"onUpdate:modelValue":_=>t.name_ar=_,placeholder:e.$t("Products.NameAr")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),r(f,{span:8},{default:u(()=>[r(o,{label:e.$t("Products.Value"),prop:`attributes.${v}.value`},{default:u(()=>[r(p,{modelValue:t.value,"onUpdate:modelValue":_=>t.value=_,placeholder:e.$t("Products.Value")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024)]),_:2},1024)]))),128)),r(P,{type:"primary",plain:"",onClick:We},{default:u(()=>[V(m(e.$t("Products.AddAttribute")),1)]),_:1})],64)):b("",!0),r(P,{type:"primary",onClick:He},{default:u(()=>[V(m(e.$t("Products.AddMainIngredient")),1)]),_:1}),r(k,{"content-position":"left"},{default:u(()=>[V(m(e.$t("Products.FragranceNotes")),1)]),_:1}),(s(!0),g(A,null,U(l.value.fragrance_notes,(t,v)=>(s(),g("div",{key:v,class:"fragrance-note-entry mb-3"},[r(N,{gutter:20},{default:u(()=>[r(f,{span:12},{default:u(()=>[r(o,{label:`Note Name EN ${v+1}`,prop:`fragrance_notes.${v}.name_en`},{default:u(()=>[r(p,{modelValue:t.name_en,"onUpdate:modelValue":_=>t.name_en=_,placeholder:e.$t("Products.NameEn")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),r(f,{span:12},{default:u(()=>[r(o,{label:`Note Name AR ${v+1}`,prop:`fragrance_notes.${v}.name_ar`},{default:u(()=>[r(p,{modelValue:t.name_ar,"onUpdate:modelValue":_=>t.name_ar=_,placeholder:e.$t("Products.NameAr")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024)]),_:2},1024),r(N,{gutter:20},{default:u(()=>[r(f,{span:12},{default:u(()=>[r(o,{label:`Note Description EN ${v+1}`,prop:`fragrance_notes.${v}.description_en`},{default:u(()=>[r(p,{type:"textarea",modelValue:t.description_en,"onUpdate:modelValue":_=>t.description_en=_,placeholder:e.$t("Products.DescriptionEn")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024),r(f,{span:12},{default:u(()=>[r(o,{label:`Note Description AR ${v+1}`,prop:`fragrance_notes.${v}.description_ar`},{default:u(()=>[r(p,{type:"textarea",modelValue:t.description_ar,"onUpdate:modelValue":_=>t.description_ar=_,placeholder:e.$t("Products.DescriptionAr")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"])]),_:2},1024)]),_:2},1024),r(N,{gutter:20,class:"button-row"},{default:u(()=>[r(f,{span:24},{default:u(()=>[r(P,{type:"danger",onClick:_=>Je(v)},{default:u(()=>[V(m(e.$t("Products.RemoveFragranceNote")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),r(P,{type:"primary",onClick:je},{default:u(()=>[V(m(e.$t("Products.AddFragranceNote")),1)]),_:1}),Y.value?(s(),$(o,{key:2,label:e.$t("Products.discount"),prop:"discount.value"},{default:u(()=>[r(n,{modelValue:l.value.discount.is_active,"onUpdate:modelValue":a[4]||(a[4]=t=>l.value.discount.is_active=t),"active-text":"Yes","inactive-text":"No"},null,8,["modelValue"])]),_:1},8,["label"])):b("",!0),Y.value?(s(),g("div",va,[r(k,{"content-position":"left"},{default:u(()=>[V(m(e.$t("Products.discountInfo")),1)]),_:1}),Y.value?(s(),g(A,{key:0},[r(o,{label:e.$t("Products.Discount-Value"),prop:"discount.value"},{default:u(()=>[r(y,{modelValue:l.value.discount.value,"onUpdate:modelValue":a[5]||(a[5]=t=>l.value.discount.value=t),type:"number",min:1,max:99,placeholder:e.$t("Products.Discount-Value")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(o,{label:e.$t("Products.Start-Date"),prop:"discount.startDate"},{default:u(()=>[r(L,{modelValue:l.value.discount.startDate,"onUpdate:modelValue":a[6]||(a[6]=t=>l.value.discount.startDate=t),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",placeholder:e.$t("Products.Start-Date"),style:{width:"100%"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(o,{label:e.$t("Products.End-Date"),prop:"discount.endDate"},{default:u(()=>[r(L,{modelValue:l.value.discount.endDate,"onUpdate:modelValue":a[7]||(a[7]=t=>l.value.discount.endDate=t),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",placeholder:e.$t("Products.End-Date"),style:{width:"100%"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l.value.discount&&(l.value.discount.value||l.value.discount.id)?(s(),$(P,{key:0,type:"danger",icon:"el-icon-delete",onClick:Ge},{default:u(()=>[V(m(e.$t("Products.removeDiscount")),1)]),_:1})):b("",!0),r(k)],64)):b("",!0)])):b("",!0),l.value.amounts.length===0?(s(),$(o,{key:4,label:e.$t("Products.Needs-Amount")},{default:u(()=>[r(n,{modelValue:l.value.amount_required,"onUpdate:modelValue":a[8]||(a[8]=t=>l.value.amount_required=t),"active-text":"Yes","inactive-text":"No",dir:"ltr",class:"mx-3"},null,8,["modelValue"])]),_:1},8,["label"])):b("",!0),l.value.amount_required?(s(),g(A,{key:5},[r(k,{"content-position":"left"},{default:u(()=>[V(m(e.$t("Products.Amount-Info")),1)]),_:1}),r(o,{label:e.$t("Products.Unit"),prop:"unit_id"},{default:u(()=>[r(d,{modelValue:l.value.unit_id,"onUpdate:modelValue":a[9]||(a[9]=t=>l.value.unit_id=t),placeholder:e.$t("Products.select-unit"),filterable:"",clearable:""},{default:u(()=>[(s(!0),g(A,null,U(j.value,t=>(s(),$(i,{key:t.id,label:ve(t),value:Number(t.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),r(o,{label:e.$t("Products.Weight"),prop:"weight"},{default:u(()=>[r(y,{modelValue:l.value.weight,"onUpdate:modelValue":a[10]||(a[10]=t=>l.value.weight=t),type:"number",min:1,placeholder:e.$t("Products.select-weight")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(o,{label:e.$t("Products.amount-Price"),prop:"amount_price"},{default:u(()=>[r(y,{modelValue:l.value.amount_price,"onUpdate:modelValue":a[11]||(a[11]=t=>l.value.amount_price=t),type:"number",min:1,placeholder:e.$t("Products.select-price")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])],64)):b("",!0),!l.value.amounts||l.value.amounts.length===0?(s(),$(o,{key:6,label:e.$t("Products.Price"),prop:"price"},{default:u(()=>[r(p,{modelValue:l.value.price,"onUpdate:modelValue":a[12]||(a[12]=t=>l.value.price=t),type:"number",min:1,placeholder:e.$t("Products.Price")},null,8,["modelValue","placeholder"]),Z.value!==null?(s(),$(M,{key:0,size:"small",effect:"plain",class:"current-value"},{default:u(()=>[V("Converted: "+m(Z.value),1)]),_:1})):b("",!0),Q.value!==null?(s(),$(M,{key:1,size:"small",type:"success",effect:"plain",class:"current-value"},{default:u(()=>[V("Discounted: "+m(Q.value),1)]),_:1})):b("",!0)]),_:1},8,["label"])):b("",!0),r(o,{label:e.$t("Products.Availability"),prop:"is_available"},{default:u(()=>[r(n,{modelValue:l.value.is_available,"onUpdate:modelValue":a[13]||(a[13]=t=>l.value.is_available=t),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1},8,["label"]),r(o,{label:e.$t("Products.DescriptionEn"),prop:"description_en"},{default:u(()=>[r(p,{type:"textarea",modelValue:l.value.description_en,"onUpdate:modelValue":a[14]||(a[14]=t=>l.value.description_en=t),placeholder:e.$t("Products.DescriptionEn")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(o,{label:e.$t("Products.DescriptionAr"),prop:"description_ar"},{default:u(()=>[r(p,{type:"textarea",modelValue:l.value.description_ar,"onUpdate:modelValue":a[15]||(a[15]=t=>l.value.description_ar=t),placeholder:e.$t("Products.DescriptionAr")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(o,{label:e.$t("Products.brand"),prop:"brand_id"},{default:u(()=>[r(d,{modelValue:l.value.brand_id,"onUpdate:modelValue":a[16]||(a[16]=t=>l.value.brand_id=t),filterable:"",clearable:"",placeholder:e.$t("Products.SelectBrand")},{default:u(()=>[(s(!0),g(A,null,U(O.value,t=>(s(),$(i,{key:t.id,label:t.name_en,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Ue.value!==se.value?(s(),$(M,{key:0,size:"small",effect:"plain",class:"current-value"},{default:u(()=>[V("("+m(e.$t("Products.Original"))+": "+m(se.value)+")",1)]),_:1})):b("",!0)]),_:1},8,["label"]),W.value||ae.value?(s(),g("div",fa,[W.value?(s(),g("img",{key:0,src:W.value,alt:"Brand Image",style:{"max-width":"120px","max-height":"120px","margin-right":"10px","border-radius":"8px"}},null,8,ba)):b("",!0),W.value!==ae.value?(s(),$(M,{key:1,size:"small",effect:"plain",class:"current-value"},{default:u(()=>[V("("+m(e.$t("Products.Original"))+" brand: ",1),S("img",{src:ae.value,alt:"Original Brand Image",style:{"max-width":"40px","max-height":"40px","border-radius":"4px"}},null,8,ya),a[22]||(a[22]=V(")",-1))]),_:1})):b("",!0)])):b("",!0),r(o,{label:e.$t("Products.Category"),prop:"category_id"},{default:u(()=>[r(d,{modelValue:l.value.category_id,"onUpdate:modelValue":a[17]||(a[17]=t=>l.value.category_id=t),filterable:"",clearable:"",placeholder:e.$t("Products.SelectCategory")},{default:u(()=>[(s(!0),g(A,null,U(T.value,t=>(s(),$(i,{key:t.id,label:t.name_en||t.name_ar,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Ce.value!==ce.value?(s(),$(M,{key:0,size:"small",effect:"plain",class:"current-value"},{default:u(()=>[V("("+m(e.$t("Products.Original"))+": "+m(ce.value)+")",1)]),_:1})):b("",!0)]),_:1},8,["label"]),r(o,{label:e.$t("Products.Currency"),prop:"currency_id"},{default:u(()=>[r(d,{modelValue:l.value.currency_id,"onUpdate:modelValue":a[18]||(a[18]=t=>l.value.currency_id=t),filterable:"",clearable:"",placeholder:e.$t("Products.SelectCurrency")},{default:u(()=>[(s(!0),g(A,null,U(ee.value,t=>(s(),$(i,{key:t.id,label:Se(t),value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Ee.value!==pe.value?(s(),$(M,{key:0,size:"small",effect:"plain",class:"current-value"},{default:u(()=>[V("("+m(e.$t("Products.Original"))+": "+m(pe.value)+")",1)]),_:1})):b("",!0)]),_:1},8,["label"]),r(o,{label:e.$t("Products.Country"),prop:"country_id"},{default:u(()=>[r(d,{modelValue:l.value.country_id,"onUpdate:modelValue":a[19]||(a[19]=t=>l.value.country_id=t),filterable:"",clearable:"",placeholder:e.$t("Products.SelectCountry")},{default:u(()=>[(s(!0),g(A,null,U(z.value,t=>(s(),$(i,{key:t.id,label:t.name_en||t.name_ar,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Me.value!==me.value?(s(),$(M,{key:0,size:"small",effect:"plain",class:"current-value"},{default:u(()=>[V("("+m(e.$t("Products.Original"))+": "+m(me.value)+")",1)]),_:1})):b("",!0)]),_:1},8,["label"]),r(o,{label:e.$t("Products.ParentProduct"),prop:"parent_id"},{default:u(()=>[r(d,{modelValue:l.value.parent_id,"onUpdate:modelValue":a[20]||(a[20]=t=>l.value.parent_id=t),clearable:"",placeholder:e.$t("Products.SelectParentProduct")},{default:u(()=>[r(i,{label:e.$t("Products.None"),value:null},null,8,["label"]),(s(!0),g(A,null,U(H.value,t=>(s(),$(i,{key:t.id,label:t.name_en,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),Be.value!==_e.value?(s(),$(M,{key:0,size:"small",effect:"plain",class:"current-value"},{default:u(()=>[V("("+m(e.$t("Products.Original"))+": "+m(_e.value)+")",1)]),_:1})):b("",!0)]),_:1},8,["label"]),l.value.images&&l.value.images.length?(s(),g("div",$a,[(s(!0),g(A,null,U(l.value.images,(t,v)=>(s(),g("img",{key:v,src:t.url?t.url:q(t.path),alt:"Product Image",style:{"max-width":"120px","max-height":"120px","margin-right":"10px","border-radius":"8px"}},null,8,ha))),128))])):b("",!0),r(o,{label:e.$t("Products.Images"),prop:"images"},{default:u(()=>[r(ne,{class:"upload-demo",drag:"",action:"","auto-upload":!1,limit:5,"file-list":l.value.images,"list-type":"picture","on-change":Le,"on-remove":ze},{default:u(()=>[a[23]||(a[23]=S("i",{class:"el-icon-upload"},null,-1)),S("div",Va,m(e.$t("Products.DropFiles")),1)]),_:1},8,["file-list"])]),_:1},8,["label"]),r(o,null,{default:u(()=>[r(P,{type:"primary",onClick:qe},{default:u(()=>[V(m(e.$t("Products.UpdateButton")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})),[[R,F.value]])])}}},Aa=Ze(Pa,[["__scopeId","data-v-9a3871bd"]]);export{Aa as default};
