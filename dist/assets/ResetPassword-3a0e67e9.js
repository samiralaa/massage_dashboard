import{_ as f,H as w,b as _,o as n,c as d,a as t,t as i,g,w as p,q as h,f as c,j as m}from"./index-50b21e1d.js";const k={components:{Header:w},data(){return{email:"",password:"",password_confirmation:"",loading:!1,error:null,success:null,showPassword:!1,showConfirmPassword:!1}},mounted(){const e=localStorage.getItem("user");if(e)try{const s=JSON.parse(e);this.email=s.email||""}catch{this.email=localStorage.getItem("user_email")||""}else this.email=localStorage.getItem("user_email")||""},created(){const e=new URLSearchParams(window.location.search),s=e.get("email"),r=e.get("token");if(!s||!r){this.$router.push("/register");return}this.token=r,this.email=s},methods:{async resetPassword(){var e,s;if(this.error=null,this.success=null,this.password!==this.password_confirmation){this.error=this.$t("profile.passwordsDoNotMatch");return}if(this.password.length<8){this.error=this.$t("profile.passwordTooShort");return}if(!this.email){this.error="Email is required but not available";return}this.loading=!0;try{const r=await _.post("api/reset-password",{email:this.email,password:this.password,password_confirmation:this.password_confirmation});if(r.data.status&&r.data.data){const u=r.data.data;localStorage.setItem("auth_token",u.token),localStorage.setItem("auth_user",JSON.stringify(u.user)),this.$store&&this.$store.commit&&(this.$store.commit("auth/SET_AUTH",u),await this.$store.dispatch("cart/loadCart")),this.success=r.data.message||this.$t("profile.passwordResetSuccess"),setTimeout(()=>{this.$router.push("/")},1500)}else this.error=r.data.message||this.$t("profile.passwordResetFailed")}catch(r){this.error=((s=(e=r.response)==null?void 0:e.data)==null?void 0:s.message)||this.$t("profile.passwordResetFailed")}finally{this.loading=!1}},goBackToProfile(){this.$router.push({name:"Profile"})}},computed:{isAuthenticated(){return!!localStorage.getItem("auth_user")}}},b={class:"reset-password-outer"},y={class:"reset-password-card"},P={class:"reset-password-header"},v={class:"form-group"},S=["type"],T={class:"form-group"},B=["type"],C={key:0,class:"alert alert-danger"},I={key:1,class:"alert alert-success"},D={class:"d-flex justify-content-end gap-2 mt-2"},N=["disabled"],R={key:0,class:"spinner-border spinner-border-sm"},x={key:0,class:"back-to-profile"};function M(e,s,r,u,o,l){return n(),d("div",b,[t("div",y,[t("div",P,[t("h2",null,i(e.$t("profile.resetPassword")),1),t("p",null,i(e.$t("profile.resetPasswordDesc")),1)]),t("form",{onSubmit:s[3]||(s[3]=g((...a)=>l.resetPassword&&l.resetPassword(...a),["prevent"])),class:"d-flex flex-column gap-3"},[t("div",v,[t("label",null,i(e.$t("profile.newPassword")),1),p(t("input",{type:o.showPassword?"text":"password","onUpdate:modelValue":s[0]||(s[0]=a=>o.password=a),class:"form-control",required:""},null,8,S),[[h,o.password]])]),t("div",T,[t("label",null,i(e.$t("profile.confirmPassword")),1),p(t("input",{type:o.showConfirmPassword?"text":"password","onUpdate:modelValue":s[1]||(s[1]=a=>o.password_confirmation=a),class:"form-control",required:""},null,8,B),[[h,o.password_confirmation]])]),o.error?(n(),d("div",C,i(o.error),1)):c("",!0),o.success?(n(),d("div",I,i(o.success),1)):c("",!0),t("div",D,[t("button",{type:"submit",class:"btn btn-primary",disabled:o.loading},[o.loading?(n(),d("span",R)):c("",!0),m(" "+i(e.$t("profile.submit")),1)],8,N),l.isAuthenticated?(n(),d("button",{key:0,type:"button",class:"btn btn-secondary",onClick:s[2]||(s[2]=(...a)=>l.goBackToProfile&&l.goBackToProfile(...a))},i(e.$t("profile.backToProfile")),1)):c("",!0)])],32),l.isAuthenticated?(n(),d("div",x,[t("button",{onClick:s[4]||(s[4]=(...a)=>l.goBackToProfile&&l.goBackToProfile(...a)),class:"back-btn"},[s[5]||(s[5]=t("svg",{width:"16",height:"16",fill:"none",viewBox:"0 0 24 24"},[t("path",{d:"M19 12H5M12 19l-7-7 7-7",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),m(" "+i(e.$t("profile.backToProfile")),1)])])):c("",!0)])])}const j=f(k,[["render",M],["__scopeId","data-v-5fd844a4"]]);export{j as default};
