import{_ as h,h as m,o as l,c as d,a as s,t as i,i as c,l as _,T as v,H as g,U as u}from"./index-d33f2148.js";const y={name:"CreateCategory",data(){return{form:{name:"",name_ar:"",description:"",description_ar:"",brand_id:"",image:null},imagePreview:null,brands:[],successMessage:"",errorMessage:"",loading:!1}},created(){this.fetchBrands()},methods:{async fetchBrands(){try{const r=JSON.parse(localStorage.getItem("tokenData"));r!=null&&r.token&&(m.defaults.headers.common.Authorization=`Bearer ${r.token}`);const e=await m.get("https://massagebackend.webenia.org/api/brands");if(e.data.status){const n=e.data.data;this.brands=Array.isArray(n)?n:[n]}else throw new Error(e.data.message||"Failed to fetch brands")}catch(r){console.error("Error fetching brands:",r),alert("Failed to load brands")}},onFileChange(r){const e=r.target.files[0];e?(this.form.image=e,this.imagePreview=URL.createObjectURL(e)):(this.form.image=null,this.imagePreview=null)},async submitCategory(){var r,e,n,p,t;this.successMessage="",this.errorMessage="",this.loading=!0;try{const o=new FormData;o.append("name_en",this.form.name),o.append("name_ar",this.form.name_ar),o.append("description_en",this.form.description),o.append("description_ar",this.form.description_ar),o.append("brand_id",this.form.brand_id),this.form.image&&o.append("image",this.form.image);const a=JSON.parse(localStorage.getItem("tokenData"));a!=null&&a.token&&(m.defaults.headers.common.Authorization=`Bearer ${a.token}`);const f=await m.post("https://massagebackend.webenia.org/api/categories",o,{headers:{"Content-Type":"multipart/form-data"}});if((r=f.data)!=null&&r.status&&((e=f.data)!=null&&e.data))this.loading=!1,this.successMessage="Category created successfully!",this.form={name:"",name_ar:"",description:"",description_ar:"",brand_id:"",image:null},this.imagePreview=null,setTimeout(()=>{this.$router.push("/categories")},1500);else throw new Error(((n=f.data)==null?void 0:n.message)||"Failed to create category")}catch(o){this.loading=!1,this.errorMessage=((t=(p=o.response)==null?void 0:p.data)==null?void 0:t.message)||o.message||"An error occurred while creating the category."}}}},b={class:"category-create"},w={class:"form-card"},C={class:"form-title"},k={key:0,class:"loading-overlay"},M={key:1,class:"success-message"},A={key:2,class:"error-message"},B={class:"form-group"},P={class:"form-group"},F={class:"form-group"},S={class:"form-group"},U={class:"form-group"},D={class:"file-input-wrapper"},E={key:0,class:"image-preview-container"},I={class:"preview-title"},N={class:"image-preview"},V=["src"],q={type:"submit",class:"submit-button"};function T(r,e,n,p,t,o){return l(),d("div",b,[s("div",w,[s("h2",C,i(r.$t("Categories.AddCategory")),1),t.loading?(l(),d("div",k,[...e[6]||(e[6]=[s("span",{class:"spinner"},null,-1)])])):c("",!0),t.successMessage?(l(),d("div",M,i(t.successMessage),1)):c("",!0),t.errorMessage?(l(),d("div",A,i(t.errorMessage),1)):c("",!0),s("form",{onSubmit:e[5]||(e[5]=_((...a)=>o.submitCategory&&o.submitCategory(...a),["prevent"])),style:v(t.loading?"pointer-events:none;opacity:0.5;":"")},[s("div",B,[s("label",null,i(r.$t("Categories.NameEn")),1),g(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>t.form.name=a),required:"",class:"form-input"},null,512),[[u,t.form.name]])]),s("div",P,[s("label",null,i(r.$t("Categories.NameAr")),1),g(s("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>t.form.name_ar=a),required:"",class:"form-input"},null,512),[[u,t.form.name_ar]])]),s("div",F,[s("label",null,i(r.$t("Categories.DescriptionEn")),1),g(s("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>t.form.description=a),required:"",class:"form-input form-textarea"},null,512),[[u,t.form.description]])]),s("div",S,[s("label",null,i(r.$t("Categories.DescriptionAr")),1),g(s("textarea",{"onUpdate:modelValue":e[3]||(e[3]=a=>t.form.description_ar=a),required:"",class:"form-input form-textarea"},null,512),[[u,t.form.description_ar]])]),s("div",U,[s("label",null,i(r.$t("Categories.Image")),1),s("div",D,[s("input",{type:"file",onChange:e[4]||(e[4]=(...a)=>o.onFileChange&&o.onFileChange(...a)),accept:"image/*",required:"",class:"form-input file-input"},null,32)])]),t.imagePreview?(l(),d("div",E,[s("p",I,i(r.$t("Categories.ImagePreview")),1),s("div",N,[s("img",{src:t.imagePreview,alt:"Image Preview"},null,8,V)])])):c("",!0),s("button",q,i(r.$t("Categories.CreateButton")),1)],36)])])}const O=h(y,[["render",T],["__scopeId","data-v-152d665c"]]);export{O as default};
