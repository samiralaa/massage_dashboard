import{_ as Q,C as X,D as Z,y as c,L as x,N as ee,E as ae,r as m,o as d,c as v,e as t,p as o,b as s,U as V,a as U,t as C,F as b,j as E,d as P,l as f,f as I}from"./index-50b21e1d.js";const le={class:"product-create-container"},te={class:"el-upload__text"},k="https://massagebackend.webenia.org",re={__name:"create",setup(oe){X();const q=Z(),D=c(null),r=c({name_en:"",name_ar:"",price:"",is_available:1,description_en:"",description_ar:"",category_id:null,currency_id:null,country_id:null,parent_id:null,brand_id:null}),_=c({unit_id:null,weight:null,price:null}),i=localStorage.getItem("lang")||"en",$=c(!1),h=c([]),w=c([]),N=c([]),A=c([]),B=c([]),F=c([]),R=c([]),O={name_en:[{required:!0,message:i==="en"?"Please input product name (EN)":"من فضلك ادخل اسم المنتج بالانجليزي",trigger:"blur"}],price:[{required:!0,message:i==="en"?"Please input product price":"من فضلك ادخل سعر المنتج",trigger:"blur"}],category_id:[{required:!0,message:i==="en"?"Please select a category":"من فضلك اختر فئة",trigger:"change"}],currency_id:[{required:!0,message:i==="en"?"Please select a currency":"من فضلك اختر عملة",trigger:"change"}],country_id:[{required:!0,message:i==="en"?"Please select a country":"من فضلك اختر بلد",trigger:"change"}],brand_id:[{required:!0,message:i==="en"?"Please select a brand":"من فضلك اختر براند",trigger:"change"}]},z=async()=>{try{const l=JSON.parse(localStorage.getItem("tokenData"));s.defaults.headers.common.Authorization=`Bearer ${l.token}`;const[e,u,n,p,S]=await Promise.all([s.get(`${k}/api/categories`),s.get(`${k}/api/website/currencies`),s.get(`${k}/api/countries`),s.get(`${k}/api/products`),s.get(`${k}/api/units`)]);w.value=e.data.data||[],N.value=u.data.data||[],A.value=n.data.data||[],B.value=p.data.data||[],F.value=S.data.data||[]}catch{V.error(i==="en"?"Failed to load options":"فشل تحميل الخيارات")}},J=async()=>{try{const l=JSON.parse(localStorage.getItem("tokenData"));s.defaults.headers.common.Authorization=`Bearer ${l.token}`;const e=await s.get("https://massagebackend.webenia.org/api/brands");R.value=Array.isArray(e.data.data)?e.data.data:[e.data.data]}catch{V.error(i==="en"?"Failed to load brands":"فشل تحميل البراندات")}},L=x(()=>N.value.filter(l=>!l.is_deleted)),M=l=>(localStorage.getItem("lang")||"en")==="ar"?l.name_ar:l.name_en,T=(l,e)=>h.value=e,j=(l,e)=>h.value=e,W=()=>{D.value.validate(async l=>{if(l)try{const e=new FormData;for(const p in r.value)r.value[p]!==null&&e.append(p,r.value[p]);h.value.forEach(p=>e.append("images[]",p.raw)),$.value&&(e.append("unit_id",_.value.unit_id),e.append("weight",_.value.weight),e.append("price",_.value.price));const u=JSON.parse(localStorage.getItem("tokenData"));s.defaults.headers.common.Authorization=`Bearer ${u.token}`;const n=await s.post(`${k}/api/products`,e,{headers:{"Content-Type":"multipart/form-data"}});if(n.data.status)V.success(i==="en"?"Product created successfully":"تم إنشاء المنتج بنجاح"),q.push("/products");else throw new Error(n.data.message||"Failed to create product")}catch{V.error(i==="en"?"Failed to create product":"فشل إنشاء المنتج")}})};return ee(()=>r.value.brand_id,async l=>{if(l)try{const e=JSON.parse(localStorage.getItem("tokenData"));s.defaults.headers.common.Authorization=`Bearer ${e.token}`;const u=await s.get(`https://massagebackend.webenia.org/api/brands/${l}/categories`);w.value=u.data.data,r.value.category_id=null}catch{V.error(i==="en"?"Failed to load categories for brand":"فشل تحميل الفئات للبراند")}else try{const e=JSON.parse(localStorage.getItem("tokenData"));s.defaults.headers.common.Authorization=`Bearer ${e.token}`;const u=await s.get("https://massagebackend.webenia.org/api/categories");w.value=u.data.data,r.value.category_id=null}catch{V.error(i==="en"?"Failed to load categories":"فشل تحميل الفئات")}}),ae(()=>{z(),J()}),(l,e)=>{const u=m("el-input"),n=m("el-form-item"),p=m("el-switch"),S=m("el-divider"),g=m("el-option"),y=m("el-select"),Y=m("el-upload"),G=m("el-button"),H=m("el-form"),K=m("el-card");return d(),v("div",le,[t(K,{class:"product-card"},{default:o(()=>[U("h2",null,C(l.$t("Products.CreateProduct")),1),t(H,{model:r.value,ref_key:"formRef",ref:D,rules:O,"label-width":"120px",enctype:"multipart/form-data"},{default:o(()=>[t(n,{label:l.$t("Products.NameEn"),prop:"name_en"},{default:o(()=>[t(u,{modelValue:r.value.name_en,"onUpdate:modelValue":e[0]||(e[0]=a=>r.value.name_en=a)},null,8,["modelValue"])]),_:1},8,["label"]),t(n,{label:l.$t("Products.NameAr"),prop:"name_ar"},{default:o(()=>[t(u,{modelValue:r.value.name_ar,"onUpdate:modelValue":e[1]||(e[1]=a=>r.value.name_ar=a)},null,8,["modelValue"])]),_:1},8,["label"]),t(n,{label:l.$t("Products.Availability"),prop:"is_available"},{default:o(()=>[t(p,{modelValue:r.value.is_available,"onUpdate:modelValue":e[2]||(e[2]=a=>r.value.is_available=a),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])]),_:1},8,["label"]),t(n,{label:"Needs Amount?"},{default:o(()=>[t(p,{modelValue:$.value,"onUpdate:modelValue":e[3]||(e[3]=a=>$.value=a),"active-text":"Yes","inactive-text":"No"},null,8,["modelValue"])]),_:1}),$.value?(d(),v(b,{key:0},[t(S,{"content-position":"left"},{default:o(()=>e[15]||(e[15]=[E("Amount Info")])),_:1,__:[15]}),t(n,{label:"Unit"},{default:o(()=>[t(y,{modelValue:_.value.unit_id,"onUpdate:modelValue":e[4]||(e[4]=a=>_.value.unit_id=a),placeholder:"Select Unit"},{default:o(()=>[(d(!0),v(b,null,P(F.value,a=>(d(),f(g,{key:a.id,label:a.name_en,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"Weight"},{default:o(()=>[t(u,{modelValue:_.value.weight,"onUpdate:modelValue":e[5]||(e[5]=a=>_.value.weight=a),type:"number",placeholder:"Enter weight"},null,8,["modelValue"])]),_:1}),t(n,{label:"Price"},{default:o(()=>[t(u,{modelValue:_.value.price,"onUpdate:modelValue":e[6]||(e[6]=a=>_.value.price=a),type:"number",placeholder:"Enter price"},null,8,["modelValue"])]),_:1})],64)):I("",!0),$.value?I("",!0):(d(),f(n,{key:1,label:l.$t("Products.Price"),prop:"price"},{default:o(()=>[t(u,{modelValue:r.value.price,"onUpdate:modelValue":e[7]||(e[7]=a=>r.value.price=a),type:"number"},null,8,["modelValue"])]),_:1},8,["label"])),t(n,{label:l.$t("Products.DescriptionEn"),prop:"description_en"},{default:o(()=>[t(u,{type:"textarea",modelValue:r.value.description_en,"onUpdate:modelValue":e[8]||(e[8]=a=>r.value.description_en=a)},null,8,["modelValue"])]),_:1},8,["label"]),t(n,{label:l.$t("Products.DescriptionAr"),prop:"description_ar"},{default:o(()=>[t(u,{type:"textarea",modelValue:r.value.description_ar,"onUpdate:modelValue":e[9]||(e[9]=a=>r.value.description_ar=a)},null,8,["modelValue"])]),_:1},8,["label"]),t(n,{label:"Brand",prop:"brand_id"},{default:o(()=>[t(y,{modelValue:r.value.brand_id,"onUpdate:modelValue":e[10]||(e[10]=a=>r.value.brand_id=a),placeholder:"Select Brand",filterable:"",clearable:""},{default:o(()=>[(d(!0),v(b,null,P(R.value,a=>(d(),f(g,{key:a.id,label:a.name_en,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:l.$t("Products.Category"),prop:"category_id"},{default:o(()=>[t(y,{modelValue:r.value.category_id,"onUpdate:modelValue":e[11]||(e[11]=a=>r.value.category_id=a),placeholder:l.$t("Products.SelectCategory"),filterable:"",clearable:""},{default:o(()=>[(d(!0),v(b,null,P(w.value,a=>(d(),f(g,{key:a.id,label:a.name_en||a.name_ar,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(n,{label:l.$t("Products.Currency"),prop:"currency_id"},{default:o(()=>[t(y,{modelValue:r.value.currency_id,"onUpdate:modelValue":e[12]||(e[12]=a=>r.value.currency_id=a),placeholder:l.$t("Products.SelectCurrency"),filterable:"",clearable:""},{default:o(()=>[(d(!0),v(b,null,P(L.value,a=>(d(),f(g,{key:a.id,label:M(a),value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(n,{label:l.$t("Products.Country"),prop:"country_id"},{default:o(()=>[t(y,{modelValue:r.value.country_id,"onUpdate:modelValue":e[13]||(e[13]=a=>r.value.country_id=a),placeholder:l.$t("Products.SelectCountry"),filterable:"",clearable:""},{default:o(()=>[(d(!0),v(b,null,P(A.value,a=>(d(),f(g,{key:a.id,label:a.name_en||a.name_ar,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(n,{label:l.$t("Products.ParentProduct"),prop:"parent_id"},{default:o(()=>[t(y,{modelValue:r.value.parent_id,"onUpdate:modelValue":e[14]||(e[14]=a=>r.value.parent_id=a),placeholder:l.$t("Products.SelectParentProduct"),clearable:""},{default:o(()=>[t(g,{label:l.$t("Products.None"),value:null},null,8,["label"]),(d(!0),v(b,null,P(B.value,a=>(d(),f(g,{key:a.id,label:a.name_en,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(n,{label:l.$t("Products.Images"),prop:"images"},{default:o(()=>[t(Y,{class:"upload-demo",drag:"",action:"","auto-upload":!1,limit:5,"file-list":h.value,"list-type":"picture","on-change":T,"on-remove":j},{default:o(()=>[e[16]||(e[16]=U("i",{class:"el-icon-upload"},null,-1)),U("div",te,C(l.$t("Products.DropFiles")),1)]),_:1,__:[16]},8,["file-list"])]),_:1},8,["label"]),t(n,null,{default:o(()=>[t(G,{type:"primary",onClick:W},{default:o(()=>[E(C(l.$t("Products.CreateButton")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},ue=Q(re,[["__scopeId","data-v-5a8fee1b"]]);export{ue as default};
