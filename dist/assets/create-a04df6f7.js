import{_ as b,b as u,r as h,o as l,c as m,a as e,t as i,f as p,g as v,i as y,w as g,v as f,e as C,p as w,F as k,d as B,l as M}from"./index-50b21e1d.js";const V={name:"CreateCategory",data(){return{form:{name:"",name_ar:"",description:"",description_ar:"",brand_id:"",image:null},imagePreview:null,brands:[],successMessage:"",errorMessage:"",loading:!1}},created(){this.fetchBrands()},methods:{async fetchBrands(){try{const r=JSON.parse(localStorage.getItem("tokenData"));r!=null&&r.token&&(u.defaults.headers.common.Authorization=`Bearer ${r.token}`);const s=await u.get("https://massagebackend.webenia.org/api/brands");if(s.data.status){const n=s.data.data;this.brands=Array.isArray(n)?n:[n]}else throw new Error(s.data.message||"Failed to fetch brands")}catch(r){console.error("Error fetching brands:",r),alert("Failed to load brands")}},onFileChange(r){const s=r.target.files[0];s?(this.form.image=s,this.imagePreview=URL.createObjectURL(s)):(this.form.image=null,this.imagePreview=null)},async submitCategory(){var r,s,n,_,t;this.successMessage="",this.errorMessage="",this.loading=!0;try{const o=new FormData;o.append("name_en",this.form.name),o.append("name_ar",this.form.name_ar),o.append("description_en",this.form.description),o.append("description_ar",this.form.description_ar),o.append("brand_id",this.form.brand_id),this.form.image&&o.append("image",this.form.image);const d=JSON.parse(localStorage.getItem("tokenData"));d!=null&&d.token&&(u.defaults.headers.common.Authorization=`Bearer ${d.token}`);const c=await u.post("https://massagebackend.webenia.org/api/categories",o,{headers:{"Content-Type":"multipart/form-data"}});if((r=c.data)!=null&&r.status&&((s=c.data)!=null&&s.data))this.loading=!1,this.successMessage="Category created successfully!",this.form={name:"",name_ar:"",description:"",description_ar:"",brand_id:"",image:null},this.imagePreview=null,setTimeout(()=>{this.$router.push("/categories")},1500);else throw new Error(((n=c.data)==null?void 0:n.message)||"Failed to create category")}catch(o){this.loading=!1,this.errorMessage=((t=(_=o.response)==null?void 0:_.data)==null?void 0:t.message)||o.message||"An error occurred while creating the category."}}}},F={class:"category-create"},S={class:"form-card"},A={class:"form-title"},P={key:0,class:"loading-overlay"},N={key:1,class:"success-message"},U={key:2,class:"error-message"},D={class:"form-group"},E={class:"form-group"},I={class:"form-group"},q={class:"form-group"},z={class:"form-group"},L={class:"form-group"},O=["value"],T={class:"form-group"},J={class:"file-input-wrapper"},R={key:0,class:"image-preview-container"},j={class:"preview-title"},x={class:"image-preview"},G=["src"],H={type:"submit",class:"submit-button"};function K(r,s,n,_,t,o){const d=h("el-option"),c=h("el-select");return l(),m("div",F,[e("div",S,[e("h2",A,i(r.$t("Categories.AddCategory")),1),t.loading?(l(),m("div",P,s[7]||(s[7]=[e("span",{class:"spinner"},null,-1)]))):p("",!0),t.successMessage?(l(),m("div",N,i(t.successMessage),1)):p("",!0),t.errorMessage?(l(),m("div",U,i(t.errorMessage),1)):p("",!0),e("form",{onSubmit:s[6]||(s[6]=v((...a)=>o.submitCategory&&o.submitCategory(...a),["prevent"])),style:y(t.loading?"pointer-events:none;opacity:0.5;":"")},[e("div",D,[e("label",null,i(r.$t("Categories.NameEn")),1),g(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.form.name=a),required:"",class:"form-input"},null,512),[[f,t.form.name]])]),e("div",E,[e("label",null,i(r.$t("Categories.NameAr")),1),g(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>t.form.name_ar=a),required:"",class:"form-input"},null,512),[[f,t.form.name_ar]])]),e("div",I,[e("label",null,i(r.$t("Categories.DescriptionEn")),1),g(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=a=>t.form.description=a),required:"",class:"form-input form-textarea"},null,512),[[f,t.form.description]])]),e("div",q,[e("label",null,i(r.$t("Categories.DescriptionAr")),1),g(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=a=>t.form.description_ar=a),required:"",class:"form-input form-textarea"},null,512),[[f,t.form.description_ar]])]),e("div",z,[e("label",null,i(r.$t("Categories.Brand")),1),C(c,{modelValue:t.form.brand_id,"onUpdate:modelValue":s[4]||(s[4]=a=>t.form.brand_id=a),placeholder:r.$t("Categories.SelectBrand"),filterable:"",clearable:"",class:"form-input"},{default:w(()=>[(l(!0),m(k,null,B(t.brands,a=>(l(),M(d,{key:a.id,label:a.name_en,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),e("div",L,[e("label",null,i(r.$t("Categories.Selected-Brand")),1),e("input",{class:"form-input",value:t.form.brand_id,readonly:""},null,8,O)]),e("div",T,[e("label",null,i(r.$t("Categories.Image")),1),e("div",J,[e("input",{type:"file",onChange:s[5]||(s[5]=(...a)=>o.onFileChange&&o.onFileChange(...a)),accept:"image/*",required:"",class:"form-input file-input"},null,32)])]),t.imagePreview?(l(),m("div",R,[e("p",j,i(r.$t("Categories.ImagePreview")),1),e("div",x,[e("img",{src:t.imagePreview,alt:"Image Preview"},null,8,G)])])):p("",!0),e("button",H,i(r.$t("Categories.CreateButton")),1)],36)])])}const W=b(V,[["render",K],["__scopeId","data-v-7eb7104b"]]);export{W as default};
