import{_ as h,h as m,o as l,c as d,a as e,t as i,i as c,l as _,Q as v,G as u,R as g}from"./index-8c31c214.js";const y={name:"CreateCategory",data(){return{form:{name:"",name_ar:"",description:"",description_ar:"",brand_id:"",image:null},imagePreview:null,brands:[],successMessage:"",errorMessage:"",loading:!1}},created(){this.fetchBrands()},methods:{async fetchBrands(){try{const r=JSON.parse(localStorage.getItem("tokenData"));r!=null&&r.token&&(m.defaults.headers.common.Authorization=`Bearer ${r.token}`);const s=await m.get("https://massagebackend.webenia.org/api/brands");if(s.data.status){const n=s.data.data;this.brands=Array.isArray(n)?n:[n]}else throw new Error(s.data.message||"Failed to fetch brands")}catch(r){console.error("Error fetching brands:",r),alert("Failed to load brands")}},onFileChange(r){const s=r.target.files[0];s?(this.form.image=s,this.imagePreview=URL.createObjectURL(s)):(this.form.image=null,this.imagePreview=null)},async submitCategory(){var r,s,n,p,t;this.successMessage="",this.errorMessage="",this.loading=!0;try{const o=new FormData;o.append("name_en",this.form.name),o.append("name_ar",this.form.name_ar),o.append("description_en",this.form.description),o.append("description_ar",this.form.description_ar),o.append("brand_id",this.form.brand_id),this.form.image&&o.append("image",this.form.image);const a=JSON.parse(localStorage.getItem("tokenData"));a!=null&&a.token&&(m.defaults.headers.common.Authorization=`Bearer ${a.token}`);const f=await m.post("https://massagebackend.webenia.org/api/categories",o,{headers:{"Content-Type":"multipart/form-data"}});if((r=f.data)!=null&&r.status&&((s=f.data)!=null&&s.data))this.loading=!1,this.successMessage="Category created successfully!",this.form={name:"",name_ar:"",description:"",description_ar:"",brand_id:"",image:null},this.imagePreview=null,setTimeout(()=>{this.$router.push("/categories")},1500);else throw new Error(((n=f.data)==null?void 0:n.message)||"Failed to create category")}catch(o){this.loading=!1,this.errorMessage=((t=(p=o.response)==null?void 0:p.data)==null?void 0:t.message)||o.message||"An error occurred while creating the category."}}}},b={class:"category-create"},w={class:"form-card"},C={class:"form-title"},k={key:0,class:"loading-overlay"},M={key:1,class:"success-message"},B={key:2,class:"error-message"},A={class:"form-group"},P={class:"form-group"},S={class:"form-group"},F={class:"form-group"},D={class:"form-group"},E=["value"],I={class:"form-group"},N={class:"file-input-wrapper"},U={key:0,class:"image-preview-container"},V={class:"preview-title"},q={class:"image-preview"},z=["src"],O={type:"submit",class:"submit-button"};function R(r,s,n,p,t,o){return l(),d("div",b,[e("div",w,[e("h2",C,i(r.$t("Categories.AddCategory")),1),t.loading?(l(),d("div",k,s[6]||(s[6]=[e("span",{class:"spinner"},null,-1)]))):c("",!0),t.successMessage?(l(),d("div",M,i(t.successMessage),1)):c("",!0),t.errorMessage?(l(),d("div",B,i(t.errorMessage),1)):c("",!0),e("form",{onSubmit:s[5]||(s[5]=_((...a)=>o.submitCategory&&o.submitCategory(...a),["prevent"])),style:v(t.loading?"pointer-events:none;opacity:0.5;":"")},[e("div",A,[e("label",null,i(r.$t("Categories.NameEn")),1),u(e("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>t.form.name=a),required:"",class:"form-input"},null,512),[[g,t.form.name]])]),e("div",P,[e("label",null,i(r.$t("Categories.NameAr")),1),u(e("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>t.form.name_ar=a),required:"",class:"form-input"},null,512),[[g,t.form.name_ar]])]),e("div",S,[e("label",null,i(r.$t("Categories.DescriptionEn")),1),u(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=a=>t.form.description=a),required:"",class:"form-input form-textarea"},null,512),[[g,t.form.description]])]),e("div",F,[e("label",null,i(r.$t("Categories.DescriptionAr")),1),u(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=a=>t.form.description_ar=a),required:"",class:"form-input form-textarea"},null,512),[[g,t.form.description_ar]])]),e("div",D,[e("label",null,i(r.$t("Categories.Selected-Brand")),1),e("input",{class:"form-input",value:t.form.brand_id,readonly:""},null,8,E)]),e("div",I,[e("label",null,i(r.$t("Categories.Image")),1),e("div",N,[e("input",{type:"file",onChange:s[4]||(s[4]=(...a)=>o.onFileChange&&o.onFileChange(...a)),accept:"image/*",required:"",class:"form-input file-input"},null,32)])]),t.imagePreview?(l(),d("div",U,[e("p",V,i(r.$t("Categories.ImagePreview")),1),e("div",q,[e("img",{src:t.imagePreview,alt:"Image Preview"},null,8,z)])])):c("",!0),e("button",O,i(r.$t("Categories.CreateButton")),1)],36)])])}const J=h(y,[["render",R],["__scopeId","data-v-47f8950f"]]);export{J as default};
