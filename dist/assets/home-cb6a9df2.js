import{s as ee,u as te,A as H,x as se,_ as E,r as $,o as u,c as m,a as e,e as y,t as h,F as j,d as M,n as D,f as C,b as B,p as T,y as V,z as R,B as J,C as K,D as Y,E as G,G as Q,I as w,l as N,j as q,J as oe,m as ae,w as ie,v as ne,H as re,k as ce,K as le}from"./index-50b21e1d.js";import{$ as W}from"./slick-theme-ced8f1f2.js";const de={name:"WebsiteCategories",computed:{...ee("websiteCategories",{categories:s=>s.items,loading:s=>s.loading,error:s=>s.error})},created(){this.loadCategories()},methods:{...te("websiteCategories",{fetchCategories:"fetchWebsiteCategories"}),getProductImage(s){if(!s.image)return"/placeholder-image.jpg";const o=s.image,d=`${H}/public/storage/`;if(o.startsWith(d))return o;if(o.startsWith(H)){const g=o.substring(H.length);return`${d}${g.startsWith("/")?g.substring(1):g}`}return o.startsWith("http")?o:`${d}${o}`},async loadCategories(){try{await this.fetchCategories(),await se();const s=W(this.$refs.slider);s.hasClass("slick-initialized")&&s.slick("unslick"),s.slick({slidesToShow:7,slidesToScroll:1,rtl:this.$i18n.locale==="ar",responsive:[{breakpoint:1200,settings:{slidesToShow:5}},{breakpoint:992,settings:{slidesToShow:4}},{breakpoint:768,settings:{slidesToShow:3}},{breakpoint:576,settings:{slidesToShow:2}},{breakpoint:400,settings:{slidesToShow:1}}]})}catch(s){console.error("Failed to load categories:",s)}},scrollLeft(){const s=W(this.$refs.slider);s.length&&s.hasClass("slick-initialized")&&s.slick("slickPrev")},scrollRight(){const s=W(this.$refs.slider);s.length&&s.hasClass("slick-initialized")&&s.slick("slickNext")},getAlt(s){return this.$i18n.locale==="ar"?s.name_ar:s.name}},beforeUnmount(){const s=W(this.$refs.slider);s.length&&s.hasClass("slick-initialized")&&s.slick("unslick")}},ue={class:"all-categories py-4"},_e={class:"container"},he={class:"title"},ge={class:"slider-wrapper"},me={class:"scrollers ms-3 mb-2"},fe={class:"slider",ref:"slider"},ve=["href"],pe={class:"category-content"},ye=["src"],be={key:0,class:"loading-overlay"},we={key:1,class:"error-message"};function $e(s,o,d,g,l,_){const k=$("fa");return u(),m("section",ue,[e("div",_e,[e("div",he,[y(k,{class:"fa-icon",icon:["fas","cubes"]}),e("h2",null,h(s.$t("home.categories")),1)]),e("div",ge,[e("div",me,[e("button",{class:"btn nav-button left",onClick:o[0]||(o[0]=(...c)=>_.scrollLeft&&_.scrollLeft(...c))},[y(k,{icon:"arrow-left"})]),e("button",{class:"btn nav-button right",onClick:o[1]||(o[1]=(...c)=>_.scrollRight&&_.scrollRight(...c))},[y(k,{icon:"arrow-right"})])]),e("div",fe,[(u(!0),m(j,null,M(s.categories,c=>(u(),m("a",{key:c.id,class:"card",href:`/category/${c.id}`},[e("div",pe,[e("img",{src:_.getProductImage(c)},null,8,ye),e("p",{class:D({rtl:s.$i18n.locale==="ar"})},h(s.$i18n.locale==="ar"?c.name_ar:c.name),3)])],8,ve))),128))],512),s.loading?(u(),m("div",be,o[2]||(o[2]=[e("div",{class:"loading-spinner"},null,-1)]))):C("",!0),s.error?(u(),m("div",we,h(s.error),1)):C("",!0)])])])}const ke=E(de,[["render",$e],["__scopeId","data-v-07b6dc6c"]]);const Ce={name:"HomeBrands",data(){return{brands:[]}},created(){this.fetchBrands()},methods:{async fetchBrands(){try{const s=await B.get("https://massagebackend.webenia.org/api/website/brands/section");this.brands=s.data.data}catch(s){console.error("Error fetching brands:",s)}},getImageUrl(s){return`https://massagebackend.webenia.org/public/storage/${s}`}}},Se={class:"our-brands py-5"},Pe={class:"container"},Fe={class:"title"},xe={class:"d-flex flex-wrap justify-content-center gap-4"},Ie=["src","alt"],Oe={key:1,class:"no-image"};function Be(s,o,d,g,l,_){const k=$("fa"),c=$("router-link");return u(),m("section",Se,[e("div",Pe,[e("div",Fe,[y(k,{class:"fa-icon",icon:["fas","tag"]}),e("h2",null,h(s.$t("home.brands")),1)]),e("div",xe,[(u(!0),m(j,null,M(l.brands,F=>(u(),m("div",{key:F.id,class:"brand-card d-flex align-items-center justify-content-center"},[y(c,{to:`/brand/${F.id}`,class:"brand-link text-decoration-none"},{default:T(()=>[F.images.length?(u(),m("img",{key:0,src:_.getImageUrl(F.images[0].path),alt:F.name_en,class:"brand-image",loading:"lazy"},null,8,Ie)):(u(),m("div",Oe,"No Image"))]),_:2},1032,["to"])]))),128))])])])}const Te=E(Ce,[["render",Be],["__scopeId","data-v-ce45a5ad"]]);const Ve={class:"products-section"},Le={class:"container"},Ue={class:"title section-header d-flex align-items-center mb-4"},Ae={class:"mb-0"},Ee={key:0,class:"text-center my-4"},Ne={key:1},je={class:"row g-3"},ze={class:"product-card card border-0 h-100"},De={class:"position-relative overflow-hidden bg-light"},Me=["src","alt"],We={key:0,class:"sale-badge"},qe={class:"product-actions d-flex justify-content-center gap-2 w-100"},He=["onClick","disabled"],Re=["onClick"],Je=["onClick","title"],Ke={class:"card-body"},Ge={class:"card-title"},Qe={class:"price-container"},Xe={key:0,class:"discount-badge"},Ye={key:1,class:"price-old",dir:"ltr"},Ze={class:"card-text card-price",dir:"ltr"},et={class:"d-flex justify-content-center mt-4"},tt={__name:"ProductSection",setup(s){const o=V([]),d=V([]),g=V(!1),l=R(),_=J(),{locale:k,t:c}=K(),F=Y(),I=t=>`https://massagebackend.webenia.org/public/storage/${t}`,L=async()=>{try{const t=await B.get("https://massagebackend.webenia.org/api/currencies");t.data.currencies&&(d.value=t.data.currencies)}catch(t){console.error("Error fetching currencies:",t)}},x=async()=>{try{const t=JSON.parse(localStorage.getItem("selectedCurrency"))||{code:"USD"},p=await B.get("https://massagebackend.webenia.org/api/website/products/section",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,Currency:t.code}});p.data.status&&(o.value=p.data.data,await U())}catch(t){console.error("Error fetching products:",t),w({title:"Error",message:"Failed to load products.",type:"error"})}finally{g.value=!1}},U=async()=>{try{const t=await B.get("https://massagebackend.webenia.org/api/favorites",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});t.data.status&&t.data.data&&l.setFavorites(t.data.data)}catch(t){console.error("Error fetching favorites:",t)}},O=t=>l.favorites.some(p=>p.product_id===t),A=t=>{var p,f;return((p=l.favorites.find(P=>P.product_id===t))==null?void 0:p.favorite_id)||((f=l.favorites.find(P=>P.product_id===t))==null?void 0:f.id)},r=async t=>{var p,f,P,a;try{if(O(t.id)){const S=A(t.id);S&&(await l.removeFromFavorites(S),w({title:c("success"),message:c("favorite_removed")||"Product removed from favorites",type:"success"}))}else{const S=await l.addToFavorites(t.id);w({title:c("success"),message:c("favorite_added"),type:"success"})}}catch(S){if(((f=(p=S.response)==null?void 0:p.data)==null?void 0:f.message)==="Unauthenticated."){w({title:c("error"),message:c("unauthenticated"),type:"warning",duration:4e3});return}w({title:c("error"),message:((a=(P=S.response)==null?void 0:P.data)==null?void 0:a.message)||c("login_required_favorite")||"Login required to favorite product",type:"error"})}},b=async t=>{var p,f,P,a;try{let S=0;if(t.discount&&t.discount.is_active){const Z=parseFloat(t.discount.discount_value),X=parseFloat(t.price);S=X-X*(Z/100)}else S=parseFloat(t.price);const z=await B.post("https://massagebackend.webenia.org/api/cart-items",{product_id:t.id,quantity:1,price:S},{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});z.data.status?(w({title:c("success"),message:c("cart.added_to_cart"),type:"success"}),_.incrementCount(),await _.fetchCartCount()):w.error(z.data.message)}catch(S){if(((f=(p=S.response)==null?void 0:p.data)==null?void 0:f.message)==="Unauthenticated."){w({title:c("error"),message:c("unauthenticated"),type:"warning",duration:4e3});return}w.error(((a=(P=S.response)==null?void 0:P.data)==null?void 0:a.message)||"Error adding product to cart")}},i=t=>{if(t.discount&&t.discount.is_active){const p=parseFloat(t.discount.discount_value),f=parseFloat(t.converted_price||t.price);return(f-f*(p/100)).toFixed(2)}return t.converted_price||t.price},n=t=>{if(t.discount&&t.discount.is_active){const p=parseFloat(t.discount.discount_value);return Math.round(p)}return 0},v=()=>{F.push("/product-listing")};return G(async()=>{await L(),await x(),window.addEventListener("currency-changed",()=>{x()})}),(t,p)=>{const f=$("fa"),P=$("router-link");return u(),m("div",Ve,[e("div",Le,[e("div",Ue,[y(f,{class:"fa-icon me-2",icon:["fas","shopping-basket"]}),e("h2",Ae,h(t.$t("home.products")),1)]),g.value?(u(),m("div",Ee,"Loading products...")):(u(),m("div",Ne,[e("div",je,[(u(!0),m(j,null,M(o.value,a=>(u(),m("div",{key:a.id,class:"col-sm-6 col-md-4 col-lg-3"},[e("div",ze,[e("div",De,[y(P,{to:`/read/products/${a.id}`},{default:T(()=>[a.images&&a.images.length?(u(),m("img",{key:0,src:I(a.images[0].path),alt:a.name_en,class:"card-img-top product-img"},null,8,Me)):C("",!0)]),_:2},1032,["to"]),a.is_available?C("",!0):(u(),m("div",We,h(t.$t("products.outOfStock")),1)),e("div",qe,[y(P,{to:`/read/products/${a.id}`,class:"btn btn-light rounded-circle shadow-sm",title:"View"},{default:T(()=>[y(f,{icon:"eye"})]),_:2},1032,["to"]),e("button",{onClick:S=>b(a),class:D(["btn btn-light shadow-sm disable",{disabled:!a.is_available}]),disabled:!a.is_available},h(t.$t("home.add-to-cart")),11,He),e("button",{onClick:S=>b(a),class:"d-none btn rounded-circle shadow-sm btn-light enable"},[y(f,{icon:"shopping-cart"})],8,Re),e("button",{onClick:S=>r(a),class:D(["btn rounded-circle shadow-sm btn-light",O(a.id)?"text-danger":""]),title:O(a.id)?"Remove from favorites":"Add to favorites"},[y(f,{icon:O(a.id)?"fas fa-heart":"far fa-heart"},null,8,["icon"])],10,Je)])]),e("div",Ke,[e("h5",Ge,h(Q(k)==="ar"?a.name_ar:a.name_en),1),e("div",Qe,[a.discount&&a.discount.is_active?(u(),m("span",Xe,h(n(a))+"% OFF ",1)):C("",!0),a.discount&&a.discount.is_active?(u(),m("span",Ye,h(a.converted_price)+" "+h(a.currency_code),1)):C("",!0),e("span",Ze,h(i(a))+" "+h(a.currency_code),1)])])])]))),128))]),e("div",et,[e("button",{class:"btn view-all-btn",onClick:v},h(t.$t("home.view-all-products")),1)])]))])])}}},st=E(tt,[["__scopeId","data-v-430081c9"]]);const ot={class:"products-section"},at={class:"container"},it={class:"title mt-5"},nt={class:"row g-4"},rt={class:"card my-3 p-sm-4"},ct={class:"img-container rounded position-relative"},lt=["src","alt"],dt={key:0,class:"sale-badge"},ut={class:"body-container"},_t={class:"card-body"},ht={class:"card-title"},gt={class:"price-container"},mt={key:0,class:"discount-badge"},ft={key:1,class:"price-old",dir:"ltr"},vt={class:"card-text card-price",dir:"ltr"},pt={class:"product-actions d-flex justify-content-center flex-wrap gap-2"},yt=["disabled","onClick"],bt=["onClick","title"],wt={__name:"BestSelling",setup(s){const o=V([]),d=V(!1),g=V(""),l=R(),_=J(),{locale:k,t:c}=K();V([]),V({code:"USD"});const F=async()=>{try{const i=JSON.parse(localStorage.getItem("selectedCurrency"))||{code:"USD"},n=await B.get("https://massagebackend.webenia.org/api/website/best-selling/products",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,Currency:i.code}});n.data.status&&n.data.data&&(o.value=n.data.data,await I())}catch(i){console.error("Error fetching products:",i),w({title:"Error",message:"Failed to load products.",type:"error"})}},I=async()=>{try{const i=await B.get("https://massagebackend.webenia.org/api/favorites",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});i.data.status&&i.data.data&&l.setFavorites(i.data.data)}catch(i){console.error("Error fetching favorites:",i)}},L=i=>`https://massagebackend.webenia.org/public/storage/${i}`,x=i=>l.favorites.some(n=>n.product_id===i),U=i=>{const n=l.favorites.find(v=>v.product_id===i);return n?n.favorite_id||n.id:null},O=async i=>{var n,v,t,p;try{if(x(i.id)){const f=U(i.id);f&&(await l.removeFromFavorites(f),w({title:c("success"),message:c("favorite_removed")||"Product removed from favorites",type:"success"}))}else{const f=await l.addToFavorites(i.id);w({title:c("success"),message:f.message||c("favorite_added")||"Product added to favorites",type:"success"})}}catch(f){if(((v=(n=f.response)==null?void 0:n.data)==null?void 0:v.message)==="Unauthenticated."){w({title:c("error"),message:c("unauthenticated"),type:"warning",duration:4e3});return}w({title:c("error"),message:((p=(t=f.response)==null?void 0:t.data)==null?void 0:p.message)||c("login_required_favorite")||"Login required to favorite product",type:"error"})}},A=async i=>{var n,v,t,p;try{let f=0;if(i.discount&&i.discount.is_active){const S=parseFloat(i.discount.discount_value),z=parseFloat(i.price);f=z-z*(S/100)}else f=parseFloat(i.price);const P=localStorage.getItem("user_id"),a=await B.post("https://massagebackend.webenia.org/api/cart-items",{product_id:i.id,quantity:1,price:f,user_id:P},{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});a.data.status?(w({title:c("success"),message:a.data.message,type:"success"}),_.incrementCount(),await _.fetchCartCount()):w({title:c("error"),message:a.data.message,type:"error"})}catch(f){if(((v=(n=f.response)==null?void 0:n.data)==null?void 0:v.message)==="Unauthenticated."){w({title:c("error"),message:c("unauthenticated"),type:"warning",duration:4e3});return}w({title:c("error"),message:(p=(t=f.response)==null?void 0:t.data)==null?void 0:p.message,type:"error"})}},r=i=>{if(i.discount&&i.discount.is_active){const n=parseFloat(i.discount.discount_value),v=parseFloat(i.converted_price||i.price);return(v-v*(n/100)).toFixed(2)}return i.converted_price||i.price},b=i=>{if(i.discount&&i.discount.is_active){const n=parseFloat(i.discount.discount_value);return Math.round(n)}return 0};return G(()=>{F(),window.addEventListener("currency-changed",()=>{F()})}),(i,n)=>{const v=$("fa"),t=$("router-link"),p=$("el-col"),f=$("el-button"),P=$("el-dialog");return u(),m("div",ot,[e("div",at,[e("div",it,[y(v,{class:"fa-icon",icon:["fas","star"]}),e("h2",null,h(i.$t("home.best-selling")),1)]),e("div",nt,[(u(!0),m(j,null,M(o.value,a=>(u(),N(p,{key:a.id,xs:24,sm:24,md:12,lg:12},{default:T(()=>[e("div",rt,[e("div",ct,[y(t,{to:`/read/products/${a.id}`},{default:T(()=>[a.images.length?(u(),m("img",{key:0,src:L(a.images[0].path),alt:a.name_en,class:"product-img card-img bg-light"},null,8,lt)):C("",!0)]),_:2},1032,["to"]),a.is_available?C("",!0):(u(),m("div",dt,h(i.$t("products.outOfStock")),1))]),e("div",ut,[e("div",_t,[e("h5",ht,h(Q(k)==="ar"?a.name_ar:a.name_en),1),e("div",gt,[a.discount&&a.discount.is_active?(u(),m("span",mt,h(b(a))+"% OFF ",1)):C("",!0),a.discount&&a.discount.is_active?(u(),m("span",ft,h(a.converted_price)+" "+h(a.currency_code),1)):C("",!0),e("span",vt,h(r(a))+" "+h(a.currency_code),1)])]),e("div",pt,[y(t,{to:`/read/products/${a.id}`,class:"btn btn-light rounded-circle shadow-sm",title:"View"},{default:T(()=>[y(v,{icon:"eye"})]),_:2},1032,["to"]),e("button",{disabled:!a.is_available,onClick:S=>A(a),class:"btn btn-light shadow-sm rounded-circle"},[y(v,{icon:"cart-plus"})],8,yt),e("button",{onClick:S=>O(a),class:D(["btn rounded-circle shadow-sm btn-light",x(a.id)?"text-danger":""]),title:x(a.id)?"Remove from favorites":"Add to favorites"},[y(v,{icon:x(a.id)?"fas fa-heart":"far fa-heart"},null,8,["icon"])],10,bt)])])])]),_:2},1024))),128))])]),y(P,{modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=a=>d.value=a),title:"🎉 Success",width:"30%","before-close":()=>d.value=!1,center:!0,"close-on-click-modal":!1,"show-close":!1},{footer:T(()=>[y(f,{type:"primary",onClick:n[0]||(n[0]=a=>d.value=!1)},{default:T(()=>n[2]||(n[2]=[q("OK")])),_:1,__:[2]})]),default:T(()=>[e("span",null,h(g.value),1)]),_:1},8,["modelValue","before-close"])])}}},$t=E(wt,[["__scopeId","data-v-23275c1c"]]),kt="/assets/3-adbf781a.png",Ct="/assets/2-1da5d603.png",St="/assets/icon 1 -ced21c67.png",Pt="/assets/4-b68b6467.png",Ft="/assets/elegancewebsiteleft-524d19b0.png",xt="/assets/elegancewebsiteright-4654db9e.png";const It={name:"WhyChooseUs",data(){return{}}},Ot={class:"why-choose-us"},Bt={class:"container"},Tt={class:"title mt-5"},Vt={class:"row row-cols-xl-5 row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-1 row--20 d-flex justify-content-around"},Lt={class:"col"},Ut={class:"service-box card"},At={class:"title"},Et={class:"col"},Nt={class:"service-box card"},jt={class:"title"},zt={class:"col"},Dt={class:"service-box card"},Mt={class:"title"},Wt={class:"col"},qt={class:"service-box card"},Ht={class:"title"};function Rt(s,o,d,g,l,_){const k=$("fa");return u(),m(j,null,[e("section",Ot,[e("div",Bt,[e("div",Tt,[y(k,{class:"fa-icon",icon:["fas","shopping-basket"]}),e("h2",null,h(s.$t("home.why-us")),1)]),e("div",Vt,[e("div",Lt,[e("div",Ut,[o[0]||(o[0]=e("div",{class:"icon"},[e("img",{src:kt,class:"img-fluid",alt:"Service"})],-1)),e("h6",At,h(s.$t("home.why.fast_delivery")),1)])]),e("div",Et,[e("div",Nt,[o[1]||(o[1]=e("div",{class:"icon"},[e("img",{src:Ct,class:"img-fluid",alt:"Service"})],-1)),e("h6",jt,h(s.$t("home.why.guarantee")),1)])]),e("div",zt,[e("div",Dt,[o[2]||(o[2]=e("div",{class:"icon"},[e("img",{src:St,class:"img-fluid",alt:"Service"})],-1)),e("h6",Mt,h(s.$t("home.why.return_policy")),1)])]),e("div",Wt,[e("div",qt,[o[3]||(o[3]=e("div",{class:"icon"},[e("img",{src:Pt,class:"img-fluid",alt:"Service"})],-1)),e("h6",Ht,h(s.$t("home.why.pro_quality")),1)])])])])]),o[4]||(o[4]=oe('<div class="axil-poster mt-3" data-v-94115e7b><div class="container" data-v-94115e7b><div class="row" data-v-94115e7b><div class="col-lg-6 mb--30" data-v-94115e7b><div class="single-poster" data-v-94115e7b><a data-v-94115e7b><img src="'+Ft+'" data-v-94115e7b></a></div></div><div class="col-lg-6 mb--30" data-v-94115e7b><div class="single-poster" data-v-94115e7b><a data-v-94115e7b><img src="'+xt+'" data-v-94115e7b></a></div></div></div></div></div>',1))],64)}const Jt=E(It,[["render",Rt],["__scopeId","data-v-94115e7b"]]);const Kt={class:"products-section py-5"},Gt={class:"container"},Qt={class:"title section-header d-flex align-items-center mb-4"},Xt={class:"mb-0"},Yt={class:"row justify-content-center g-4"},Zt={class:"product-card card h-100 w-100"},es={class:"img-container overflow-hidden bg-light m-2 rounded-circle"},ts=["src","alt"],ss={key:0,class:"sale-badge"},os={class:"card-body"},as={class:"card-title"},is={class:"price-container"},ns={key:0,class:"discount-badge"},rs={key:1,class:"price-old",dir:"ltr"},cs={class:"card-text card-price",dir:"ltr"},ls={class:"product-actions d-flex justify-content-center flex-wrap gap-2"},ds=["onClick","disabled"],us=["onClick","title"],_s={__name:"LatestProducts",setup(s){const o=V([]);V(!1),V("");const d=R(),g=J(),{locale:l,t:_}=K();Y();const k=async()=>{try{const r=JSON.parse(localStorage.getItem("selectedCurrency"))||{code:"USD"},b=await B.get("https://massagebackend.webenia.org/api/website/latest/products",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,Currency:r.code}});b.data.status&&b.data.data&&(o.value=b.data.data,await c())}catch(r){console.error("Error fetching products:",r)}},c=async()=>{try{const r=await B.get("https://massagebackend.webenia.org/api/favorites",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});r.data.status&&r.data.data&&d.setFavorites(r.data.data)}catch(r){console.error("Error fetching favorites:",r)}},F=r=>`https://massagebackend.webenia.org/public/storage/${r}`,I=r=>d.favorites.some(b=>b.product_id===r),L=r=>{var b,i;return((b=d.favorites.find(n=>n.product_id===r))==null?void 0:b.favorite_id)||((i=d.favorites.find(n=>n.product_id===r))==null?void 0:i.id)},x=async r=>{var b,i,n,v;try{if(I(r.id)){const t=L(r.id);t&&(await d.removeFromFavorites(t),w({title:_("success"),message:_("favorite_removed")||"Product removed from favorites",type:"success"}))}else{const t=await d.addToFavorites(r.id);w({title:_("success"),message:t.message||_("favorite_added")||"Product added to favorites",type:"success"})}}catch(t){if(((i=(b=t.response)==null?void 0:b.data)==null?void 0:i.message)==="Unauthenticated."){w({title:_("error"),message:_("unauthenticated"),type:"warning",duration:4e3});return}w({title:_("error"),message:((v=(n=t.response)==null?void 0:n.data)==null?void 0:v.message)||_("login_required_favorite")||"Login required to favorite product",type:"error"})}},U=r=>{if(r.discount&&r.discount.is_active){const b=parseFloat(r.discount.discount_value),i=parseFloat(r.converted_price||r.price);return(i-i*(b/100)).toFixed(2)}return r.converted_price||r.price},O=r=>{if(r.discount&&r.discount.is_active){const b=parseFloat(r.discount.discount_value);return Math.round(b)}return 0},A=async r=>{var b,i,n,v;try{let t=0;if(r.discount&&r.discount.is_active){const P=parseFloat(r.discount.discount_value),a=parseFloat(r.price);t=a-a*(P/100)}else t=parseFloat(r.price);const p={product_id:r.id,quantity:1,price:t};r.amounts&&r.amounts.length>0&&(p.amount_id=r.amounts[0].id);const f=await B.post("https://massagebackend.webenia.org/api/cart-items",p,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"Content-Type":"application/json",Accept:"application/json"}});f.data.status?(w({title:_("success"),message:_("cart.added_to_cart"),type:"success"}),g.incrementCount(),await g.fetchCartCount()):w({title:_("error"),message:f.data.message,type:"error"})}catch(t){if(((i=(b=t.response)==null?void 0:b.data)==null?void 0:i.message)==="Unauthenticated."){w({title:_("error"),message:_("unauthenticated"),type:"warning",duration:4e3});return}w({title:_("error"),message:(v=(n=t.response)==null?void 0:n.data)==null?void 0:v.message,type:"error"})}};return G(()=>{k(),window.addEventListener("currency-changed",()=>{k()})}),(r,b)=>{const i=$("fa"),n=$("router-link"),v=$("el-col");return u(),m("div",Kt,[e("div",Gt,[e("div",Qt,[y(i,{class:"fa-icon me-2",icon:["fas","shopping-basket"]}),e("h2",Xt,h(r.$t("LatestProducts.LatestProducts")),1)]),e("div",Yt,[(u(!0),m(j,null,M(o.value,t=>(u(),N(v,{key:t.id,xs:24,sm:12,md:8,lg:6,class:"d-flex justify-content-center"},{default:T(()=>[e("div",Zt,[e("div",es,[y(n,{to:`/read/products/${t.id}`},{default:T(()=>[t.images.length?(u(),m("img",{key:0,src:F(t.images[0].path),alt:t.name_en,class:"product-img card-img-top"},null,8,ts)):C("",!0)]),_:2},1032,["to"]),t.is_available?C("",!0):(u(),m("div",ss,h(r.$t("products.outOfStock")),1))]),e("div",os,[e("h5",as,h(Q(l)==="ar"?t.name_ar:t.name_en),1),e("div",is,[t.discount&&t.discount.is_active?(u(),m("span",ns,h(O(t))+"% OFF ",1)):C("",!0),t.discount&&t.discount.is_active?(u(),m("span",rs,h(t.converted_price)+" "+h(t.currency_code),1)):C("",!0),e("span",cs,h(U(t))+" "+h(t.currency_code),1)]),e("div",ls,[y(n,{to:`/read/products/${t.id}`,class:"btn btn-light rounded-circle shadow-sm",title:"View"},{default:T(()=>[y(i,{icon:"eye"})]),_:2},1032,["to"]),e("button",{onClick:p=>A(t),disabled:!t.is_available,class:"btn btn-light shadow-sm"},h(r.$t("home.add-to-cart")),9,ds),e("button",{onClick:p=>x(t),class:D(["btn rounded-circle shadow-sm btn-light",I(t.id)?"text-danger":""]),title:I(t.id)?"Remove from favorites":"Add to favorites"},[y(i,{icon:I(t.id)?"fas fa-heart":"far fa-heart"},null,8,["icon"])],10,us)])])])]),_:2},1024))),128))])])])}}},hs=E(_s,[["__scopeId","data-v-a8b84805"]]);const gs={name:"Loader"},ms={class:"loader-svg-wrapper"};function fs(s,o,d,g,l,_){return u(),m("div",ms,o[0]||(o[0]=[e("div",{class:"loader"},null,-1)]))}const vs=E(gs,[["render",fs],["__scopeId","data-v-417d877b"]]);const ps={name:"VerifyOtp",emits:["close"],data(){return{success:"",error:"",showOtpInput:!0,otp:""}},methods:{async handleActiveNow(){this.success="",this.error="",await this.resendOtp(),this.showOtpInput=!0},async resendOtp(){var s,o,d;try{const g=localStorage.getItem("otp_email");if(!g){this.error="No email found. Please login again.";return}const l=await B.post("https://massagebackend.webenia.org/api/resend-otp",{email:g});(s=l.data)!=null&&s.success?this.success=((o=l.data)==null?void 0:o.message)||"OTP resent successfully.":this.error=((d=l.data)==null?void 0:d.message)||"Failed to resend OTP."}catch(g){console.error(g),this.error="Something went wrong. Please try again."}},async verifyOtp(){var g,l,_,k,c,F,I,L,x,U,O,A,r,b,i;this.success="",this.error="",this.otpMessage="";const s=Array.isArray(this.otp)?this.otp.join(""):this.otp,o=s&&/^\d{4}$/.test(s);if(!s||!o){const n=((g=this.$t)==null?void 0:g.call(this,"otp.invalidLength"))||"Please enter a valid 4-digit code";this.otpMessage=n,(_=(l=this.$toast)==null?void 0:l.error)==null||_.call(l,n);return}const d=localStorage.getItem("otp_email");if(!d){const n=((k=this.$t)==null?void 0:k.call(this,"otp.emailMissing"))||"No email found. Please login again.";this.error=n,(F=(c=this.$toast)==null?void 0:c.error)==null||F.call(c,n);return}try{const n=await B.post("https://massagebackend.webenia.org/api/client/verify-otp",{email:d,otp:s});if(n.data.status===!0){const v={...this.user,...n.data.data.user};localStorage.setItem("user",JSON.stringify(v)),localStorage.setItem("auth_token",n.data.data.token),this.success=((I=this.$t)==null?void 0:I.call(this,"otp.success"))||"OTP verified successfully!",this.otpMessage="",window.location.reload()}else{const v=n.data.message||((L=this.$t)==null?void 0:L.call(this,"otp.failed"))||"OTP verification failed.";this.otpMessage=v,(U=(x=this.$toast)==null?void 0:x.error)==null||U.call(x,v)}}catch(n){console.error("OTP verification error:",n);const v=((A=(O=n.response)==null?void 0:O.data)==null?void 0:A.message)||((r=this.$t)==null?void 0:r.call(this,"otp.error"))||"OTP verification failed";this.otpMessage=v,(i=(b=this.$toast)==null?void 0:b.error)==null||i.call(b,v)}}}},ys={class:"modal-overlay d-flex justify-content-center align-items-center"},bs={class:"cart-modal bg-white rounded-4 shadow p-4 position-relative"},ws={class:"cart-content overflow-auto d-flex align-items-center flex-column",style:{"max-height":"70vh"}},$s={class:"w-50 d-flex align-items-center flex-column text-center"},ks={key:0,class:"w-100 d-flex flex-column align-items-center mt-3"},Cs={key:1,class:"success-message"},Ss={key:2,class:"error-message"};function Ps(s,o,d,g,l,_){const k=$("fa");return u(),m("div",ys,[e("div",bs,[o[6]||(o[6]=e("div",{class:"mb-4 d-flex justify-content-center align-items-center w-100 logo-container"},[e("img",{src:ae,alt:"Logo"})],-1)),e("button",{type:"button",class:"btn-close m-3",onClick:o[0]||(o[0]=c=>s.$emit("close")),"aria-label":"Close"}),e("div",ws,[e("div",$s,[o[4]||(o[4]=e("p",{class:"text-center mb-4"},"sorry to say",-1)),y(k,{icon:"circle-exclamation",size:"xl",class:"icon mb-2"}),o[5]||(o[5]=e("h5",null,[q("Enter the "),e("span",null,"OTP"),q(" sent in the email to "),e("span",null,"active"),q(" your "),e("span",null,"account")],-1)),e("button",{type:"button",onClick:o[1]||(o[1]=(...c)=>_.handleActiveNow&&_.handleActiveNow(...c)),class:"login-btn btn my-4"},"active now")]),l.showOtpInput?(u(),m("div",ks,[ie(e("input",{dir:"ltr","onUpdate:modelValue":o[2]||(o[2]=c=>l.otp=c),type:"text",maxlength:"6",placeholder:"Enter OTP",class:"form-control mb-2",style:{"max-width":"200px","text-align":"center"}},null,512),[[ne,l.otp]]),e("button",{type:"button",onClick:o[3]||(o[3]=(...c)=>_.verifyOtp&&_.verifyOtp(...c)),class:"btn btn-success mb-2"},"Verify OTP")])):C("",!0),l.success?(u(),m("div",Cs,h(l.success),1)):C("",!0),l.error?(u(),m("div",Ss,h(l.error),1)):C("",!0)])])])}const Fs=E(ps,[["render",Ps]]);const xs={name:"Home",components:{Header:re,Categories:ke,HomeBrands:Te,LatestProducts:hs,Products:st,BestSelling:$t,WhyChooseUs:Jt,Footer:ce,Loader:vs,VerifyOtpPopup:Fs},computed:{showVerifyOtp(){return this.user&&!this.user.is_verified},direction(){return le.global.locale==="ar"?"rtl":"ltr"}},data(){return{showBrand:!1,showOurProducts:!1,showLatestProducts:!1,showBestSelling:!1,loading:!0,user:null,token:null,showVerifyOtpPopup:!1,countdown:{days:0,hours:0,minutes:0,seconds:0},countdownTarget:new Date("2025-08-30T00:00:00"),countdownInterval:null}},mounted(){this.fetchSettings(),localStorage.getItem("showVerifyOtpPopup")==="true"&&(this.showVerifyOtpPopup=!0,localStorage.removeItem("showVerifyOtpPopup")),this.startCountdown()},methods:{startCountdown(){this.updateCountdown(),this.countdownInterval=setInterval(this.updateCountdown,1e3)},updateCountdown(){const s=new Date,d=this.countdownTarget-s;d>0?(this.countdown.days=Math.floor(d/(1e3*60*60*24)),this.countdown.hours=Math.floor(d/(1e3*60*60)%24),this.countdown.minutes=Math.floor(d/(1e3*60)%60),this.countdown.seconds=Math.floor(d/1e3%60)):(this.countdown.days=0,this.countdown.hours=0,this.countdown.minutes=0,this.countdown.seconds=0,clearInterval(this.countdownInterval))},async fetchSettings(){try{const d=(await(await fetch("https://massagebackend.webenia.org/api/settings")).json()).data,g=l=>{const _=d.find(k=>k.key===l);return _&&_.value==="1"};this.showBrand=g("show_brand"),this.showOurProducts=g("show_our_products"),this.showLatestProducts=g("show_latest_products"),this.showBestSelling=g("show_best_selling_products")}catch(s){console.error("Failed to fetch settings:",s)}finally{setTimeout(()=>{this.loading=!1},3e3)}},scrollLeft(){const s=window.innerWidth,d=this.$refs.slider.querySelector(".card").offsetWidth;s<=440?this.$refs.slider.scrollBy({left:-(d*2+26),behavior:"smooth"}):s<=768?this.$refs.slider.scrollBy({left:-(d*3+50),behavior:"smooth"}):s<=1200?this.$refs.slider.scrollBy({left:-(d*4+50),behavior:"smooth"}):this.$refs.slider.scrollBy({left:-(d*7+30),behavior:"smooth"})},scrollRight(){const s=window.innerWidth,d=this.$refs.slider.querySelector(".card").offsetWidth;s<=440?this.$refs.slider.scrollBy({left:d*2+26,behavior:"smooth"}):s<=768?this.$refs.slider.scrollBy({left:d*3+50,behavior:"smooth"}):s<=1200?this.$refs.slider.scrollBy({left:d*4+50,behavior:"smooth"}):this.$refs.slider.scrollBy({left:d*7+30,behavior:"smooth"})},handleCloseOtp(){this.showVerifyOtpPopup=!1,this.user.is_verified=!0}},created(){const s=localStorage.getItem("auth_user"),o=localStorage.getItem("token");s&&(this.user=JSON.parse(s)),o&&(this.token=o)}},Is={class:"home"},Os={class:"hero-section"},Bs={class:"hero-background"},Ts={class:"countdown-overlay",dir:"ltr"},Vs={class:"countdown-flex"},Ls={class:"countdown-box"},Us={class:"countdown-number"},As={class:"countdown-box"},Es={class:"countdown-number"},Ns={class:"countdown-box"},js={class:"countdown-number"},zs={class:"countdown-box"},Ds={class:"countdown-number"};function Ms(s,o,d,g,l,_){const k=$("Loader"),c=$("Header"),F=$("verify-otp-popup"),I=$("Categories"),L=$("HomeBrands"),x=$("Products"),U=$("LatestProducts"),O=$("BestSelling"),A=$("WhyChooseUs"),r=$("Footer");return u(),m("div",Is,[l.loading?(u(),N(k,{key:0})):C("",!0),y(c),_.showVerifyOtp||l.showVerifyOtpPopup?(u(),N(F,{key:1,user:l.user,token:l.token,onClose:_.handleCloseOtp},null,8,["user","token","onClose"])):C("",!0),e("section",Os,[e("div",Bs,[e("div",Ts,[o[4]||(o[4]=e("h2",null,"عداد التوقيت",-1)),e("div",Vs,[e("div",Ls,[e("div",Us,h(l.countdown.days),1),o[0]||(o[0]=e("div",{class:"countdown-label"},"يوم",-1))]),e("div",As,[e("div",Es,h(l.countdown.hours),1),o[1]||(o[1]=e("div",{class:"countdown-label"},"ساعة",-1))]),e("div",Ns,[e("div",js,h(l.countdown.minutes),1),o[2]||(o[2]=e("div",{class:"countdown-label"},"دقيقة",-1))]),e("div",zs,[e("div",Ds,h(l.countdown.seconds),1),o[3]||(o[3]=e("div",{class:"countdown-label"},"ثانية",-1))])])])])]),y(I),l.showBrand?(u(),N(L,{key:2})):C("",!0),l.showOurProducts?(u(),N(x,{key:3})):C("",!0),l.showLatestProducts?(u(),N(U,{key:4})):C("",!0),l.showBestSelling?(u(),N(O,{key:5})):C("",!0),y(A),y(r)])}const Hs=E(xs,[["render",Ms],["__scopeId","data-v-3ab95b91"]]);export{Hs as default};
