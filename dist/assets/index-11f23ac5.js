import{_ as W,s as j,e as D,f as H,R as K,r as c,G as P,o as l,c as g,a as s,t as n,b as a,w as o,K as d,h as b,E as h,j as p,z as Y,H as E,S as F,m as y,I as k,x as G,y as L,i as M,F as q,k as Q,D as X}from"./index-0e709365.js";const Z={class:"categories-container"},ee={class:"header"},te={class:"table-wrapper"},ae={class:"image-error"},oe={key:1,class:"image-error"},se={class:"clamp-1",dir:"rtl"},ne={class:"clamp-3"},le={class:"clamp-3",dir:"rtl"},ie={class:"mobile-list"},re={key:0,class:"no-data"},ce={class:"mobile-left"},de={class:"image-error"},_e={key:1,class:"image-error"},ue={class:"mobile-right"},me={class:"name-row"},ge={class:"name-ar",dir:"rtl"},pe={class:"brand-row"},fe={class:"actions"},$="https://backend.msgperfumes.com",he={__name:"index",setup(ve){const N=j(),_=D([]),f=D(!1),C=D(!1),B=`${$}/api/categories`,x=async()=>{f.value=!0;try{const t=JSON.parse(localStorage.getItem("tokenData"));if(!t||!t.token)throw new Error("Authentication token not found");b.defaults.headers.common.Authorization=`Bearer ${t.token}`;const i=await b.get(B);i.data.status===!0?_.value=i.data.data:h.error(i.data.message||"Failed to fetch categories")}catch(t){console.error("Fetch categories error:",t),t instanceof SyntaxError?h.error("Invalid token format"):h.error(t.message||"Failed to fetch categories")}finally{f.value=!1}},R=()=>{N.push("/categories/create")},z=t=>{N.push(`/categories/edit/${t.id}`)},S=async t=>{try{if(await X.confirm("Are you sure you want to delete this category?","Warning",{confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"})==="confirm"){f.value=!0;const r=JSON.parse(localStorage.getItem("tokenData"));if(!r||!r.token)throw new Error("Authentication token not found");b.defaults.headers.common.Authorization=`Bearer ${r.token}`;const u=await b.delete(`${B}/${t.id}`);if(u.data)h.success("Category deleted successfully"),_.value=_.value.filter(v=>v.id!==t.id);else throw new Error(u.data.message||"Failed to delete category")}}catch(i){i!=="cancel"&&(console.error("Delete category error:",i),h.error(i.message||"Failed to delete category"))}finally{f.value=!1}},w=()=>{C.value=window.innerWidth<=768};return H(()=>{x(),w(),window.addEventListener("resize",w)}),K(()=>{window.removeEventListener("resize",w)}),(t,i)=>{const r=c("el-button"),u=c("el-icon"),v=c("el-image"),m=c("el-table-column"),I=c("el-tooltip"),V=c("el-button-group"),T=c("el-table"),U=c("el-tag"),J=c("el-card"),O=P("loading");return l(),g("div",Z,[s("div",ee,[s("h2",null,n(t.$t("Categories.Categories")),1),a(r,{type:"primary",icon:d(Y),onClick:R},{default:o(()=>[p(n(t.$t("Categories.AddCategory")),1)]),_:1},8,["icon"])]),a(J,{class:"categories-table"},{default:o(()=>[E(s("div",te,[E((l(),y(T,{data:_.value,style:{width:"100%"},border:"",stripe:"",size:"large","default-sort":{prop:"name_en",order:"ascending"}},{default:o(()=>[a(m,{label:t.$t("Categories.Image"),width:"120"},{default:o(({row:e})=>[e.images&&e.images.length>0?(l(),y(v,{key:0,src:`${$}/public/storage/${e.images[0].path}`,fit:"cover",class:"category-image","preview-src-list":[`${$}/${e.images[0].path}`],"initial-index":0,"preview-teleported":""},{error:o(()=>[s("div",ae,[a(u,null,{default:o(()=>[a(d(k))]),_:1})])]),_:1},8,["src","preview-src-list"])):(l(),g("div",oe,[a(u,null,{default:o(()=>[a(d(k))]),_:1})]))]),_:1},8,["label"]),a(m,{prop:"name_en",label:t.$t("Categories.Categories"),"min-width":"180","show-overflow-tooltip":""},null,8,["label"]),a(m,{label:t.$t("Categories.name"),"min-width":"180"},{default:o(({row:e})=>[s("div",se,n(e.name_ar||"N/A"),1)]),_:1},8,["label"]),a(m,{label:t.$t("Categories.DescriptionEn"),"min-width":"320"},{default:o(({row:e})=>[a(I,{content:e.description_en||"N/A",placement:"top"},{default:o(()=>[s("div",ne,n(e.description_en||"N/A"),1)]),_:2},1032,["content"])]),_:1},8,["label"]),a(m,{label:t.$t("Categories.DescriptionAr"),"min-width":"320"},{default:o(({row:e})=>[a(I,{content:e.description_ar||"N/A",placement:"top"},{default:o(()=>[s("div",le,n(e.description_ar||"N/A"),1)]),_:2},1032,["content"])]),_:1},8,["label"]),a(m,{label:t.$t("Categories.Actions"),width:"200",fixed:"right"},{default:o(({row:e})=>[a(V,null,{default:o(()=>[a(r,{type:"warning",icon:d(G),onClick:A=>z(e)},{default:o(()=>[p(n(t.$t("Global.Edit")),1)]),_:1},8,["icon","onClick"]),a(r,{type:"danger",icon:d(L),onClick:A=>S(e)},{default:o(()=>[p(n(t.$t("Global.Delete")),1)]),_:1},8,["icon","onClick"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[O,f.value]])],512),[[F,!C.value]]),E(s("div",ie,[!_.value||_.value.length===0?(l(),g("div",re,n(t.$t("Global.NoData")||"No data"),1)):M("",!0),(l(!0),g(q,null,Q(_.value,e=>(l(),g("div",{key:e.id,class:"mobile-item"},[s("div",ce,[e.images&&e.images.length>0?(l(),y(v,{key:0,src:`${$}/public/storage/${e.images[0].path}`,fit:"cover",class:"category-image-mobile"},{error:o(()=>[s("div",de,[a(u,null,{default:o(()=>[a(d(k))]),_:1})])]),_:1},8,["src"])):(l(),g("div",_e,[a(u,null,{default:o(()=>[a(d(k))]),_:1})]))]),s("div",ue,[s("div",me,n(e.name_en||"—"),1),s("div",ge,n(e.name_ar||"—"),1),s("div",pe,[e.brand&&(e.brand.name_en||e.brand.name_ar)?(l(),y(U,{key:0,size:"small",effect:"plain"},{default:o(()=>[p(n(e.brand.name_en||e.brand.name_ar),1)]),_:2},1024)):M("",!0)]),s("div",fe,[a(r,{type:"warning",icon:d(G),size:"small",onClick:A=>z(e)},{default:o(()=>[p(n(t.$t("Global.Edit")),1)]),_:1},8,["icon","onClick"]),a(r,{type:"danger",icon:d(L),size:"small",onClick:A=>S(e)},{default:o(()=>[p(n(t.$t("Global.Delete")),1)]),_:1},8,["icon","onClick"])])])]))),128))],512),[[F,C.value]])]),_:1})])}}},ye=W(he,[["__scopeId","data-v-208587da"]]);export{ye as default};
