import{_ as W,s as j,e as D,f as H,R as K,r as c,G as P,o as l,c as g,a as s,t as n,b as a,w as o,K as d,h as y,E as h,j as p,z as Y,H as N,S as G,m as v,I as k,x as L,y as M,i as R,F as q,k as Q,D as X}from"./index-d33f2148.js";const Z={class:"categories-container"},ee={class:"header"},te={class:"table-wrapper"},ae={class:"image-error"},oe={key:1,class:"image-error"},se={class:"clamp-1",dir:"rtl"},ne={key:1},le={class:"clamp-3"},ie={class:"clamp-3",dir:"rtl"},re={class:"mobile-list"},ce={key:0,class:"no-data"},de={class:"mobile-left"},_e={class:"image-error"},ue={key:1,class:"image-error"},me={class:"mobile-right"},ge={class:"name-row"},pe={class:"name-ar",dir:"rtl"},fe={class:"brand-row"},he={class:"actions"},$="https://massagebackend.webenia.org",ve={__name:"index",setup(be){const E=j(),_=D([]),f=D(!1),C=D(!1),B=`${$}/api/categories`,V=async()=>{f.value=!0;try{const t=JSON.parse(localStorage.getItem("tokenData"));if(!t||!t.token)throw new Error("Authentication token not found");y.defaults.headers.common.Authorization=`Bearer ${t.token}`;const i=await y.get(B);i.data.status===!0?_.value=i.data.data:h.error(i.data.message||"Failed to fetch categories")}catch(t){console.error("Fetch categories error:",t),t instanceof SyntaxError?h.error("Invalid token format"):h.error(t.message||"Failed to fetch categories")}finally{f.value=!1}},x=()=>{E.push("/categories/create")},z=t=>{E.push(`/categories/edit/${t.id}`)},S=async t=>{try{if(await X.confirm("Are you sure you want to delete this category?","Warning",{confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"})==="confirm"){f.value=!0;const r=JSON.parse(localStorage.getItem("tokenData"));if(!r||!r.token)throw new Error("Authentication token not found");y.defaults.headers.common.Authorization=`Bearer ${r.token}`;const u=await y.delete(`${B}/${t.id}`);if(u.data)h.success("Category deleted successfully"),_.value=_.value.filter(b=>b.id!==t.id);else throw new Error(u.data.message||"Failed to delete category")}}catch(i){i!=="cancel"&&(console.error("Delete category error:",i),h.error(i.message||"Failed to delete category"))}finally{f.value=!1}},w=()=>{C.value=window.innerWidth<=768};return H(()=>{V(),w(),window.addEventListener("resize",w)}),K(()=>{window.removeEventListener("resize",w)}),(t,i)=>{const r=c("el-button"),u=c("el-icon"),b=c("el-image"),m=c("el-table-column"),I=c("el-tag"),F=c("el-tooltip"),T=c("el-button-group"),U=c("el-table"),J=c("el-card"),O=P("loading");return l(),g("div",Z,[s("div",ee,[s("h2",null,n(t.$t("Categories.Categories")),1),a(r,{type:"primary",icon:d(Y),onClick:x},{default:o(()=>[p(n(t.$t("Categories.AddCategory")),1)]),_:1},8,["icon"])]),a(J,{class:"categories-table"},{default:o(()=>[N(s("div",te,[N((l(),v(U,{data:_.value,style:{width:"100%"},border:"",stripe:"",size:"large","default-sort":{prop:"name_en",order:"ascending"}},{default:o(()=>[a(m,{label:t.$t("Categories.Image"),width:"120"},{default:o(({row:e})=>[e.images&&e.images.length>0?(l(),v(b,{key:0,src:`${$}/public/storage/${e.images[0].path}`,fit:"cover",class:"category-image","preview-src-list":[`${$}/${e.images[0].path}`],"initial-index":0,"preview-teleported":""},{error:o(()=>[s("div",ae,[a(u,null,{default:o(()=>[a(d(k))]),_:1})])]),_:1},8,["src","preview-src-list"])):(l(),g("div",oe,[a(u,null,{default:o(()=>[a(d(k))]),_:1})]))]),_:1},8,["label"]),a(m,{prop:"name_en",label:t.$t("Categories.Categories"),"min-width":"180","show-overflow-tooltip":""},null,8,["label"]),a(m,{label:t.$t("Categories.name"),"min-width":"180"},{default:o(({row:e})=>[s("div",se,n(e.name_ar||"N/A"),1)]),_:1},8,["label"]),a(m,{label:t.$t("Categories.Brand"),width:"180"},{default:o(({row:e})=>[e.brand&&(e.brand.name_en||e.brand.name_ar)?(l(),v(I,{key:0,size:"small",effect:"plain"},{default:o(()=>[p(n(e.brand.name_en||e.brand.name_ar),1)]),_:2},1024)):(l(),g("span",ne,"N/A"))]),_:1},8,["label"]),a(m,{label:t.$t("Categories.DescriptionEn"),"min-width":"320"},{default:o(({row:e})=>[a(F,{content:e.description_en||"N/A",placement:"top"},{default:o(()=>[s("div",le,n(e.description_en||"N/A"),1)]),_:2},1032,["content"])]),_:1},8,["label"]),a(m,{label:t.$t("Categories.DescriptionAr"),"min-width":"320"},{default:o(({row:e})=>[a(F,{content:e.description_ar||"N/A",placement:"top"},{default:o(()=>[s("div",ie,n(e.description_ar||"N/A"),1)]),_:2},1032,["content"])]),_:1},8,["label"]),a(m,{label:t.$t("Categories.Actions"),width:"200",fixed:"right"},{default:o(({row:e})=>[a(T,null,{default:o(()=>[a(r,{type:"warning",icon:d(L),onClick:A=>z(e)},{default:o(()=>[p(n(t.$t("Global.Edit")),1)]),_:1},8,["icon","onClick"]),a(r,{type:"danger",icon:d(M),onClick:A=>S(e)},{default:o(()=>[p(n(t.$t("Global.Delete")),1)]),_:1},8,["icon","onClick"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[O,f.value]])],512),[[G,!C.value]]),N(s("div",re,[!_.value||_.value.length===0?(l(),g("div",ce,n(t.$t("Global.NoData")||"No data"),1)):R("",!0),(l(!0),g(q,null,Q(_.value,e=>(l(),g("div",{key:e.id,class:"mobile-item"},[s("div",de,[e.images&&e.images.length>0?(l(),v(b,{key:0,src:`${$}/public/storage/${e.images[0].path}`,fit:"cover",class:"category-image-mobile"},{error:o(()=>[s("div",_e,[a(u,null,{default:o(()=>[a(d(k))]),_:1})])]),_:1},8,["src"])):(l(),g("div",ue,[a(u,null,{default:o(()=>[a(d(k))]),_:1})]))]),s("div",me,[s("div",ge,n(e.name_en||"—"),1),s("div",pe,n(e.name_ar||"—"),1),s("div",fe,[e.brand&&(e.brand.name_en||e.brand.name_ar)?(l(),v(I,{key:0,size:"small",effect:"plain"},{default:o(()=>[p(n(e.brand.name_en||e.brand.name_ar),1)]),_:2},1024)):R("",!0)]),s("div",he,[a(r,{type:"warning",icon:d(L),size:"small",onClick:A=>z(e)},{default:o(()=>[p(n(t.$t("Global.Edit")),1)]),_:1},8,["icon","onClick"]),a(r,{type:"danger",icon:d(M),size:"small",onClick:A=>S(e)},{default:o(()=>[p(n(t.$t("Global.Delete")),1)]),_:1},8,["icon","onClick"])])])]))),128))],512),[[G,C.value]])]),_:1})])}}},ke=W(ve,[["__scopeId","data-v-d13dbc74"]]);export{ke as default};
