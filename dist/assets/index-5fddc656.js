import{_ as S,e as p,f as z,r as i,G as I,o as U,c as P,a as E,t as d,b as a,w as n,h as _,j as f,H as x,m as L,D as M,E as y}from"./index-8e378a69.js";const T={class:"units-container"},J={class:"header"},O="https://backend.msgperfumes.com",R={__name:"index",setup(j){const b=p([]),v=p(!1),h=p(!1),c=p(!1),l=p({id:null,name_en:"",name_ar:""}),g=`${O}/api/units`,w=async()=>{v.value=!0;try{const e=JSON.parse(localStorage.getItem("tokenData"));if(!e||!e.token)throw new Error("Authentication token not found");_.defaults.headers.common.Authorization=`Bearer ${e.token}`;const t=await _.get(g);if(t.data.status)b.value=t.data.data;else throw new Error(t.data.message||"Failed to fetch units")}catch(e){console.error("Fetch units error:",e)}finally{v.value=!1}};z(()=>{w()});const V=e=>{l.value={id:e.id,name_en:e.name_en||"",name_ar:e.name_ar||""},c.value=!0},D=async e=>{try{await M.confirm("Are you sure you want to delete this unit?","Warning",{confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"});const t=await _.delete(`${g}/${e.id}`);if(t.data.status)w();else throw new Error(t.data.message||"Failed to delete unit")}catch(t){console.error("Delete unit error:",t)}},B=async()=>{var e,t,r,u;if(!l.value.name_en&&!l.value.name_ar){y.error("Please input unit name");return}try{h.value=!0;const o=JSON.parse(localStorage.getItem("tokenData"));if(!o||!o.token)throw new Error("Authentication token not found");_.defaults.headers.common.Authorization=`Bearer ${o.token}`;const $={name_en:l.value.name_en,name_ar:l.value.name_ar},m=await _.post(`${g}/${l.value.id}`,$);if((e=m.data)!=null&&e.status)y.success("Unit updated successfully"),c.value=!1,await w();else throw new Error(((t=m.data)==null?void 0:t.message)||"Failed to update unit")}catch(o){console.error("Update unit error:",o),y.error(((u=(r=o.response)==null?void 0:r.data)==null?void 0:u.message)||o.message||"Failed to update unit")}finally{h.value=!1}};return(e,t)=>{const r=i("el-button"),u=i("el-table-column"),o=i("el-table"),$=i("el-card"),m=i("el-input"),k=i("el-form-item"),C=i("el-form"),A=i("el-dialog"),F=I("loading");return U(),P("div",T,[E("div",J,[E("h2",null,d(e.$t("input.unites.Units-List")),1),a(r,{type:"primary",to:"/units/create",tag:"router-link"},{default:n(()=>[f(d(e.$t("input.unites.add-unit")),1)]),_:1})]),a($,{class:"units-table"},{default:n(()=>[x((U(),L(o,{data:b.value,style:{width:"100%"}},{default:n(()=>[a(u,{prop:"name_ar",label:e.$t("input.unites.name-ar")},null,8,["label"]),a(u,{prop:"name_en",label:e.$t("input.unites.name-en")},null,8,["label"]),a(u,{label:e.$t("input.unites.action")},{default:n(s=>[a(r,{type:"text",size:"small",onClick:N=>V(s.row)},{default:n(()=>[f(d(e.$t("input.unites.update")),1)]),_:1},8,["onClick"]),a(r,{type:"text",size:"small",onClick:N=>D(s.row)},{default:n(()=>[f(d(e.$t("input.unites.delete")),1)]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[F,v.value]])]),_:1}),a(A,{modelValue:c.value,"onUpdate:modelValue":t[3]||(t[3]=s=>c.value=s),title:e.$t("input.unites.Edit-Unit")||"Edit Unit",width:"480px"},{footer:n(()=>[a(r,{onClick:t[2]||(t[2]=s=>c.value=!1)},{default:n(()=>[f(d(e.$t("common.cancel")||"Cancel"),1)]),_:1}),a(r,{type:"primary",onClick:B,loading:h.value},{default:n(()=>[f(d(e.$t("input.unites.update")),1)]),_:1},8,["loading"])]),default:n(()=>[a(C,{model:l.value,"label-width":"120px"},{default:n(()=>[a(k,{label:e.$t("input.unites.name-en")},{default:n(()=>[a(m,{modelValue:l.value.name_en,"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.name_en=s),placeholder:e.$t("input.unites.Please-input-unit")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(k,{label:e.$t("input.unites.name-ar")},{default:n(()=>[a(m,{modelValue:l.value.name_ar,"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.name_ar=s),placeholder:e.$t("input.unites.Please-input-unit")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},H=S(R,[["__scopeId","data-v-676a0134"]]);export{H as default};
